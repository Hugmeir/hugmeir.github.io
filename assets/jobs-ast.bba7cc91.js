(self.webpackChunk_xivanalysis_client=self.webpackChunk_xivanalysis_client||[]).push([[54],{48989:function(t,a,e){"use strict";e.d(a,{e:function(){return W}});var s,i,n,o,r,l,c,d,u,h,p,m=e(97530),g=e(23257),A=e(68420),y=e(27344),v=e(5281),f=e(90306),w=e(50596),I=e(300),R=e(77766),O=e.n(R),E=e(2991),T=e.n(E),S=e(86359),C=e(9263),Z=e(98229),N=e(28683),k=e(52250),b=e(56611),x=(e(67294),e(65927)),D=e(80967),j=e(74489),L=e(76704),P=e(8510),H=e(73947),M=e(85893),W=(s=Reflect.metadata("design:type",P.Z),i=Reflect.metadata("design:type",H.V),n=Reflect.metadata("design:type",k.ZP),o=Reflect.metadata("design:type",b.TY),p=h=function(t){(0,f.Z)(e,t);var a=(0,w.Z)(e);function e(){var t,s;(0,A.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return s=a.call.apply(a,O()(t=[this]).call(t,n)),(0,g.Z)(s,"castTime",l,(0,v.Z)(s)),(0,g.Z)(s,"data",c,(0,v.Z)(s)),(0,g.Z)(s,"suggestions",d,(0,v.Z)(s)),(0,g.Z)(s,"timeline",u,(0,v.Z)(s)),s.currentCast=void 0,s.droppedCasts=[],s.missedTimeMS=0,s.icon=Z.ZP.INTERJECT.icon,s.severity={2:k.bI.MEDIUM,5:k.bI.MAJOR},s.suggestionContent=(0,M.jsx)(S.Trans,{id:"core.interrupts.suggestion.content",defaults:"Avoid interrupting casts by either prepositioning yourself or utilizing slidecasting where possible. If you have to move, try to save an instant cast to keep your GCD rolling."}),s}return(0,y.Z)(e,[{key:"suggestionWhy",value:function(t,a){return(0,M.jsx)(S.Trans,{id:"core.interrupts.suggestion.why",defaults:"You missed {0} casts (approximately {1} of total casting time) due to interruption.",values:{0:t.length,1:this.parser.formatDuration(a)}})}},{key:"noInterruptsOutput",value:function(){}},{key:"initialise",value:function(){this.addEventHook((0,j.hX)().type("prepare").source(this.parser.actor.id),this.onBeginCast),this.addEventHook((0,j.hX)().type("interrupt").source(this.parser.actor.id),this.pushDropCasts),this.addEventHook("complete",this.onComplete)}},{key:"onBeginCast",value:function(t){this.currentCast=t}},{key:"pushDropCasts",value:function(t){var a,e,s;if(null!=this.currentCast){var i=null!==(a=this.castTime.forAction(this.currentCast.action,this.currentCast.timestamp))&&void 0!==a?a:0;this.missedTimeMS+=Math.min(t.timestamp-(null!==(e=null===(s=this.currentCast)||void 0===s?void 0:s.timestamp)&&void 0!==e?e:this.parser.currentEpochTimestamp),i),this.droppedCasts.push(t),this.currentCast=void 0}}},{key:"onComplete",value:function(){this.suggestions.add(new k.eg({icon:this.icon,tiers:this.severity,value:this.droppedCasts.length,content:this.suggestionContent,why:this.suggestionWhy(this.droppedCasts,this.missedTimeMS)}))}},{key:"output",value:function(){var t,a=this;return 0===this.droppedCasts.length?this.noInterruptsOutput():(0,M.jsxs)(x.Z,{compact:!0,unstackable:!0,celled:!0,collapsing:!0,children:[(0,M.jsx)(x.Z.Header,{children:(0,M.jsxs)(x.Z.Row,{children:[(0,M.jsx)(x.Z.HeaderCell,{collapsing:!0,children:(0,M.jsx)("strong",{children:(0,M.jsx)(S.Trans,{id:"core.interrupts.table.time",defaults:"Time"})})}),(0,M.jsx)(x.Z.HeaderCell,{children:(0,M.jsx)("strong",{children:(0,M.jsx)(S.Trans,{id:"core.interrupts.table.cast",defaults:"Cast"})})})]})}),(0,M.jsx)(x.Z.Body,{children:T()(t=this.droppedCasts).call(t,(function(t){var e=a.data.getAction(t.action);return(0,M.jsxs)(x.Z.Row,{children:[(0,M.jsxs)(x.Z.Cell,{textAlign:"center",children:[(0,M.jsx)("span",{style:{marginRight:5},children:a.parser.formatEpochTimestamp(t.timestamp)}),(0,M.jsx)(D.Z,{circular:!0,compact:!0,size:"mini",icon:"time",onClick:function(){return a.timeline.show(t.timestamp-a.parser.pull.timestamp,t.timestamp-a.parser.pull.timestamp+3e4)}})]}),(0,M.jsx)(x.Z.Cell,{children:(0,M.jsx)(C.vm,(0,m.Z)({},e))})]},t.timestamp)}))})]})}}]),e}(N.qk),h.handle="interrupts",h.title={id:"core.interrupts.title",defaults:"Interrupted Casts"},h.debug=!1,r=p,l=(0,I.Z)(r.prototype,"castTime",[L.I,s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.castTime}}),c=(0,I.Z)(r.prototype,"data",[L.I,i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),d=(0,I.Z)(r.prototype,"suggestions",[L.I,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),u=(0,I.Z)(r.prototype,"timeline",[L.I,o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.timeline}}),r)},59473:function(t,a,e){"use strict";e.d(a,{e:function(){return N}});var s,i,n,o,r,l,c,d=e(23257),u=e(68420),h=e(27344),p=e(5281),m=e(90306),g=e(50596),A=e(300),y=e(77766),v=e.n(y),f=e(86359),w=e(9263),I=e(28683),R=e(74489),O=e(76704),E=e(73947),T=e(52250),S=e(67294),C=e(85893),Z={USE_PERCENT_THRESHOLD:{.8:T.bI.MAJOR,.4:T.bI.MEDIUM,.2:T.bI.MINOR}},N=(s=Reflect.metadata("design:type",E.V),i=Reflect.metadata("design:type",T.ZP),c=l=function(t){(0,m.Z)(e,t);var a=(0,g.Z)(e);function e(){var t,s;(0,u.Z)(this,e);for(var i=arguments.length,n=new Array(i),l=0;l<i;l++)n[l]=arguments[l];return s=a.call.apply(a,v()(t=[this]).call(t,n)),(0,d.Z)(s,"data",o,(0,p.Z)(s)),(0,d.Z)(s,"suggestions",r,(0,p.Z)(s)),s.lastUse=0,s.uses=0,s.totalHeld=0,s.suggestionContent=(0,C.jsx)(S.Fragment,{children:(0,C.jsx)(f.Trans,{id:"core.lucid-dreaming.suggestion.content",defaults:"Try to keep <0/> on cooldown for better MP management.",components:[(0,C.jsx)(w.P9,{action:"LUCID_DREAMING"})]})}),s}return(0,h.Z)(e,[{key:"initialise",value:function(){this.addEventHook((0,R.hX)().source(this.parser.actor.id).type("action").action(this.data.actions.LUCID_DREAMING.id),this.onCastLucid),this.addEventHook("complete",this.onComplete)}},{key:"onCastLucid",value:function(t){this.uses++,0===this.lastUse&&(this.lastUse=this.parser.pull.timestamp);var a;(a=1===this.uses?t.timestamp-this.parser.pull.timestamp:t.timestamp-this.lastUse-this.data.actions.LUCID_DREAMING.cooldown)>0&&(this.totalHeld+=a),this.lastUse=t.timestamp}},{key:"suggestionWhy",value:function(t,a){return(0,C.jsx)(S.Fragment,{children:(0,C.jsx)(f.Trans,{id:"core.lucid-dreaming.suggestion.why",defaults:"{usesMissed, plural, one {# use} other {# uses}} of Lucid Dreaming {usesMissed, plural, one {was} other {were}} missed by holding it for at least a total of {0}.",values:{0:this.parser.formatDuration(a),usesMissed:t}})})}},{key:"onComplete",value:function(){var t=0===this.uses?this.parser.pull.duration:this.totalHeld,a=Math.floor(t/this.data.actions.LUCID_DREAMING.cooldown),e=0===a?0:t/this.parser.pull.duration;this.suggestions.add(new T.eg({icon:this.data.actions.LUCID_DREAMING.icon,content:this.suggestionContent,tiers:Z.USE_PERCENT_THRESHOLD,why:this.suggestionWhy(a,t),value:e}))}}]),e}(I.qk),l.handle="lucid",l.dependencies=["suggestions"],n=c,o=(0,A.Z)(n.prototype,"data",[O.I,s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),r=(0,A.Z)(n.prototype,"suggestions",[O.I,i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),n)},74136:function(t,a,e){"use strict";e.d(a,{z:function(){return G}});var s,i,n,o,r,l,c,d,u,h=e(8333),p=e(99021),m=e(41420),g=e(23257),A=e(68420),y=e(27344),v=e(5281),f=e(90306),w=e(50596),I=e(300),R=e(10928),O=e.n(R),E=e(77766),T=e.n(E),S=e(39392),C=e.n(S),Z=e(2991),N=e.n(Z),k=e(20116),b=e.n(k),x=e(20455),D=e.n(x),j=e(89400),L=e.n(j),P=e(28683),H=e(74489),M=e(76704),W=e(61806),_=e(70273),U=e(73947),F=e(56611),G=(s=Reflect.metadata("design:type",W.E),i=Reflect.metadata("design:type",_.e),n=Reflect.metadata("design:type",U.V),u=d=function(t){(0,f.Z)(e,t);var a=(0,w.Z)(e);function e(){var t,s;(0,A.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return s=a.call.apply(a,T()(t=[this]).call(t,n)),(0,g.Z)(s,"actionTimeline",r,(0,v.Z)(s)),(0,g.Z)(s,"actors",l,(0,v.Z)(s)),(0,g.Z)(s,"data",c,(0,v.Z)(s)),s.statusActionMap=new(C()),s.usages=new(C()),s.rows=new(C()),s.getRowKey=function(t,a){var e;return T()(e="".concat(t,":")).call(e,a)},s}return(0,y.Z)(e,[{key:"initialise",value:function(){var t,a,e,s,i,n=this,o=N()(t=b()(a=this.parser.pull.actors).call(a,(function(t){return t.owner===n.parser.actor}))).call(t,(function(t){return t.id})),r=N()(e=b()(s=this.parser.pull.actors).call(s,(function(t){var a;return!0===(null===(a=t.owner)||void 0===a?void 0:a.playerControlled)}))).call(e,(function(t){return t.id})),l=(0,H.hX)().source((0,H.kw)(T()(i=[this.parser.actor.id]).call(i,(0,m.Z)(o)))).target((0,H.jg)(r));this.addEventHook(l.type("statusApply"),this.onApply),this.addEventHook(l.type("statusRemove"),this.onRemove),this.addEventHook("complete",this.onComplete);for(var c=0,d=D()(this.data.actions);c<d.length;c++){var u=d[c];if(null!=u.statusesApplied){var h,g=(0,p.Z)(u.statusesApplied);try{for(g.s();!(h=g.n()).done;){var A=h.value,y=this.data.statuses[A].id;this.statusActionMap.set(y,u)}}catch(t){g.e(t)}finally{g.f()}}}}},{key:"onApply",value:function(t){var a=this.usages.get(t.status);null==a&&(a=new(C()),this.usages.set(t.status,a));var e=a.get(t.target);if(null==e){var s=this.createStatusTargetRow(t.status,t.target);if(null==s)return;e={usages:[],row:s},a.set(t.target,e)}var i=O()(e.usages);null!=i&&null==i.end||e.usages.push({start:t.timestamp})}},{key:"onRemove",value:function(t){var a,e,s=O()(null===(a=this.usages.get(t.status))||void 0===a||null===(e=a.get(t.target))||void 0===e?void 0:e.usages);null!=s&&(s.end=t.timestamp)}},{key:"onComplete",value:function(){var t,a=(0,p.Z)(this.usages);try{for(a.s();!(t=a.n()).done;){var e=(0,h.Z)(t.value,2),s=e[0],i=e[1],n=this.data.getStatus(s);if(null!=n){var o,r=(0,p.Z)(L()(i).call(i));try{for(r.s();!(o=r.n()).done;){var l,c=o.value,d=(0,p.Z)(c.usages);try{for(d.s();!(l=d.n()).done;){var u,m=l.value;c.row.addItem(new F.hg({status:n,start:m.start-this.parser.pull.timestamp,end:(null!==(u=m.end)&&void 0!==u?u:this.parser.pull.timestamp+this.parser.pull.duration)-this.parser.pull.timestamp}))}}catch(t){d.e(t)}finally{d.f()}}}catch(t){r.e(t)}finally{r.f()}}}}catch(t){a.e(t)}finally{a.f()}}},{key:"createStatusTargetRow",value:function(t,a){var e,s=null!==(e=this.constructor.statusesStackMapping[t])&&void 0!==e?e:t,i=this.getRowKey(s,a),n=this.rows.get(i);if(null!=n)return n;var o=this.createStatusRow(s);if(null!=o){var r=this.actors.get(a),l=o.addRow(new F.e2({label:r.name}));return this.rows.set(i,l),l}}},{key:"createStatusRow",value:function(t){var a,e,s=this.getRowKey(t),i=this.rows.get(s);if(null!=i)return i;var n=this.statusActionMap.get(t);if(null!=n){var o=this.actionTimeline.getRow(n).addRow(new F.e2({label:null!==(a=null===(e=this.data.getStatus(t))||void 0===e?void 0:e.name)&&void 0!==a?a:t,hideCollapsed:!0,collapse:!0}));return this.rows.set(s,o),o}}}]),e}(P.qk),d.handle="statusTimeline",d.statusesStackMapping={},o=u,r=(0,I.Z)(o.prototype,"actionTimeline",[M.I,s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.actionTimeline}}),l=(0,I.Z)(o.prototype,"actors",[M.I,i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.actors}}),c=(0,I.Z)(o.prototype,"data",[M.I,n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),o)},90137:function(t,a,e){"use strict";e.d(a,{J:function(){return l}});var s=e(68420),i=e(90306),n=e(50596),o=e(77766),r=e.n(o),l=function(t){(0,i.Z)(e,t);var a=(0,n.Z)(e);function e(){var t,i;(0,s.Z)(this,e);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(i=a.call.apply(a,r()(t=[this]).call(t,o))).buffStatus=i.data.statuses.MEDICATED,i}return e}(e(27596).x);l.handle="tincture",l.title={id:"core.tincture.title",defaults:"Tinctures"}},74622:function(t,a,e){"use strict";e.r(a),e.d(a,{default:function(){return es}});var s,i=e(48989),n=e(59473),o=e(41420),r=e(68420),l=e(90306),c=e(50596),d=e(77766),u=e.n(d),h=e(61806),p=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){return(0,r.Z)(this,e),a.apply(this,arguments)}return e}(h.E);p.rows=u()(s=[]).call(s,(0,o.Z)(h.E.rows),[["DRAW","UNDRAW"],"PLAY","ASTRODYNE",["CROWN_PLAY","MINOR_ARCANA"],"DIVINATION","LIGHTSPEED","ESSENTIAL_DIGNITY","SYNASTRY","CELESTIAL_INTERSECTION","CELESTIAL_OPPOSITION",["EARTHLY_STAR","STELLAR_DETONATION"],["MACROCOSMOS","MICROCOSMOS"],"EXALTATION",["HOROSCOPE","HOROSCOPE_ACTIVATION"],"NEUTRAL_SECT","COLLECTIVE_UNCONSCIOUS","LUCID_DREAMING"]);var m,g,A,y,v,f,w,I,R=e(97530),O=e(23257),E=e(27344),T=e(5281),S=e(300),C=e(85004),Z=e.n(C),N=e(7436),k=e.n(N),b=e(94174),x=e.n(b),D=e(10928),j=e.n(D),L=e(7287),P=e.n(L),H=e(2991),M=e.n(H),W=e(94473),_=e.n(W),U=e(78580),F=e.n(U),G=e(3649),B=e.n(G),Y=e(28683),V=e(74489),z=e(76704),X=e(73947),J=["THE_BALANCE","THE_BOLE","THE_ARROW","THE_SPEAR","THE_EWER","THE_SPIRE"],K=["LORD_OF_CROWNS","LADY_OF_CROWNS"],Q=["THE_BALANCE","THE_BOLE"],q=["THE_ARROW","THE_EWER"],$=["THE_SPEAR","THE_SPIRE"],tt=["BALANCE_DRAWN","BOLE_DRAWN","ARROW_DRAWN","SPEAR_DRAWN","EWER_DRAWN","SPIRE_DRAWN"],at=["LORD_OF_CROWNS_DRAWN","LADY_OF_CROWNS_DRAWN"],et=["THE_BALANCE","THE_BOLE","THE_ARROW","THE_SPEAR","THE_EWER","THE_SPIRE"],st=u()(m=["DRAW","REDRAW"]).call(m,(0,o.Z)(J)),it=u()(g=["DRAW","REDRAW","UNDRAW","ASTRODYNE"]).call(g,(0,o.Z)(J));!function(t){t[t.NOTHING=0]="NOTHING",t[t.SOLAR=1]="SOLAR",t[t.LUNAR=2]="LUNAR",t[t.CELESTIAL=3]="CELESTIAL"}(I||(I={}));var nt,ot=[I.NOTHING,I.NOTHING,I.NOTHING];!function(t){t[t.NOTHING=0]="NOTHING",t[t.ONE_STACK=1]="ONE_STACK",t[t.TWO_STACK=2]="TWO_STACK"}(nt||(nt={}));var rt,lt,ct,dt,ut,ht,pt,mt,gt,At,yt,vt,ft,wt,It,Rt,Ot,Et,Tt,St,Ct,Zt,Nt,kt,bt,xt,Dt,jt,Lt,Pt,Ht,Mt,Wt,_t,Ut,Ft,Gt,Bt,Yt,Vt,zt,Xt,Jt,Kt,Qt,qt,$t,ta,aa,ea,sa,ia,na,oa,ra,la,ca,da,ua,ha,pa,ma,ga,Aa,ya,va,fa,wa,Ia,Ra,Oa,Ea,Ta,Sa,Ca,Za,Na,ka,ba,xa,Da,ja,La,Pa,Ha,Ma,Wa,_a,Ua,Fa,Ga,Ba=(A=Reflect.metadata("design:type",X.V),w=f=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return s=a.call.apply(a,u()(t=[this]).call(t,n)),(0,O.Z)(s,"data",v,(0,T.Z)(s)),s.play=[],s.arcanaStatuses=[],s.cardGrantingAbilities=[],s.cardActions=[],s.drawnArcana=[],s.celestialSealArcana=[],s.lunarSealArcana=[],s.solarSealArcana=[],s.playToStatusLookup={},s.statusToDrawnLookup={},s.statusToPlayLookup={},s.drawnToPlayLookup={},s.cardStateLog=[{lastEvent:{type:"init",timestamp:s.parser.pull.timestamp},drawState:void 0,sealState:ot,sleeveState:nt.NOTHING}],s.lastDrawnBuff=void 0,s.pullStateInitialized=!1,s.pullIndex=0,s.on_prepullArcanas=void 0,s.off_prepullArcanas=void 0,s}return(0,E.Z)(e,[{key:"initialise",value:function(){var t=this;this.play=M()(J).call(J,(function(a){return t.data.actions[a].id})),this.arcanaStatuses=M()(et).call(et,(function(a){return t.data.statuses[a].id})),this.cardGrantingAbilities=M()(st).call(st,(function(a){return t.data.actions[a].id})),this.cardActions=M()(it).call(it,(function(a){return t.data.actions[a].id})),this.drawnArcana=M()(tt).call(tt,(function(a){return t.data.statuses[a].id})),this.celestialSealArcana=M()($).call($,(function(a){return t.data.actions[a].id})),this.lunarSealArcana=M()(q).call(q,(function(a){return t.data.actions[a].id})),this.solarSealArcana=M()(Q).call(Q,(function(a){return t.data.actions[a].id})),this.playToStatusLookup=P()(this.play,this.drawnArcana),this.statusToDrawnLookup=P()(this.arcanaStatuses,this.drawnArcana),this.statusToPlayLookup=P()(this.arcanaStatuses,this.play),this.drawnToPlayLookup=P()(this.drawnArcana,this.play);var a=(0,V.hX)().source(this.parser.actor.id);this.addEventHook(a.type("action").action((0,V.kw)(this.cardActions)),this.onCast),this.addEventHook(a.type("statusApply").status((0,V.kw)(this.arcanaStatuses)),this.onPrepullArcana),this.addEventHook(a.type("statusRemove").status((0,V.kw)(this.arcanaStatuses)),this.offPrepullArcana),this.addEventHook(a.type("statusApply").status((0,V.kw)(this.drawnArcana)),this.onDrawnStatus),this.addEventHook(a.type("statusRemove").status((0,V.kw)(this.drawnArcana)),this.offDrawnStatus),this.addEventHook({type:"death",actor:this.parser.actor.id},this.onDeath)}},{key:"cardLogs",get:function(){return this.cardStateLog}},{key:"getCardState",value:function(){var t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.parser.pull.timestamp,e=_()(t=this.cardStateLog).call(t,(function(t){return t.lastEvent&&a>t.lastEvent.timestamp}));return e}},{key:"getPullState",value:function(){var t;return _()(t=this.cardStateLog).call(t,(function(t){return t.lastEvent&&"init"===t.lastEvent.type}))}},{key:"onPrepullArcana",value:function(t){t.timestamp>this.parser.pull.timestamp||null!=this.on_prepullArcanas&&this.on_prepullArcanas.push(t)}},{key:"offPrepullArcana",value:function(t){var a=this;t.timestamp>=this.parser.pull.timestamp+this.data.statuses.THE_BALANCE.duration||null!=this.off_prepullArcanas&&this.off_prepullArcanas.forEach((function(e){if(e.status===t.status&&e.target===t.target){var s=(0,R.Z)({},j()(a.cardStateLog)),i=a.data.getAction(a.arcanaStatusToPlay(t.status));if(null!=i){var n={action:i.id,timestamp:t.timestamp-a.data.statuses.THE_BALANCE.duration-a.parser.pull.timestamp,type:"action",source:t.source,target:t.target};s.lastEvent=(0,R.Z)({},n),s.drawState=void 0,s.sealState=ot,a.cardStateLog.unshift(s),a.pullIndex++}}}))}},{key:"onDrawnStatus",value:function(t){var a;F()(a=this.drawnArcana).call(a,t.status)&&(this.lastDrawnBuff=t)}},{key:"offDrawnStatus",value:function(t){var a;if(F()(a=this.drawnArcana).call(a,t.status)){this.retconSearch(this.arcanaDrawnToPlay(t.status));var e=this.cardStateLog.some((function(a){return a.lastEvent&&x()(t.timestamp,a.lastEvent.timestamp-20,a.lastEvent.timestamp+20)})),s=this.cardStateLog.some((function(a){return a.lastEvent&&x()(t.timestamp,a.lastEvent.timestamp-20-2e3,a.lastEvent.timestamp+2e3+20)&&"death"===a.lastEvent.type}));if(!e&&!s){var i=(0,R.Z)({},j()(this.cardStateLog)),n={action:this.data.actions.UNDRAW.id,timestamp:t.timestamp,type:"action",source:t.source,target:t.target};i.lastEvent=n,i.drawState=void 0,this.cardStateLog.push(i)}}}},{key:"onCast",value:function(t){var a,e;if(!(t.timestamp<this.parser.pull.timestamp)){var s=t.action;!this.pullStateInitialized&&F()(a=this.play).call(a,s)&&this.initPullState(t);var i=(0,R.Z)({},j()(this.cardStateLog));if(i.lastEvent=t,F()(e=this.play).call(e,s)){var n,r,l;this.retconSearch(s),i.drawState=void 0;var c=I.NOTHING;F()(n=this.solarSealArcana).call(n,s)?c=I.SOLAR:F()(r=this.lunarSealArcana).call(r,s)?c=I.LUNAR:F()(l=this.celestialSealArcana).call(l,s)&&(c=I.CELESTIAL);var d=(0,o.Z)(i.sealState);i.sealState=this.addSeal(c,d)}s===this.data.actions.ASTRODYNE.id&&(i.sealState=ot),s===this.data.actions.UNDRAW.id&&(i.drawState=void 0),this.cardStateLog.push(i)}}},{key:"onDeath",value:function(t){var a=(0,R.Z)({},j()(this.cardStateLog));"action"===a.lastEvent.type&&a.lastEvent.action===this.data.actions.UNDRAW.id&&t.timestamp-a.lastEvent.timestamp<=2020&&this.cardStateLog.pop(),this.cardStateLog.push({lastEvent:(0,R.Z)({},t),drawState:void 0,sealState:a.sealState,sleeveState:nt.NOTHING})}},{key:"initPullState",value:function(t){var a,e,s=this,i=t.action,n=B()(a=this.cardStateLog).call(a,this.pullIndex+1);if(n.length>0&&n.forEach((function(t){var a;if("action"===t.lastEvent.type&&F()(a=s.cardGrantingAbilities).call(a,t.lastEvent.action))return s.pullStateInitialized=!0})),!this.pullStateInitialized&&F()(e=this.play).call(e,i)){var o=this.arcanaActionToStatus(i);this.cardStateLog.forEach((function(t,a){if("init"===t.lastEvent.type)return s.cardStateLog[a].drawState=o||void 0,s.pullStateInitialized=!0}))}}},{key:"retconSearch",value:function(t){var a,e,s,i,n=this,r=!0,l=j()(this.cardStateLog),c="action"===l.lastEvent.type?l.lastEvent.action:-1;(F()(a=u()(e=[this.data.actions.UNDRAW.id]).call(e,(0,o.Z)(this.play),[this.data.actions.REDRAW.id])).call(a,c)||this.data.actions.DRAW.id===c&&l.drawState&&F()(s=this.drawnArcana).call(s,l.drawState))&&(r=!1);var d=r?this.cardStateLog:B()(i=this.cardStateLog).call(i,0,this.cardStateLog.length-1),h=k()(d,(function(t){var a;return"init"===t.lastEvent.type||"action"===t.lastEvent.type&&F()(a=n.cardGrantingAbilities).call(a,t.lastEvent.action)}));if(-1===h||void 0===this.cardStateLog[h].drawState){h=h<0?this.pullIndex:h;var p=this.arcanaActionToStatus(t);Z()(this.cardStateLog,(function(t,a){(r&&a>=h||a>=h&&a!==n.cardStateLog.length-1)&&(t.drawState=p)}))}}},{key:"addSeal",value:function(t,a){return t?(a.shift(),a.push(t),a):a}},{key:"arcanaActionToStatus",value:function(t){var a;if(F()(a=this.play).call(a,t))return this.playToStatusLookup[t]}},{key:"arcanaStatusToDrawn",value:function(t){var a;return F()(a=this.arcanaStatuses).call(a,t)&&(t=this.statusToDrawnLookup[t]),t}},{key:"arcanaStatusToPlay",value:function(t){var a;return F()(a=this.arcanaStatuses).call(a,t)&&(t=this.statusToPlayLookup[t]),t}},{key:"arcanaDrawnToPlay",value:function(t){var a;return F()(a=this.drawnArcana).call(a,t)&&(t=this.drawnToPlayLookup[t]),t}}]),e}(Y.qk),f.handle="arcanaTracking",f.title={id:"ast.arcana-tracking.title",defaults:"Arcana Tracking"},f.displayOrder=55,y=w,v=(0,S.Z)(y.prototype,"data",[z.I,A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),y),Ya=e(44845),Va=e(86359),za=e(9263),Xa=e(58615),Ja=e(43719),Ka=e(70273),Qa=e(56611),qa=e(67294),$a=e(65927),te=e(80967),ae="ArcanaSuggestions-module_cardActionRow__9Mu-e",ee="ArcanaSuggestions-module_sealIcon__2Twz3",se=e(85893),ie=(rt={},(0,Ya.Z)(rt,I.NOTHING,""),(0,Ya.Z)(rt,I.SOLAR,"data:image/png;base64,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"),(0,Ya.Z)(rt,I.LUNAR,"data:image/png;base64,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"),(0,Ya.Z)(rt,I.CELESTIAL,"data:image/png;base64,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"),rt),ne=(lt=Reflect.metadata("design:type",X.V),ct=Reflect.metadata("design:type",Ba),dt=Reflect.metadata("design:type",Qa.TY),ut=Reflect.metadata("design:type",Ka.e),vt=yt=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return s=a.call.apply(a,u()(t=[this]).call(t,n)),(0,O.Z)(s,"data",pt,(0,T.Z)(s)),(0,O.Z)(s,"arcanaTracking",mt,(0,T.Z)(s)),(0,O.Z)(s,"timeline",gt,(0,T.Z)(s)),(0,O.Z)(s,"actors",At,(0,T.Z)(s)),s.cardLogs=[],s.play=[],s}return(0,E.Z)(e,[{key:"initialise",value:function(){var t=this;this.play=M()(J).call(J,(function(a){return t.data.actions[a].id})),this.addEventHook("complete",this._onComplete)}},{key:"_onComplete",value:function(){var t,a=this;this.cardLogs=M()(t=this.arcanaTracking.cardLogs).call(t,(function(t){if("action"===t.lastEvent.type){var e=t.lastEvent.target,s=a.actors.get(e);return(0,R.Z)((0,R.Z)({},t),{},{targetName:s.name,targetJob:s.job})}return(0,R.Z)((0,R.Z)({},t),{},{targetName:"",targetJob:"UNKNOWN"})}))}},{key:"output",value:function(){var t,a=this;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("p",{children:(0,se.jsx)(Va.Trans,{id:"ast.arcana-suggestions.messages.explanation",defaults:"This section keeps track of every card action made during the fight, and the state of the spread after each action."})}),(0,se.jsx)("p",{children:(0,se.jsx)(Va.Trans,{id:"ast.arcana-suggestions.messages.footnote",defaults:"* No pre-pull actions are being represented aside from <0/>, and this is only an approximation based on the buff duration.",components:[(0,se.jsx)(za.vm,{action:"PLAY"})]})}),(0,se.jsxs)($a.Z,{collapsing:!0,unstackable:!0,className:"ArcanaSuggestions-module_cardActionTable__3wair",children:[(0,se.jsx)($a.Z.Header,{children:(0,se.jsxs)($a.Z.Row,{children:[(0,se.jsx)($a.Z.HeaderCell,{width:1,children:(0,se.jsx)(Va.Trans,{id:"ast.arcana-suggestions.messages.time",defaults:"Time"})}),(0,se.jsx)($a.Z.HeaderCell,{width:1,children:(0,se.jsx)(Va.Trans,{id:"ast.arcana-suggestions.messages.latest-action",defaults:"Lastest Action"})}),(0,se.jsx)($a.Z.HeaderCell,{width:2,children:(0,se.jsx)(Va.Trans,{id:"ast.arcana-suggestions.messages.target",defaults:"Target"})}),(0,se.jsx)($a.Z.HeaderCell,{width:2,children:(0,se.jsx)(Va.Trans,{id:"ast.arcana-suggestions.messages.spread-state",defaults:"Spread State"})})]})}),(0,se.jsx)($a.Z.Body,{children:M()(t=this.cardLogs).call(t,(function(t){if("init"===t.lastEvent.type)return(0,se.jsxs)($a.Z.Row,{className:ae,children:[(0,se.jsxs)($a.Z.Cell,{children:[(0,se.jsx)(te.Z,{circular:!0,compact:!0,size:"mini",icon:"time",onClick:function(){return a.timeline.show(0,3e4)}}),a.parser.formatDuration(t.lastEvent.timestamp-a.parser.pull.timestamp)]}),(0,se.jsx)($a.Z.Cell,{children:(0,se.jsx)(Va.Trans,{id:"ast.arcana-suggestions.messages.pull",defaults:"Pull"})}),(0,se.jsx)($a.Z.Cell,{}),a.RenderSpreadState(t)]},t.lastEvent.timestamp);var e=t.lastEvent.timestamp-a.parser.pull.timestamp,s=e+3e4,i=a.parser.formatDuration(e);return(0,se.jsxs)($a.Z.Row,{className:ae,children:[(0,se.jsxs)($a.Z.Cell,{children:[e>=0&&(0,se.jsx)(te.Z,{circular:!0,compact:!0,size:"mini",icon:"time",onClick:function(){return a.timeline.show(e,s)}}),(0,se.jsx)("span",{style:{marginRight:10},children:i})]}),a.RenderAction(t),a.RenderSpreadState(t)]},t.lastEvent.timestamp)}))})]}),(0,se.jsx)(te.Z,{onClick:function(){return a.parser.scrollTo(e.handle)},children:(0,se.jsx)(Va.Trans,{id:"ast.arcana-suggestions.scroll-to-top-button",defaults:"Jump to start of Arcana Logs"})})]})}},{key:"RenderAction",value:function(t){var a;if("action"===t.lastEvent.type&&F()(a=this.play).call(a,t.lastEvent.action)&&null!=t.targetJob){var e=Ja.W[t.targetJob];return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)($a.Z.Cell,{children:(0,se.jsx)(za.vm,(0,R.Z)({},this.data.getAction(t.lastEvent.action)))}),(0,se.jsxs)($a.Z.Cell,{children:[e&&(0,se.jsx)(Xa.W,{job:e}),t.targetName]})]})}return"action"===t.lastEvent.type?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)($a.Z.Cell,{children:(0,se.jsx)(za.vm,(0,R.Z)({},this.data.getAction(t.lastEvent.action)))}),(0,se.jsx)($a.Z.Cell,{})]}):"death"===t.lastEvent.type?(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)($a.Z.Cell,{children:(0,se.jsx)(Va.Trans,{id:"ast.arcana-tracking.messages.death",defaults:"Death"})}),(0,se.jsx)($a.Z.Cell,{})]}):(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)($a.Z.Cell,{}),(0,se.jsx)($a.Z.Cell,{})]})}},{key:"RenderSpreadState",value:function(t){var a,e=t.drawState?this.data.getStatus(t.drawState):void 0;return(0,se.jsxs)($a.Z.Cell,{children:[(0,se.jsxs)("span",{style:{marginRight:10,marginLeft:0},children:[e&&(0,se.jsx)("img",{src:e.icon,className:"ArcanaSuggestions-module_buffIcon__3buJ7",alt:e.name}),!e&&(0,se.jsx)("span",{className:"ArcanaSuggestions-module_buffPlaceholder__2TqDK"})]}),(0,se.jsx)("span",{className:"ArcanaSuggestions-module_sealIconContainer__1ZN2u",children:M()(a=t.sealState).call(a,(function(t,a){return t>0?(0,se.jsx)("img",{src:ie[t],className:ee,alt:"Seal icon"},a):(0,se.jsx)("span",{className:ee},a)}))})]})}}]),e}(Y.qk),yt.handle="arcanaSuggestions",yt.title={id:"ast.arcana-suggestions.title",defaults:"Arcana Logs"},yt.displayOrder=55,ht=vt,pt=(0,S.Z)(ht.prototype,"data",[z.I,lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),mt=(0,S.Z)(ht.prototype,"arcanaTracking",[z.I,ct],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.arcanaTracking}}),gt=(0,S.Z)(ht.prototype,"timeline",[z.I,dt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.timeline}}),At=(0,S.Z)(ht.prototype,"actors",[z.I,ut],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.actors}}),ht),oe=e(52250),re=(ft=Reflect.metadata("design:type",X.V),wt=Reflect.metadata("design:type",oe.ZP),Tt=Et=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(s=a.call.apply(a,u()(t=[this]).call(t,n))).undraws=0,(0,O.Z)(s,"data",Rt,(0,T.Z)(s)),(0,O.Z)(s,"suggestions",Ot,(0,T.Z)(s)),s}return(0,E.Z)(e,[{key:"initialise",value:function(){this.addEventHook((0,V.hX)().source(this.parser.actor.id).type("action").action(this.data.actions.UNDRAW.id),this.onUndraw),this.addEventHook("complete",this.onComplete)}},{key:"onUndraw",value:function(){this.undraws+=1}},{key:"onComplete",value:function(){this.undraws>0&&this.suggestions.add(new oe.q$({icon:this.data.actions.UNDRAW.icon,content:(0,se.jsx)(Va.Trans,{id:"ast.arcana-undraw-usage.suggestions.content",defaults:"Due to Draw starting its cooldown the moment it's used, there is no longer any reason to <0/> instead of playing it or directly overwriting it with <1/>.",components:[(0,se.jsx)(za.P9,{action:"UNDRAW"}),(0,se.jsx)(za.P9,{action:"DRAW"})]}),severity:oe.bI.MAJOR,why:(0,se.jsx)(Va.Trans,{id:"ast.arcana-undraw-usage.suggestions.why",defaults:"{0, plural, one {# instance} other {# instances}} of using undraw.",values:{0:this.undraws}})}))}}]),e}(Y.qk),Et.handle="arcanaundraws",It=Tt,Rt=(0,S.Z)(It.prototype,"data",[z.I,ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),Ot=(0,S.Z)(It.prototype,"suggestions",[z.I,wt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),It),le=e(18527),ce=e(3362),de=e(8510),ue=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(s=a.call.apply(a,u()(t=[this]).call(t,n))).hobIndex=null,s}return(0,E.Z)(e,[{key:"initialise",value:function(){(0,le.Z)((0,ce.Z)(e.prototype),"initialise",this).call(this);var t=(0,V.hX)().target(this.parser.actor.id).status(this.data.statuses.HARMONY_OF_BODY.id);this.addEventHook(t.type("statusApply"),this.onApplyBody),this.addEventHook(t.type("statusRemove"),this.onRemoveBody)}},{key:"onApplyBody",value:function(){var t=this.data.statuses.HARMONY_OF_BODY;this.hobIndex=this.setPercentageAdjustment("all",t.speedModifier,"both")}},{key:"onRemoveBody",value:function(){this.reset(this.hobIndex),this.hobIndex=null}}]),e}(de.Z),he=e(52102),pe=e(49006),me={CLIPPING:{6e3:oe.bI.MINOR,9e3:oe.bI.MEDIUM,12e3:oe.bI.MAJOR},UPTIME:{90:he.hI.WARN,95:he.hI.SUCCESS}},ge=(St=Reflect.metadata("design:type",he.ZP),Ct=Reflect.metadata("design:type",oe.ZP),xt=bt=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return s=a.call.apply(a,u()(t=[this]).call(t,n)),(0,O.Z)(s,"checklist",Nt,(0,T.Z)(s)),(0,O.Z)(s,"suggestions",kt,(0,T.Z)(s)),s.trackedStatuses=[s.data.statuses.COMBUST_III.id],s}return(0,E.Z)(e,[{key:"addChecklistRules",value:function(){var t=this;this.checklist.add(new he.dV({name:(0,se.jsx)(Va.Trans,{id:"ast.dots.rule.name"}),description:(0,se.jsx)(Va.Trans,{id:"ast.dots.rule.description",components:[(0,se.jsx)(za.P9,{action:"DRAW"})]}),tiers:me.UPTIME,requirements:[new he.nb({name:(0,se.jsx)(Va.Trans,{id:"ast.dots.requirement.uptime.name",components:[(0,se.jsx)(za.P9,{action:"COMBUST_III"})]}),percent:function(){return t.getUptimePercent(t.data.statuses.COMBUST_III.id)}})],displayOrder:2}))}},{key:"addClippingSuggestions",value:function(){var t=this.getClippingAmount(this.data.statuses.COMBUST_III.id);this.suggestions.add(new oe.eg({icon:this.data.actions.COMBUST_III.icon,content:(0,se.jsx)(Va.Trans,{id:"ast.dots.suggestion.clip.content",components:[(0,se.jsx)(za.P9,{action:"COMBUST_III"})]}),why:(0,se.jsx)(Va.Trans,{id:"ast.dots.suggestion.clip.why",values:{0:this.parser.formatDuration(t,1)},components:[(0,se.jsx)(za.P9,{status:"COMBUST_III"})]}),tiers:me.CLIPPING,value:t}))}}]),e}(pe.N),bt.handle="combust",Zt=xt,Nt=(0,S.Z)(Zt.prototype,"checklist",[z.I,St],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.checklist}}),kt=(0,S.Z)(Zt.prototype,"suggestions",[z.I,Ct],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),Zt),Ae={SCORE:{70:he.hI.FAIL,80:he.hI.WARN,90:he.hI.SUCCESS},WEIGHT:{MINOR_ARCANA:1,LORD:.8,LADY:.2}},ye={LORD:{1:oe.bI.MINOR,2:oe.bI.MEDIUM,6:oe.bI.MAJOR},LADY:{1:oe.bI.MINOR,2:oe.bI.MEDIUM,6:oe.bI.MAJOR},MINOR_ARCANA:{1:oe.bI.MINOR,2:oe.bI.MEDIUM,6:oe.bI.MAJOR}},ve=(Dt=Reflect.metadata("design:type",X.V),jt=Reflect.metadata("design:type",he.ZP),Lt=Reflect.metadata("design:type",oe.ZP),Ut=_t=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return s=a.call.apply(a,u()(t=[this]).call(t,n)),(0,O.Z)(s,"data",Ht,(0,T.Z)(s)),(0,O.Z)(s,"checklist",Mt,(0,T.Z)(s)),(0,O.Z)(s,"suggestions",Wt,(0,T.Z)(s)),s.lastCrownTimestamp=0,s.minorArcana=0,s.minorArcanaDrift=0,s.minorArcanaTotalDrift=0,s.lastEventType="prepare",s.lastCardType=0,s.ladyObtained=0,s.ladyCasts=0,s.lordObtained=0,s.lordCasts=0,s.crownActions=[],s.arcanaStatuses=[],s}return(0,E.Z)(e,[{key:"initialise",value:function(){var t=this;this.crownActions=M()(K).call(K,(function(a){return t.data.actions[a].id})),this.arcanaStatuses=M()(at).call(at,(function(a){return t.data.statuses[a].id}));var a=(0,V.hX)().source(this.parser.actor.id);this.addEventHook(a.type("action").action(this.data.actions.MINOR_ARCANA.id),this.onMinorArcana),this.addEventHook(a.type("action").action((0,V.kw)(this.crownActions)),this.onCrownAction),this.addEventHook(a.type("statusApply").status((0,V.kw)(this.arcanaStatuses)),this.onCrownBuff),this.addEventHook("complete",this.onComplete)}},{key:"onMinorArcana",value:function(t){this.minorArcana++,0===this.lastCrownTimestamp?this.minorArcanaDrift=t.timestamp-this.parser.pull.timestamp:this.minorArcanaDrift=t.timestamp-this.lastCrownTimestamp-this.data.actions.MINOR_ARCANA.cooldown,this.minorArcanaDrift>0&&(this.minorArcanaTotalDrift+=this.minorArcanaDrift),this.lastEventType===t.type&&(this.lastCardType===this.data.statuses.LORD_OF_CROWNS_DRAWN.id&&this.lordObtained++,this.lastCardType===this.data.statuses.LADY_OF_CROWNS_DRAWN.id&&this.ladyObtained++),this.lastCrownTimestamp=t.timestamp,this.lastEventType=t.type}},{key:"onCrownAction",value:function(t){t.action===this.data.actions.LORD_OF_CROWNS.id&&(this.lordCasts++,0===this.lordObtained&&this.parser.pull.timestamp+this.data.actions.MINOR_ARCANA.cooldown<t.timestamp&&this.lordObtained++),t.action===this.data.actions.LADY_OF_CROWNS.id&&(this.ladyCasts++,0===this.ladyObtained&&this.parser.pull.timestamp+this.data.actions.MINOR_ARCANA.cooldown<t.timestamp&&this.ladyObtained++)}},{key:"onCrownBuff",value:function(t){t.status===this.data.statuses.LORD_OF_CROWNS_DRAWN.id&&(this.lordObtained++,this.lastCardType=this.data.statuses.LORD_OF_CROWNS_DRAWN.id,this.lastEventType=t.type),t.status===this.data.statuses.LADY_OF_CROWNS_DRAWN.id&&(this.ladyObtained++,this.lastCardType=this.data.statuses.LADY_OF_CROWNS_DRAWN.id,this.lastEventType=t.type)}},{key:"onComplete",value:function(){var t=this.parser.pull.duration+this.parser.pull.timestamp;0===this.lastCrownTimestamp?this.minorArcanaTotalDrift=this.parser.pull.duration:this.minorArcanaTotalDrift+=Math.max(0,t-this.lastCrownTimestamp-this.data.actions.MINOR_ARCANA.cooldown),"action"===this.lastEventType&&(this.lastCardType===this.data.statuses.LORD_OF_CROWNS_DRAWN.id&&this.lordObtained++,this.lastCardType===this.data.statuses.LADY_OF_CROWNS_DRAWN.id&&this.ladyObtained++);var a=Math.ceil(Math.max(0,this.parser.pull.duration-5e3)/this.data.actions.MINOR_ARCANA.cooldown),e=[new he.nb({name:(0,se.jsx)(Va.Trans,{id:"ast.crown-play.checklist.requirement.name",components:[(0,se.jsx)(za.P9,{action:"MINOR_ARCANA"})]}),value:this.minorArcana,target:a,weight:Ae.WEIGHT.MINOR_ARCANA})];0!==this.ladyObtained&&e.push(new he.nb({name:(0,se.jsx)(Va.Trans,{id:"ast.crown-play.checklist.lady",components:[(0,se.jsx)(za.P9,{action:"LADY_OF_CROWNS"})]}),value:this.ladyCasts,target:this.ladyObtained,weight:Ae.WEIGHT.LADY})),0!==this.lordObtained&&e.push(new he.nb({name:(0,se.jsx)(Va.Trans,{id:"ast.crown-play.checklist.lord",components:[(0,se.jsx)(za.P9,{action:"LORD_OF_CROWNS"})]}),value:this.lordCasts,target:this.lordObtained,weight:Ae.WEIGHT.LORD})),this.checklist.add(new he.dV({displayOrder:5,name:(0,se.jsx)(Va.Trans,{id:"ast.crown=play.checklist.name",components:[(0,se.jsx)(za.P9,{action:"MINOR_ARCANA",showIcon:!1})]}),description:(0,se.jsx)(se.Fragment,{children:(0,se.jsx)(Va.Trans,{id:"ast.crown-play.checklist.description",components:[(0,se.jsx)(za.P9,{action:"MINOR_ARCANA"}),(0,se.jsx)(za.P9,{action:"LORD_OF_CROWNS"}),(0,se.jsx)(za.P9,{action:"LADY_OF_CROWNS"}),(0,se.jsx)(za.P9,{action:"MINOR_ARCANA"})]})}),tiers:Ae.SCORE,requirements:e}));var s=Math.floor(this.minorArcanaTotalDrift/this.data.actions.MINOR_ARCANA.cooldown);0===this.minorArcana?this.suggestions.add(new oe.q$({icon:this.data.actions.MINOR_ARCANA.icon,content:(0,se.jsx)(Va.Trans,{id:"ast.crown-play.suggestions.crown-play-no-usage.content",components:[(0,se.jsx)(za.P9,{action:"MINOR_ARCANA"})]}),why:(0,se.jsx)(Va.Trans,{id:"ast.crown-play.suggestions.crown-play-no-usage.why",values:{crownPlaysMissed:s},components:[(0,se.jsx)(za.P9,{action:"MINOR_ARCANA"})]}),severity:oe.bI.MAJOR})):this.suggestions.add(new oe.eg({icon:this.data.actions.MINOR_ARCANA.icon,content:(0,se.jsx)(Va.Trans,{id:"ast.crown-play.suggestions.crown-play-uses.content",components:[(0,se.jsx)(za.P9,{action:"MINOR_ARCANA"})]}),tiers:ye.MINOR_ARCANA,value:s,why:(0,se.jsx)(Va.Trans,{id:"ast.crown-play.suggestions.crown-play-uses.why",values:{0:this.parser.formatDuration(this.minorArcanaTotalDrift),crownPlaysMissed:s},components:[(0,se.jsx)(za.P9,{action:"MINOR_ARCANA"}),(0,se.jsx)(za.P9,{action:"MINOR_ARCANA",showIcon:!1})]})}))}}]),e}(Y.qk),_t.handle="crown_play",_t.title={id:"ast.crown-play.title",defaults:"Crown Play"},Pt=Ut,Ht=(0,S.Z)(Pt.prototype,"data",[z.I,Dt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),Mt=(0,S.Z)(Pt.prototype,"checklist",[z.I,jt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.checklist}}),Wt=(0,S.Z)(Pt.prototype,"suggestions",[z.I,Lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),Pt),fe=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(s=a.call.apply(a,u()(t=[this]).call(t,n))).trackedDefensives=[s.data.actions.EXALTATION,s.data.actions.CELESTIAL_INTERSECTION,s.data.actions.CELESTIAL_OPPOSITION,s.data.actions.COLLECTIVE_UNCONSCIOUS,s.data.actions.EARTHLY_STAR,s.data.actions.MACROCOSMOS],s}return e}(e(12541).O),we=e(20116),Ie=e.n(we),Re=e(73905),Oe=e(68156),Ee=e(45150),Te=(Ft=Reflect.metadata("design:type",Qa.TY),Gt=Reflect.metadata("design:type",X.V),Bt=Reflect.metadata("design:type",oe.ZP),Yt=Reflect.metadata("design:type",Ka.e),qt=Qt=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return s=a.call.apply(a,u()(t=[this]).call(t,n)),(0,O.Z)(s,"timeline",zt,(0,T.Z)(s)),(0,O.Z)(s,"data",Xt,(0,T.Z)(s)),(0,O.Z)(s,"suggestions",Jt,(0,T.Z)(s)),(0,O.Z)(s,"actors",Kt,(0,T.Z)(s)),s.history=[],s.currentWindow=void 0,s.castHook=void 0,s.lightspeedApplyHook=void 0,s.lightspeedRemoveHook=void 0,s.astrodyneApplyHook=void 0,s.astrodyneRemoveHook=void 0,s.teamMembers=[],s.arcanaStatuses=[],s.currentCardsPlayed=[],s.lastMAcast=void 0,s.lastLordCast=void 0,s.lordHeld=!1,s.ladyStatusHook=void 0,s.otherAst={timeOverwritten:0,countOverwritten:0,active:!1,start:0},s}return(0,E.Z)(e,[{key:"initialise",value:function(){var t,a,e=this,s=(0,V.hX)().status(this.data.statuses.DIVINATION.id);this.teamMembers=M()(t=Ie()(a=this.parser.pull.actors).call(a,(function(t){return t.playerControlled}))).call(t,(function(t){return t.id})),this.arcanaStatuses=M()(et).call(et,(function(t){return e.data.statuses[t].id})),this.addEventHook(s.source(this.parser.actor.id),this.countDivinationBuffs),this.addEventHook(s.type("statusApply").target(this.parser.actor.id),this.tryOpenWindow),this.addEventHook(s.type("statusRemove").target(this.parser.actor.id),this.tryCloseWindow),this.addEventHook((0,V.hX)().type("action").action(this.data.actions.MINOR_ARCANA.id),this.onMinorArcanaCast),this.addEventHook((0,V.hX)().type("action").action(this.data.actions.LORD_OF_CROWNS.id),this.onLordCast),this.addEventHook((0,V.hX)().type("statusApply").status(this.data.statuses.LORD_OF_CROWNS_DRAWN.id),this.onLordObtain),this.addEventHook((0,V.hX)().type("statusRemove").status(this.data.statuses.LORD_OF_CROWNS_DRAWN.id),this.onLordRemove),this.addEventHook((0,V.hX)().source(this.parser.actor.id).type("statusApply").status((0,V.kw)(this.arcanaStatuses)).target((0,V.kw)(this.teamMembers)),this.onCard),this.addEventHook((0,V.hX)().source(this.parser.actor.id).type("statusRemove").status((0,V.kw)(this.arcanaStatuses)).target((0,V.kw)(this.teamMembers)),this.offCard),this.addEventHook("complete",this.onComplete)}},{key:"countDivinationBuffs",value:function(t){var a;null!=this.currentWindow&&!F()(a=this.currentWindow.playersBuffed).call(a,t.target)&&this.actors.get(t.target).playerControlled&&this.currentWindow.playersBuffed.push(t.target)}},{key:"tryOpenWindow",value:function(t){this.parser.actor.id!==t.source&&(this.otherAst.active=!0,this.otherAst.start=t.timestamp,null!=this.currentWindow&&this.forceCloseWindow(t.timestamp)),void 0===this.currentWindow&&this.parser.actor.id===t.source&&(this.currentWindow={start:t.timestamp,rotation:[],gcdCount:0,source:t.source,playersBuffed:[],overlap:!1,lightspeed:!1,lord:0,possibleLord:0,astrodyne:!1,cardsInWindow:this.currentCardsPlayed.length},(null==this.lastMAcast||this.lastMAcast+this.data.actions.MINOR_ARCANA.cooldown+3500<this.currentWindow.start+this.data.statuses.DIVINATION.duration)&&(this.currentWindow.possibleLord+=1,this.ladyStatusHook=this.addEventHook((0,V.hX)().source(this.parser.actor.id).type("statusApply").status(this.data.statuses.LADY_OF_CROWNS_DRAWN.id),this.onLadyObtain)),(null!=this.lastMAcast&&null!=this.lastLordCast&&this.lastMAcast+this.data.actions.MINOR_ARCANA.cooldown>this.currentWindow.start&&this.lastLordCast>this.lastMAcast||this.lordHeld)&&(this.currentWindow.possibleLord+=1),this.castHook=this.addEventHook((0,V.hX)().source(this.parser.actor.id).type("action"),this.onCast),this.lightspeedApplyHook=this.addEventHook((0,V.hX)().source(this.parser.actor.id).type("statusApply").status(this.data.statuses.LIGHTSPEED.id),this.onLightspeed),this.lightspeedRemoveHook=this.addEventHook((0,V.hX)().source(this.parser.actor.id).type("statusRemove").status(this.data.statuses.LIGHTSPEED.id),this.onLightspeed),this.astrodyneApplyHook=this.addEventHook((0,V.hX)().source(this.parser.actor.id).type("statusApply").status(this.data.statuses.HARMONY_OF_SPIRIT.id),this.onAstrodyne),this.astrodyneRemoveHook=this.addEventHook((0,V.hX)().source(this.parser.actor.id).type("statusRemove").status(this.data.statuses.HARMONY_OF_SPIRIT.id),this.onAstrodyne),this.data.statuses.DIVINATION.duration>this.currentWindow.start-this.otherAst.start&&(this.otherAst.countOverwritten++,this.otherAst.timeOverwritten+=this.otherAst.start+this.data.statuses.DIVINATION.duration-t.timestamp,this.currentWindow.overlap=!0),this.otherAst.active=!1,this.otherAst.start=0)}},{key:"tryCloseWindow",value:function(t){t.source===this.parser.actor.id&&this.forceCloseWindow(t.timestamp)}},{key:"forceCloseWindow",value:function(t){null!=this.currentWindow&&(this.currentWindow.end=t,this.history.push(this.currentWindow),this.currentWindow=void 0,null!=this.castHook&&(this.removeEventHook(this.castHook),this.castHook=void 0),null!=this.lightspeedApplyHook&&(this.removeEventHook(this.lightspeedApplyHook),this.lightspeedApplyHook=void 0),null!=this.lightspeedRemoveHook&&(this.removeEventHook(this.lightspeedRemoveHook),this.lightspeedRemoveHook=void 0),null!=this.astrodyneApplyHook&&(this.removeEventHook(this.astrodyneApplyHook),this.astrodyneApplyHook=void 0),null!=this.astrodyneRemoveHook&&(this.removeEventHook(this.astrodyneRemoveHook),this.astrodyneRemoveHook=void 0),null!=this.ladyStatusHook&&(this.removeEventHook(this.ladyStatusHook),this.ladyStatusHook=void 0))}},{key:"onCast",value:function(t){if(null!=this.currentWindow){var a=this.data.getAction(t.action);null!=a&&(this.currentWindow.rotation.push(t),a.onGcd&&(this.currentWindow.gcdCount++,null!=this.currentWindow.end&&null==this.currentWindow.trailingGcdEvent&&(this.currentWindow.trailingGcdEvent=t)))}}},{key:"onLightspeed",value:function(){void 0!==this.currentWindow&&(this.currentWindow.lightspeed=!0)}},{key:"onAstrodyne",value:function(){void 0!==this.currentWindow&&(this.currentWindow.astrodyne=!0)}},{key:"onCard",value:function(t){this.currentCardsPlayed.push(t.target),void 0!==this.currentWindow&&(this.currentWindow.cardsInWindow+=1)}},{key:"offCard",value:function(t){var a;this.currentCardsPlayed=Ie()(a=this.currentCardsPlayed).call(a,(function(a){return a!==t.target}))}},{key:"onMinorArcanaCast",value:function(t){this.lastMAcast=t.timestamp}},{key:"onLordCast",value:function(t){this.lastLordCast=t.timestamp,void 0!==this.currentWindow&&(this.currentWindow.lord+=1)}},{key:"onLordObtain",value:function(){this.lordHeld=!0}},{key:"onLordRemove",value:function(){this.lordHeld=!1}},{key:"onLadyObtain",value:function(){void 0!==this.currentWindow&&0!==this.currentWindow.possibleLord&&(this.currentWindow.possibleLord-=1)}},{key:"onComplete",value:function(){var t;0!==this.otherAst.countOverwritten&&this.suggestions.add(new oe.q$({icon:this.data.actions.DIVINATION.icon,content:(0,se.jsx)(Va.Trans,{id:"ast.divination.suggestion.usage.content",components:[(0,se.jsx)(za.P9,{action:"DIVINATION"})]}),severity:oe.bI.MAJOR,why:(0,se.jsx)(Va.Trans,{id:"ast.divination.suggestion.usage.why",values:{0:this.otherAst.countOverwritten,1:this.otherAst.countOverwritten,2:this.parser.formatDuration(this.otherAst.timeOverwritten)},components:[(0,se.jsx)(za.P9,{action:"DIVINATION"})]})}));var a=Ie()(t=this.history).call(t,(function(t){return!t.lightspeed})).length;0!==a&&this.suggestions.add(new oe.q$({icon:this.data.actions.LIGHTSPEED.icon,content:(0,se.jsx)(Va.Trans,{id:"ast.divination.suggestion.lightspeed.usage.content",components:[(0,se.jsx)(za.P9,{action:"LIGHTSPEED"}),(0,se.jsx)(za.P9,{action:"DIVINATION"}),(0,se.jsx)(za.P9,{action:"LIGHTSPEED",showIcon:!1}),(0,se.jsx)(za.P9,{action:"DIVINATION",showIcon:!1})]}),severity:oe.bI.MAJOR,why:(0,se.jsx)(Va.Trans,{id:"ast.divination.suggestion.lightspeed.usage.why",values:{unusedLightspeed:a},components:[(0,se.jsx)(za.P9,{action:"LIGHTSPEED"}),(0,se.jsx)(za.P9,{action:"DIVINATION"})]})}))}},{key:"output",value:function(){var t,a=this;this.forceCloseWindow(this.parser.pull.duration);var e=M()(t=this.history).call(t,(function(t){var e=null!=t.end?t.end-a.parser.pull.timestamp:a.parser.pull.duration;return{start:t.start-a.parser.pull.timestamp,end:e,rotation:t.rotation,targetsData:{gcds:{actual:t.gcdCount,expected:6},playersBuffed:{actual:t.playersBuffed.length,expected:8},cardsPlayed:{actual:t.cardsInWindow,expected:3},lordsUsed:{actual:t.lord,expected:t.possibleLord}},notesMap:{otherAst:(0,se.jsx)(se.Fragment,{children:a.getNotesIcon(t.overlap)}),lightspeedActive:(0,se.jsx)(se.Fragment,{children:a.getNotesIconWithCheck(t.lightspeed)}),astrodyneActive:(0,se.jsx)(se.Fragment,{children:a.getNotesIconWithCheck(t.astrodyne)})}}})),s=e.length,i=(0,se.jsx)("p",{children:(0,se.jsx)("span",{className:"text-error",children:(0,se.jsx)(Va.Trans,{id:"ast.divination.messages.no-casts",components:[(0,se.jsx)(za.P9,{action:"DIVINATION"})]})})}),n=(0,se.jsx)("p",{children:(0,se.jsx)(Va.Trans,{id:"ast.divination.description",components:[(0,se.jsx)(za.P9,{action:"DIVINATION"}),(0,se.jsx)("br",{}),(0,se.jsx)(za.P9,{action:"PLAY"}),(0,se.jsx)(za.P9,{action:"ASTRODYNE"}),(0,se.jsx)(za.P9,{action:"LORD_OF_CROWNS"}),(0,se.jsx)(za.P9,{action:"LIGHTSPEED"}),(0,se.jsx)(za.P9,{action:"DIVINATION",showIcon:!1})]})}),o=(0,se.jsx)("p",{children:(0,se.jsx)(Va.Trans,{id:"ast.divination.footnote",values:{MINOR_ARCANA_GCD_ALLOWANCE:3.5},components:[(0,se.jsx)(za.P9,{action:"MINOR_ARCANA"}),(0,se.jsx)(za.P9,{action:"DIVINATION",showIcon:!1}),(0,se.jsx)(za.P9,{action:"LORD_OF_CROWNS",showIcon:!1}),(0,se.jsx)(za.P9,{action:"LORD_OF_CROWNS",showIcon:!1}),(0,se.jsx)(za.P9,{action:"MINOR_ARCANA",showIcon:!1}),(0,se.jsx)("br",{}),(0,se.jsx)(za.P9,{action:"LORD_OF_CROWNS",showIcon:!1}),(0,se.jsx)(za.P9,{action:"MINOR_ARCANA",showIcon:!1}),(0,se.jsx)(za.P9,{action:"DIVINATION",showIcon:!1}),(0,se.jsx)(za.P9,{action:"LORD_OF_CROWNS",showIcon:!1}),(0,se.jsx)(za.P9,{action:"LORD_OF_CROWNS",showIcon:!1}),(0,se.jsx)("br",{}),(0,se.jsx)(za.P9,{action:"DIVINATION",showIcon:!1}),(0,se.jsx)(za.P9,{action:"DIVINATION",showIcon:!1})]})});return 0!==this.otherAst.countOverwritten?(0,se.jsxs)(qa.Fragment,{children:[n,(0,se.jsx)(Re.y,{targets:[{header:(0,se.jsx)(Va.Trans,{id:"ast.arcana-tracking.divination.playertarget"}),accessor:"playersBuffed"},{header:(0,se.jsx)(Va.Trans,{id:"ast.divination.rotation-table.header.gcd-count"}),accessor:"gcds"},{header:(0,se.jsx)(za.P9,{action:"PLAY",showName:!1}),accessor:"cardsPlayed"},{header:(0,se.jsx)(za.P9,{action:"LORD_OF_CROWNS",showName:!1}),accessor:"lordsUsed"}],notes:[{header:(0,se.jsx)(Va.Trans,{id:"ast.divination.rotation-table.header.overwrite"}),accessor:"otherAst"},{header:(0,se.jsx)(za.P9,{action:"LIGHTSPEED",showName:!1}),accessor:"lightspeedActive"},{header:(0,se.jsx)(za.P9,{action:"ASTRODYNE",showName:!1}),accessor:"astrodyneActive"}],data:e,onGoto:this.timeline.show}),o]}):(0,se.jsxs)(qa.Fragment,{children:[n,s>0?"":(0,se.jsx)(Oe.Z,{children:i}),s>0?(0,se.jsx)(Re.y,{targets:[{header:(0,se.jsx)(Va.Trans,{id:"ast.arcana-tracking.divination.playertarget"}),accessor:"playersBuffed"},{header:(0,se.jsx)(Va.Trans,{id:"ast.divination.rotation-table.header.gcd-count"}),accessor:"gcds"},{header:(0,se.jsx)(za.P9,{action:"PLAY",showName:!1}),accessor:"cardsPlayed"},{header:(0,se.jsx)(za.P9,{action:"LORD_OF_CROWNS",showName:!1}),accessor:"lordsUsed"}],notes:[{header:(0,se.jsx)(za.P9,{action:"LIGHTSPEED",showName:!1}),accessor:"lightspeedActive"},{header:(0,se.jsx)(za.P9,{action:"ASTRODYNE",showName:!1}),accessor:"astrodyneActive"}],data:e,onGoto:this.timeline.show}):"",o]})}},{key:"getNotesIcon",value:function(t){return t?(0,se.jsx)(Ee.Z,{name:"remove",className:"text-error"}):""}},{key:"getNotesIconWithCheck",value:function(t){return(0,se.jsx)(Ee.Z,{name:t?"checkmark":"remove",className:t?"text-success":"text-error"})}}]),e}(Y.qk),Qt.handle="Divination",Qt.title={id:"ast.divination.title",defaults:"Divination"},Qt.displayOrder=53,Vt=qt,zt=(0,S.Z)(Vt.prototype,"timeline",[z.I,Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.timeline}}),Xt=(0,S.Z)(Vt.prototype,"data",[z.I,Gt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),Jt=(0,S.Z)(Vt.prototype,"suggestions",[z.I,Bt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),Kt=(0,S.Z)(Vt.prototype,"actors",[z.I,Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.actors}}),Vt),Se={DRAW_HOLDING:{1:oe.bI.MINOR,2:oe.bI.MEDIUM,6:oe.bI.MAJOR}},Ce=($t=Reflect.metadata("design:type",X.V),ta=Reflect.metadata("design:type",he.ZP),aa=Reflect.metadata("design:type",oe.ZP),ea=Reflect.metadata("design:type",Ba),ca=la=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return s=a.call.apply(a,u()(t=[this]).call(t,n)),(0,O.Z)(s,"data",ia,(0,T.Z)(s)),(0,O.Z)(s,"checklist",na,(0,T.Z)(s)),(0,O.Z)(s,"suggestions",oa,(0,T.Z)(s)),(0,O.Z)(s,"arcanaTracking",ra,(0,T.Z)(s)),s.draws=0,s.cooldownEndTime=s.parser.pull.timestamp,s.drawTotalDrift=0,s.plays=0,s.prepullPrepped=!1,s.playActions=[],s.arcanaStatuses=[],s}return(0,E.Z)(e,[{key:"initialise",value:function(){var t=this;this.playActions=M()(J).call(J,(function(a){return t.data.actions[a].id})),this.arcanaStatuses=M()(et).call(et,(function(a){return t.data.statuses[a].id}));var a=(0,V.hX)().source(this.parser.actor.id);this.addEventHook(a.type("action").action(this.data.actions.DRAW.id),this.onDraw),this.addEventHook(a.type("action").action((0,V.kw)(this.playActions)),this.onPlay),this.addEventHook(a.type("statusApply").status((0,V.kw)(this.arcanaStatuses)),this.onPlayBuff),this.addEventHook("complete",this.onComplete)}},{key:"onDraw",value:function(t){t.timestamp>this.parser.pull.timestamp&&(this.drawTotalDrift+=Math.max(0,t.timestamp-this.cooldownEndTime),this.cooldownEndTime=this.data.actions.DRAW.cooldown+Math.max(this.cooldownEndTime,t.timestamp),this.draws++)}},{key:"onPlay",value:function(){this.plays++}},{key:"onPlayBuff",value:function(t){t.timestamp>this.parser.pull.timestamp||(this.prepullPrepped=!0,this.plays++)}},{key:"onComplete",value:function(){var t,a=this.parser.pull.duration+this.parser.pull.timestamp;this.drawTotalDrift+=Math.max(0,a-this.cooldownEndTime)-7500,this.drawTotalDrift=Math.min(this.parser.pull.duration,this.drawTotalDrift);var e=Math.ceil(Math.max(0,this.parser.pull.duration-7500)/this.data.actions.DRAW.cooldown)+(this.data.actions.DRAW.charges-1),s=this.arcanaTracking.getPullState();this.prepullPrepped=!!s.drawState;var i=e+(this.prepullPrepped?1:0),n=(this.prepullPrepped?1:0)+this.draws,o=Math.floor((i-2)/i*100),r=Math.floor((i-3)/i*100);this.checklist.add(new he.dV({displayOrder:4,name:(0,se.jsx)(Va.Trans,{id:"ast.draw.checklist.name",defaults:"Play as many cards as possible"}),description:(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(Va.Trans,{id:"ast.draw.checklist.description",defaults:"Playing cards provides seals for <0/> and casting <1/> will help with mana management.",components:[(0,se.jsx)(za.P9,{action:"ASTRODYNE"}),(0,se.jsx)(za.P9,{action:"DRAW"})]}),(0,se.jsxs)("ul",{children:[(0,se.jsxs)("li",{children:[(0,se.jsx)(Va.Trans,{id:"ast.draw.checklist.description.prepull",defaults:"Prepared before pull:"}),"",this.prepullPrepped?1:0,"/1"]}),(0,se.jsxs)("li",{children:[(0,se.jsx)(Va.Trans,{id:"ast.draw.checklist.description.draws",defaults:"Obtained from <0/>:",components:[(0,se.jsx)(za.P9,{action:"DRAW"})]}),"",this.draws,"/",e]}),(0,se.jsxs)("li",{children:[(0,se.jsx)(Va.Trans,{id:"ast.draw.checklist.description.total",defaults:"Total cards obtained:"}),"",n,"/",i]})]})]}),tiers:(t={},(0,Ya.Z)(t,o,he.hI.WARN),(0,Ya.Z)(t,r,he.hI.FAIL),(0,Ya.Z)(t,100,he.hI.SUCCESS),t),requirements:[new he.nb({name:(0,se.jsx)(Va.Trans,{id:"ast.draw.checklist.requirement.name",defaults:"<0/> uses",components:[(0,se.jsx)(za.P9,{action:"PLAY"})]}),value:this.plays,target:i})]}));var l=Math.floor(this.drawTotalDrift/this.data.actions.DRAW.cooldown);0===this.draws?this.suggestions.add(new oe.q$({icon:this.data.actions.DRAW.icon,content:(0,se.jsx)(Va.Trans,{id:"ast.draw.suggestions.draw-no-usage.content",defaults:"No uses of <0/> at all.",components:[(0,se.jsx)(za.P9,{action:"DRAW"})]}),why:(0,se.jsx)(Va.Trans,{id:"ast.draw.suggestions.draw-no-usage.why",defaults:"No draws used."}),severity:oe.bI.MAJOR})):this.suggestions.add(new oe.eg({icon:this.data.actions.DRAW.icon,content:(0,se.jsx)(Va.Trans,{id:"ast.draw.suggestions.draw-uses.content",defaults:"Consider casting <0/> as soon as its available to maximize both MP regen and the number of cards played.",components:[(0,se.jsx)(za.P9,{action:"DRAW"})]}),tiers:Se.DRAW_HOLDING,value:l,why:(0,se.jsx)(Va.Trans,{id:"ast.draw.suggestions.draw-uses.why",defaults:"About {drawsMissed, plural, one {# use} other {# uses}} of <0/> {drawsMissed, plural, one {was} other {were}} missed by holding two cards on full cooldown for at least a total of {0}.",values:{0:this.parser.formatDuration(this.drawTotalDrift),drawsMissed:l},components:[(0,se.jsx)(za.P9,{action:"DRAW"})]})}))}}]),e}(Y.qk),la.handle="draw",la.title={id:"ast.draw.title",defaults:"Draw"},sa=ca,ia=(0,S.Z)(sa.prototype,"data",[z.I,$t],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),na=(0,S.Z)(sa.prototype,"checklist",[z.I,ta],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.checklist}}),oa=(0,S.Z)(sa.prototype,"suggestions",[z.I,aa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),ra=(0,S.Z)(sa.prototype,"arcanaTracking",[z.I,ea],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.arcanaTracking}}),sa),Ze={UNCOOKED:{1:oe.bI.MEDIUM,2:oe.bI.MAJOR},USES_MISSED:{1:oe.bI.MEDIUM,2:oe.bI.MAJOR}},Ne=(da=Reflect.metadata("design:type",X.V),ua=Reflect.metadata("design:type",oe.ZP),Aa=ga=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return s=a.call.apply(a,u()(t=[this]).call(t,n)),(0,O.Z)(s,"data",pa,(0,T.Z)(s)),(0,O.Z)(s,"suggestions",ma,(0,T.Z)(s)),s.prepull=!1,s.uses=0,s.lastUse=0,s.totalHeld=0,s.earlyBurstCount=0,s.petCasts=[s.data.actions.STELLAR_BURST.id,s.data.actions.STELLAR_EXPLOSION.id],s}return(0,E.Z)(e,[{key:"initialise",value:function(){this.addEventHook((0,V.hX)().source(this.parser.actor.id).type("action").action(this.data.actions.EARTHLY_STAR.id),this.onPlace),this.addEventHook((0,V.hX)().source("pet").type("action").action((0,V.kw)(this.petCasts)),this.onPetCast),this.addEventHook("complete",this._onComplete)}},{key:"onPlace",value:function(t){this.uses++,t.timestamp<this.parser.pull.timestamp&&(this.prepull=!0),0===this.lastUse&&(this.lastUse=this.parser.pull.timestamp);var a;a=1!==this.uses||this.prepull?t.timestamp-this.lastUse-this.data.actions.EARTHLY_STAR.cooldown:t.timestamp-this.parser.pull.timestamp,this.totalHeld+=Math.max(0,a),this.lastUse=t.timestamp}},{key:"onPetCast",value:function(t){t.action===this.data.actions.STELLAR_BURST.id&&this.earlyBurstCount++}},{key:"_onComplete",value:function(){var t=this.earlyBurstCount;t>0&&this.suggestions.add(new oe.eg({icon:this.data.actions.STELLAR_DETONATION.icon,content:(0,se.jsx)(Va.Trans,{id:"ast.earthly-star.suggestion.uncooked.content",defaults:"Plan your <0/> placements so that it's always cooked enough for the full potency when you need it.",components:[(0,se.jsx)(za.P9,{action:"EARTHLY_STAR"})]}),why:(0,se.jsx)(Va.Trans,{id:"ast.earthly-star.suggestion.uncooked.why",defaults:"{earlyBurstCount, plural, one {# detonation} other {# detonations}} of an uncooked Earthly Star.",values:{earlyBurstCount:t}}),tiers:Ze.UNCOOKED,value:t})),this.parser.pull.duration+this.parser.pull.timestamp-this.lastUse>this.data.actions.EARTHLY_STAR.cooldown&&(this.totalHeld+=this.parser.pull.duration+this.parser.pull.timestamp-(this.lastUse+this.data.actions.EARTHLY_STAR.cooldown));var a=0===this.uses?this.parser.pull.duration:this.totalHeld,e=Math.floor(a/this.data.actions.EARTHLY_STAR.cooldown);this.suggestions.add(new oe.eg({icon:this.data.actions.EARTHLY_STAR.icon,content:(0,se.jsx)(Va.Trans,{id:"ast.earthly-star.suggestion.missed-use.content",defaults:"Use <0/> more frequently. It may save a healing GCD and results in more damage output.",components:[(0,se.jsx)(za.P9,{action:"EARTHLY_STAR"})]}),tiers:Ze.USES_MISSED,value:e,why:(0,se.jsx)(Va.Trans,{id:"ast.earthly-star.suggestion.missed-use.why",defaults:"About {usesMissed} uses of Earthly Star were missed by holding it for at least a total of {0}.",values:{0:this.parser.formatDuration(a),usesMissed:e}})}))}}]),e}(Y.qk),ga.handle="earthlystar",ga.title={id:"ast.earthly-star.title",defaults:"Earthly Star"},ha=Aa,pa=(0,S.Z)(ha.prototype,"data",[z.I,da],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),ma=(0,S.Z)(ha.prototype,"suggestions",[z.I,ua],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),ha),ke=e(81336),be={WASTED_AOE_HEAL_TIERS:{1:oe.bI.MINOR,5:oe.bI.MEDIUM}},xe=(ya=Reflect.metadata("design:type",X.V),va=Reflect.metadata("design:type",ke.w),fa=Reflect.metadata("design:type",oe.ZP),Ta=Ea=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return s=a.call.apply(a,u()(t=[this]).call(t,n)),(0,O.Z)(s,"data",Ia,(0,T.Z)(s)),(0,O.Z)(s,"cooldowns",Ra,(0,T.Z)(s)),(0,O.Z)(s,"suggestions",Oa,(0,T.Z)(s)),s.nonHoroscopeHeals=0,s}return(0,E.Z)(e,[{key:"initialise",value:function(){var t=(0,V.hX)().source(this.parser.actor.id);this.addEventHook(t.type("action").action(this.data.actions.HELIOS.id),this.onHeliosCast),this.addEventHook(t.type("action").action(this.data.actions.ASPECTED_HELIOS.id),this.onAspectedHeliosCast),this.addEventHook("complete",this.onComplete)}},{key:"onAspectedHeliosCast",value:function(){this.data.actions.HOROSCOPE.cooldown-this.cooldowns.remaining("HOROSCOPE")<this.data.statuses.HOROSCOPE.duration||this.data.actions.NEUTRAL_SECT.cooldown-this.cooldowns.remaining("NEUTRAL_SECT")<this.data.statuses.NEUTRAL_SECT.duration||this.cooldowns.remaining("NEUTRAL_SECT")>0&&this.cooldowns.remaining("HOROSCOPE")>0||this.nonHoroscopeHeals++}},{key:"onHeliosCast",value:function(){this.data.actions.HOROSCOPE.cooldown-this.cooldowns.remaining("HOROSCOPE")<this.data.statuses.HOROSCOPE.duration||this.cooldowns.remaining("HOROSCOPE")>0||this.nonHoroscopeHeals++}},{key:"onComplete",value:function(){this.suggestions.add(new oe.eg({icon:this.data.actions.HELIOS.icon,content:(0,se.jsx)(Va.Trans,{id:"ast.horoscope.suggestion.usage.content",defaults:"Try to plan your <0/> or <1/> usages to have either up before you need to cast <2/> or <3/>.<4/> and <5/> may help to cover more damage later without needing to cast additional AOE heals.",components:[(0,se.jsx)(za.P9,{action:"HOROSCOPE"}),(0,se.jsx)(za.P9,{action:"NEUTRAL_SECT"}),(0,se.jsx)(za.P9,{action:"HELIOS"}),(0,se.jsx)(za.P9,{action:"ASPECTED_HELIOS"}),(0,se.jsx)(za.P9,{status:"HOROSCOPE_HELIOS",showIcon:!1}),(0,se.jsx)(za.P9,{action:"NEUTRAL_SECT",showIcon:!1})]}),tiers:be.WASTED_AOE_HEAL_TIERS,value:this.nonHoroscopeHeals,why:(0,se.jsx)(Va.Trans,{id:"ast.horoscope.suggestion.usage.why",defaults:"{0, plural, one {# AOE GCD heal was cast} other {# AOE GCD heals were cast}} without <0/> or <1/> even though one of the two abilities were available.",values:{0:this.nonHoroscopeHeals},components:[(0,se.jsx)(za.P9,{action:"HOROSCOPE"}),(0,se.jsx)(za.P9,{action:"NEUTRAL_SECT"})]})}))}}]),e}(Y.qk),Ea.handle="horoscope",Ea.title={id:"ast.horoscope.title",defaults:"Horoscope"},wa=Ta,Ia=(0,S.Z)(wa.prototype,"data",[z.I,ya],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),Ra=(0,S.Z)(wa.prototype,"cooldowns",[z.I,va],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.cooldowns}}),Oa=(0,S.Z)(wa.prototype,"suggestions",[z.I,fa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),wa),De=(Sa=Reflect.metadata("design:type",X.V),Ca=Reflect.metadata("design:type",de.Z),xa=ba=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return s=a.call.apply(a,u()(t=[this]).call(t,n)),(0,O.Z)(s,"data",Na,(0,T.Z)(s)),(0,O.Z)(s,"castTime",ka,(0,T.Z)(s)),s.castedTime=void 0,s.castTimeIndex=null,s}return(0,E.Z)(e,[{key:"initialise",value:function(){var t=(0,V.hX)().status(this.data.statuses.LIGHTSPEED.id);this.addEventHook(t.type("statusApply").target(this.parser.actor.id),this.tryOpenWindow),this.addEventHook(t.type("statusRemove").target(this.parser.actor.id),this.tryCloseWindow)}},{key:"tryOpenWindow",value:function(t){void 0===this.castedTime&&(this.castedTime=t.timestamp,this.castTimeIndex=this.castTime.setTimeAdjustment("all",-2500))}},{key:"tryCloseWindow",value:function(){null!=this.castedTime&&(this.castedTime=void 0,this.castTime.reset(this.castTimeIndex),this.castTimeIndex=null)}}]),e}(Y.qk),ba.handle="Lightspeed",Za=xa,Na=(0,S.Z)(Za.prototype,"data",[z.I,Sa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),ka=(0,S.Z)(Za.prototype,"castTime",[z.I,Ca],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.castTime}}),Za),je=e(90577),Le={GRAVITY:{1:oe.bI.MINOR,3:oe.bI.MEDIUM,10:oe.bI.MAJOR},NOTGRAVITY:{.2:oe.bI.MINOR,.6:oe.bI.MEDIUM,.8:oe.bI.MAJOR}},Pe=(Da=Reflect.metadata("design:type",X.V),ja=Reflect.metadata("design:type",oe.ZP),La=Reflect.metadata("design:type",je.I),Pa=Reflect.metadata("design:type",ke.w),Ga=Fa=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return s=a.call.apply(a,u()(t=[this]).call(t,n)),(0,O.Z)(s,"data",Ma,(0,T.Z)(s)),(0,O.Z)(s,"suggestions",Wa,(0,T.Z)(s)),(0,O.Z)(s,"invulnerability",_a,(0,T.Z)(s)),(0,O.Z)(s,"cooldowns",Ua,(0,T.Z)(s)),s.macrocosmosUses=0,s.gravityIIUses=0,s}return(0,E.Z)(e,[{key:"initialise",value:function(){this.addEventHook((0,V.hX)().source(this.parser.actor.id).type("action").action(this.data.actions.MACROCOSMOS.id),this.onMacrocosmosCast),this.addEventHook((0,V.hX)().source(this.parser.actor.id).type("action").action(this.data.actions.GRAVITY_II.id),this.onGravityIICast),this.addEventHook("complete",this.onComplete)}},{key:"onMacrocosmosCast",value:function(){this.macrocosmosUses++}},{key:"onGravityIICast",value:function(){this.cooldowns.remaining("MACROCOSMOS")+2500>0||this.gravityIIUses++}},{key:"onComplete",value:function(){var t=Math.ceil((this.parser.pull.duration- -this.invulnerability.getDuration({types:["invulnerable"]}))/this.data.actions.MACROCOSMOS.cooldown),a=this.macrocosmosUses/t,e=(0,se.jsx)(Va.Trans,{id:"ast.macrocosmos.content.multiple-target",defaults:"<0/> has a higher potency per target than <1/> and <2/> should be utilized as much as possible in lieu of <3/>.",components:[(0,se.jsx)(za.P9,{action:"MACROCOSMOS",showIcon:!1}),(0,se.jsx)(za.P9,{action:"GRAVITY_II"}),(0,se.jsx)(za.P9,{action:"MACROCOSMOS",showIcon:!1}),(0,se.jsx)(za.P9,{action:"GRAVITY_II",showIcon:!1})]}),s=(0,se.jsx)(Va.Trans,{id:"ast.macrocosmos.content.general",defaults:"Consider utilizing <0/> more frequently. <1/> has the same potency as <2/>; however, <3/> can be utilized to weave in healing for incoming raid wide attacks leading to more value for your GCD. <4/>",components:[(0,se.jsx)(za.P9,{action:"MACROCOSMOS"}),(0,se.jsx)(za.P9,{action:"MACROCOSMOS",showIcon:!1}),(0,se.jsx)(za.P9,{action:"FALL_MALEFIC"}),(0,se.jsx)(za.P9,{action:"MACROCOSMOS",showIcon:!1}),(0,se.jsx)("br",{})]}),i=(0,se.jsx)(Va.Trans,{id:"ast.macrocosmos.why.multiple-target",defaults:"There {0, plural, one {was} other {were}} {1} {2, plural, one {cast} other {casts}} noted for <0/> when <1/> was available.",values:{0:this.gravityIIUses,1:this.gravityIIUses,2:this.gravityIIUses},components:[(0,se.jsx)(za.P9,{action:"GRAVITY_II"}),(0,se.jsx)(za.P9,{action:"MACROCOSMOS"})]}),n=(0,se.jsx)(Va.Trans,{id:"ast.macrocosmos.why.general",defaults:"Out of a possible {macrocosmosMaxUses} {macrocosmosMaxUses, plural, one {cast} other {casts}} during available dps uptime, there {0, plural, one {was} other {were}} {1} {2, plural, one {cast} other {casts}} noted. <0/>",values:{0:this.macrocosmosUses,1:this.macrocosmosUses,2:this.macrocosmosUses,macrocosmosMaxUses:t},components:[(0,se.jsx)("br",{})]}),o=(0,se.jsx)("p",{children:(0,se.jsx)("span",{className:"text-error",children:(0,se.jsx)(Va.Trans,{id:"ast.macrocosmos.why.nocasts",defaults:"There were no casts recorded for <0/>.",components:[(0,se.jsx)(za.P9,{action:"MACROCOSMOS"})]})})}),r=0===this.gravityIIUses?[s]:[e],l=0===this.macrocosmosUses?[o]:[n];0!==this.gravityIIUses&&l.push(i),0===this.macrocosmosUses&&0===this.gravityIIUses?this.suggestions.add(new oe.q$({icon:this.data.actions.MACROCOSMOS.icon,content:r,severity:oe.bI.MAJOR,why:l})):0!==this.macrocosmosUses&&0===this.gravityIIUses?this.suggestions.add(new oe.eg({icon:this.data.actions.MACROCOSMOS.icon,content:r,tiers:Le.NOTGRAVITY,value:1-a,why:l})):this.suggestions.add(new oe.eg({icon:this.data.actions.MACROCOSMOS.icon,content:r,tiers:Le.GRAVITY,value:this.gravityIIUses,why:l}))}}]),e}(Y.qk),Fa.handle="macrocosmos",Ha=Ga,Ma=(0,S.Z)(Ha.prototype,"data",[z.I,Da],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),Wa=(0,S.Z)(Ha.prototype,"suggestions",[z.I,ja],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),_a=(0,S.Z)(Ha.prototype,"invulnerability",[z.I,La],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.invulnerability}}),Ua=(0,S.Z)(Ha.prototype,"cooldowns",[z.I,Pa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.cooldowns}}),Ha),He=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(s=a.call.apply(a,u()(t=[this]).call(t,n))).checklistName=(0,se.jsx)(Va.Trans,{id:"ast.ogcd-downtime.divination.name"}),s.checklistDescription=(0,se.jsx)(Va.Trans,{id:"ast.ogcd-downtime.divination.description",components:[(0,se.jsx)(za.P9,{action:"DIVINATION"})]}),s.checklistTarget=100,s.trackedDisplayOrder=3,s.DPS_COOLDOWNS_TRACKED=[{cooldowns:[s.data.actions.DIVINATION],content:(0,se.jsx)(Va.Trans,{id:"ast.ogcds_dps.divination.content",components:[(0,se.jsx)(za.P9,{action:"DIVINATION"}),(0,se.jsx)(za.P9,{action:"DIVINATION"})]}),allowedAverageDowntime:2500}],s.trackedCds=s.DPS_COOLDOWNS_TRACKED,s}return e}(e(48945).u),Me=e(26823),We=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(s=a.call.apply(a,u()(t=[this]).call(t,n))).checklistRuleBreakout=!0,s.displayPieChart=!0,s.displaySuggestion=!0,s.displayOrder=7,s.content=(0,se.jsx)(Va.Trans,{id:"ast.overheal.suggestion.content",components:[(0,se.jsx)("br",{}),(0,se.jsx)(za.P9,{action:"EXALTATION"}),(0,se.jsx)(za.P9,{action:"HOROSCOPE"}),(0,se.jsx)(za.P9,{action:"MACROCOSMOS"})]}),s.trackedHealCategories=[{name:(0,se.jsx)(Va.Trans,{id:"ast.overheal.hot.name"}),color:Me.Av[1],trackedHealIds:[s.data.statuses.ASPECTED_HELIOS.id,s.data.statuses.WHEEL_OF_FORTUNE.id,s.data.statuses.ASPECTED_BENEFIC.id,s.data.statuses.OPPOSITION.id]},{name:(0,se.jsx)(Va.Trans,{id:"ast.overheal.earthlystar.name"}),color:Me.Av[2],trackedHealIds:[s.data.actions.STELLAR_BURST.id,s.data.actions.STELLAR_EXPLOSION.id]},{name:(0,se.jsx)(Va.Trans,{id:"ast.overheal.delayedheals.name"}),color:Me.Av[3],trackedHealIds:[s.data.statuses.HOROSCOPE_HELIOS.id,s.data.statuses.EXALTATION.id,s.data.statuses.MACROCOSMOS.id]}],s}return(0,E.Z)(e,[{key:"checklistDescription",value:function(t){return this.content}}]),e}(Me.Bv);We.handle="overheal";var _e,Ue,Fe,Ge,Be,Ye,Ve,ze,Xe,Je=e(74407),Ke=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){return(0,r.Z)(this,e),a.apply(this,arguments)}return e}(e(74136).z);Ke.statusesStackMapping=(0,Ya.Z)({},Je.ZP.GIANT_DOMINANCE.id,Je.ZP.EARTHLY_DOMINANCE.id);var Qe={WASTED_ST_HEAL_TIERS:{1:oe.bI.MINOR,10:oe.bI.MEDIUM}},qe=["BENEFIC","BENEFIC_II"],$e=(_e=Reflect.metadata("design:type",X.V),Ue=Reflect.metadata("design:type",oe.ZP),Fe=Reflect.metadata("design:type",ke.w),Xe=ze=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return s=a.call.apply(a,u()(t=[this]).call(t,n)),(0,O.Z)(s,"data",Be,(0,T.Z)(s)),(0,O.Z)(s,"suggestions",Ye,(0,T.Z)(s)),(0,O.Z)(s,"cooldowns",Ve,(0,T.Z)(s)),s.nonSynastryHeals=0,s.gcdStHeal=[],s}return(0,E.Z)(e,[{key:"initialise",value:function(){var t=this;qe.forEach((function(a){t.gcdStHeal.push(t.data.actions[a].id)})),this.addEventHook((0,V.hX)().source(this.parser.actor.id).type("action").action((0,V.kw)(this.gcdStHeal)),this.onSingleTargetHealCast),this.addEventHook("complete",this.onComplete)}},{key:"onSingleTargetHealCast",value:function(){this.cooldowns.remaining("SYNASTRY")>0||this.nonSynastryHeals++}},{key:"onComplete",value:function(){this.suggestions.add(new oe.eg({icon:this.data.actions.SYNASTRY.icon,content:(0,se.jsx)(Va.Trans,{id:"ast.synastry.suggestion.content",defaults:"Try to use <0/> if you need to cast a single-target GCD heal. The GCD heal itself is already an efficiency loss, so it's better to make it as strong as possible if Synastry is not needed soon.",components:[(0,se.jsx)(za.P9,{action:"SYNASTRY"})]}),tiers:Qe.WASTED_ST_HEAL_TIERS,value:this.nonSynastryHeals,why:(0,se.jsx)(Va.Trans,{id:"ast.synastry.suggestion.why",defaults:"{0, plural, one {# single-target GCD heal was cast} other {# single-target GCD heals were cast}} without synastry even though it was available.",values:{0:this.nonSynastryHeals}})}))}}]),e}(Y.qk),ze.handle="synastry",Ge=Xe,Be=(0,S.Z)(Ge.prototype,"data",[z.I,_e],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.data}}),Ye=(0,S.Z)(Ge.prototype,"suggestions",[z.I,Ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.suggestions}}),Ve=(0,S.Z)(Ge.prototype,"cooldowns",[z.I,Fe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.cooldowns}}),Ge),ts=e(37517),as=function(t){(0,l.Z)(e,t);var a=(0,c.Z)(e);function e(){var t,s;(0,r.Z)(this,e);for(var i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return(s=a.call.apply(a,u()(t=[this]).call(t,n))).prependMessages=(0,se.jsx)(Oe.Z,{children:(0,se.jsx)(Va.Trans,{id:"ast.tincture.prepend.content",defaults:"Tracking for <0/> will be added in a future update, but make sure you get as many uses as possible in each Tincture window.",components:[(0,se.jsx)(za.P9,{action:"LORD_OF_CROWNS"})]})}),s}return(0,E.Z)(e,[{key:"initialise",value:function(){(0,le.Z)((0,ce.Z)(e.prototype),"initialise",this).call(this),this.trackOnlyActions([this.data.actions.FALL_MALEFIC.id,this.data.actions.COMBUST_III.id,this.data.actions.GRAVITY_II.id,this.data.actions.ASTRODYNE.id,this.data.actions.MACROCOSMOS.id,this.data.actions.LORD_OF_CROWNS.id,this.data.actions.EARTHLY_STAR.id,this.data.actions.DIVINATION.id]),this.addEvaluator(new ts.np({expectedActions:[{action:this.data.actions.COMBUST_III,expectedPerWindow:1},{action:this.data.actions.ASTRODYNE,expectedPerWindow:1},{action:this.data.actions.DIVINATION,expectedPerWindow:1}],suggestionIcon:this.data.actions.INFUSION_MND.icon,suggestionContent:(0,se.jsx)(Va.Trans,{id:"ast.tincture.suggestions.trackedActions.content",defaults:"Try to cover as much damage as possible with your Tinctures of Mind."}),suggestionWindowName:(0,se.jsx)(za.P9,{action:"INFUSION_MND",showIcon:!1}),severityTiers:{1:oe.bI.MINOR,2:oe.bI.MEDIUM,3:oe.bI.MAJOR}}))}}]),e}(e(90137).J),es=[p,ne,Ba,re,ue,ge,fe,Te,Ce,ve,Ne,He,xe,i.e,De,n.e,Pe,We,Ke,$e,as]},70291:function(t){t.exports=function(t,a){for(var e=null==t?0:t.length;e--&&!1!==a(t[e],e,t););return t}},35865:function(t,a,e){var s=e(44370),i=e(99291)(s,!0);t.exports=i},44370:function(t,a,e){var s=e(27473),i=e(3674);t.exports=function(t,a){return t&&s(t,a,i)}},27473:function(t,a,e){var s=e(25063)(!0);t.exports=s},1757:function(t){t.exports=function(t,a,e){for(var s=-1,i=t.length,n=a.length,o={};++s<i;){var r=s<n?a[s]:void 0;e(o,t[s],r)}return o}},54290:function(t,a,e){var s=e(6557);t.exports=function(t){return"function"==typeof t?t:s}},85004:function(t,a,e){var s=e(70291),i=e(35865),n=e(54290),o=e(1469);t.exports=function(t,a){return(o(t)?s:i)(t,n(a))}},7287:function(t,a,e){var s=e(34865),i=e(1757);t.exports=function(t,a){return i(t||[],a||[],s)}}}]);
//# sourceMappingURL=jobs-ast.bba7cc91.js.map