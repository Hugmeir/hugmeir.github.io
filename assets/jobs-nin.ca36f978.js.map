{"version":3,"file":"assets/jobs-nin.ca36f978.js","mappings":"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","sources":["webpack://@xivanalysis/client/./node_modules/@babel/runtime-corejs3/core-js-stable/math/trunc.js","webpack://@xivanalysis/client/./src/parser/core/modules/ActionTimeline/ActionTimeline.tsx","webpack://@xivanalysis/client/./src/parser/core/modules/ActionTimeline/ActionTimeline.module.css?2f05","webpack://@xivanalysis/client/./src/parser/core/modules/Defensives.tsx","webpack://@xivanalysis/client/./src/parser/core/modules/GlobalCooldown.tsx","webpack://@xivanalysis/client/./src/parser/core/modules/Positionals.tsx","webpack://@xivanalysis/client/./src/parser/core/modules/Weaving.tsx","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/ActionTimeline.tsx","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/Combos.ts","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/Defensives.ts","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/Huton.tsx","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/DISPLAY_ORDER.js","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/HutonCastTime.ts","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/Kassatsu.tsx","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/Ninjutsu.tsx","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/Ninki.tsx","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/OGCDDowntime.ts","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/Positionals.ts","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/Raiju.tsx","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/TrickAttackUsage.tsx","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/TrickAttackWindow.tsx","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/Weaving.ts","webpack://@xivanalysis/client/./src/parser/jobs/nin/modules/index.ts","webpack://@xivanalysis/client/./node_modules/core-js-pure/es/math/trunc.js","webpack://@xivanalysis/client/./node_modules/core-js-pure/modules/es.math.trunc.js","webpack://@xivanalysis/client/./node_modules/core-js-pure/stable/math/trunc.js"],"sourcesContent":["module.exports = require(\"core-js-pure/stable/math/trunc\");","import {Trans} from '@lingui/react'\nimport {Action, ActionKey} from 'data/ACTIONS'\nimport {Analyser} from 'parser/core/Analyser'\nimport {dependency} from 'parser/core/Injectable'\nimport CastTime from 'parser/core/modules/CastTime'\nimport {ChargeHistoryEntry, CooldownEndReason, CooldownGroup, CooldownHistoryEntry, Cooldowns, SelectionSpecifier} from 'parser/core/modules/Cooldowns'\nimport {Data} from 'parser/core/modules/Data'\nimport {ActionItem, BaseItem, ContainerRow, SimpleItem, Timeline} from 'parser/core/modules/Timeline'\nimport React, {ReactNode} from 'react'\nimport {Icon} from 'semantic-ui-react'\nimport {ensureArray, isDefined} from 'utilities'\nimport styles from './ActionTimeline.module.css'\n\nconst ANIMATION_LOCK = 100\n\n// We're excluding the Action interface as it's unessecary for this config format, and complicates the discrimination later.\ntype RowSpecifierEntry = Exclude<SelectionSpecifier, Action>\n\n/**\n * One or more actions, action keys, or cooldown group IDs. The special-case\n * value \"GCD\" is available for selection of the GCD cooldown group.\n */\nexport type RowSpecifier = RowSpecifierEntry | RowSpecifierEntry[]\n\n/** Advanced configuration options for a row. */\nexport interface ActionRowConfig {\n\t/** Specifier(s) for items that should be displayed in this row. */\n\tcontent: RowSpecifier\n\t/** Label to display for the row. */\n\tlabel?: ReactNode\n\t/** Order of the row within the timeline. */\n\torder?: number\n\t/** For multi-action rows, should we resolve the name of the action late?\n\t*  This allows setting the name of the row to whatever actions was first used\n\t*  of the set of possibilities.\n\t* */\n\tlateResolveLabel?: boolean\n}\n\n/** Configuration for a single row. */\nexport type ActionRow = RowSpecifier | ActionRowConfig\n\n// Internal row config used within the module\ntype InternalRowConfig =\n\t& Omit<ActionRowConfig, 'content'>\n\t& {content: readonly SelectionSpecifier[]}\n\nenum ItemDepth {\n\tCHARGE_GAIN = 0,\n\tACTION = 1,\n}\n\nexport class ActionTimeline extends Analyser {\n\tstatic override handle = 'actionTimeline'\n\tstatic override debug = false\n\n\t/**\n\t * Configuration for the rows generated by this module. Any cooldown groups\n\t * not represented in this configuration will be added to automatically\n\t * generated rows in order of use.\n\t */\n\tstatic rows: ActionRow[] = [\n\t\t{content: 'GCD', order: -97},\n\t]\n\n\t@dependency private castTime!: CastTime\n\t@dependency private cooldowns!: Cooldowns\n\t@dependency private data!: Data\n\t@dependency private timeline!: Timeline\n\n\tprivate resolvedRows: InternalRowConfig[] = []\n\tprivate groupRows = new Map<CooldownGroup, ContainerRow>()\n\n\t/** Retrieve the timeline row representing the specified action. */\n\tgetRow(action: ActionKey | Action) {\n\t\treturn this.addRow({content: [action]})\n\t}\n\n\toverride initialise() {\n\t\t// Add rows for all the configured entries\n\t\tfor (const config of (this.constructor as typeof ActionTimeline).rows) {\n\t\t\tconst resolvedConfig = this.resolveConfig(config)\n\t\t\tthis.resolvedRows.push(resolvedConfig)\n\t\t\tthis.addRow(resolvedConfig)\n\t\t}\n\n\t\tthis.addEventHook('complete', this.onComplete)\n\t}\n\n\tprotected resolveRowLabel(config: InternalRowConfig) {\n\t\tfor (const maybeAction of config.content) {\n\t\t\tlet fullAction = undefined\n\t\t\tif (typeof maybeAction === 'object') {\n\t\t\t\tfullAction = maybeAction\n\t\t\t} else if (typeof maybeAction === 'number') {\n\t\t\t\tfullAction = this.data.getAction(maybeAction)\n\t\t\t} else if (typeof maybeAction === 'string') {\n\t\t\t\tfullAction = this.data.actions[maybeAction as ActionKey]\n\t\t\t}\n\t\t\tif (fullAction === undefined || fullAction === null) { continue }\n\n\t\t\tconst uses = this.cooldowns.cooldownHistory(fullAction.id) ?? []\n\t\t\tif (uses.length === 0) { continue }\n\n\t\t\treturn uses[0].action.name\n\t\t}\n\t}\n\tprivate onComplete() {\n\t\t// Track the groups with configured rows so backfill doesn't duplicate\n\t\tconst populatedGroups = new Set<number>()\n\n\t\t// Add rows for all the configured entries\n\t\tfor (const config of this.resolvedRows) {\n\t\t\tconst row = this.addRow(config)\n\t\t\tif (config.lateResolveLabel) {\n\t\t\t\t// Resolve the label for multi-action rows late, by finding which one\n\t\t\t\t// of the actions was first used\n\t\t\t\trow.label = this.resolveRowLabel(config) ?? row.label\n\t\t\t}\n\t\t\tthis.populateRow(row, config)\n\t\t\tconfig.content.forEach(specifier =>\n\t\t\t\tthis.cooldowns.groups(specifier).forEach(group => populatedGroups.add(group))\n\t\t\t)\n\t\t}\n\n\t\t// Figure out what groups have not been explicitly configured and build rows for them\n\t\tthis.cooldowns.allGroups()\n\t\t\t.filter(group => !populatedGroups.has(group))\n\t\t\t.forEach(group => {\n\t\t\t\tconst config = {content: [group]}\n\t\t\t\tconst row = this.addRow(config)\n\t\t\t\tthis.populateRow(row, config)\n\t\t\t})\n\t}\n\n\tprivate resolveConfig(config: ActionRow): InternalRowConfig {\n\t\t// Standardise the simple config into the main config shape\n\t\tlet finalConfig = config\n\t\tif (typeof finalConfig !== 'object' || Array.isArray(finalConfig)) {\n\t\t\tfinalConfig = {content: finalConfig}\n\t\t}\n\t\treturn {\n\t\t\t...finalConfig,\n\t\t\tcontent: ensureArray(finalConfig.content),\n\t\t}\n\t}\n\n\tprivate addRow(config: InternalRowConfig) {\n\t\t// If there's already a row for one of the specifiers, use it\n\t\tconst groups = config.content.flatMap(specifier => this.cooldowns.groups(specifier))\n\t\tconst existingRow = groups\n\t\t\t.map(group => this.groupRows.get(group))\n\t\t\t.find(isDefined)\n\t\tif (existingRow != null) {\n\t\t\treturn existingRow\n\t\t}\n\n\t\t// Using an IIFE because pattern matching isn't in the spec yet\n\t\tconst firstContent = config.content[0]\n\t\tconst label = (() => {\n\t\t\tif (config.label != null) { return config.label }\n\t\t\tif (firstContent === 'GCD')  { return <Trans id=\"core.action-timeline.label.gcd\">GCD</Trans> }\n\t\t\tif (typeof firstContent === 'string') { return this.data.actions[firstContent].name }\n\t\t\tif (typeof firstContent === 'number') { return this.cooldowns.cooldownHistory(firstContent)[0]?.action.name }\n\t\t\treturn firstContent.name\n\t\t})()\n\n\t\t// Build the row and save it to the groups for this config\n\t\t// TODO: collision handling?\n\t\tconst row = this.timeline.addRow(new ContainerRow({\n\t\t\tlabel,\n\t\t\torder: config.order,\n\t\t\tcollapse: true,\n\t\t}))\n\t\tgroups.forEach(group => this.groupRows.set(group, row))\n\n\t\treturn row\n\t}\n\n\tprivate populateRow(row: ContainerRow, {content}: InternalRowConfig) {\n\t\t// Add all the items\n\t\tthis.addCooldownItems(row, content.flatMap(specifier => this.cooldowns.cooldownHistory(specifier)))\n\t\tthis.addChargeItems(row, content.flatMap(specifier => this.cooldowns.chargeHistory(specifier)))\n\t}\n\n\tprivate addCooldownItems(row: ContainerRow, history: CooldownHistoryEntry[]) {\n\t\tfor (const entry of history) {\n\t\t\tconst duration = this.getCooldownDuration(entry)\n\n\t\t\t// TODO: with the adjusted cast time we might get some overlaps, should we try to avoid that?]\n\t\t\t// TODO: Add interrupt visuals. CD2 only records interrupts within the bounds of a cooldown, so we'll need to track it in some manner for long-cast actions.\n\t\t\tconst start = entry.start - this.parser.pull.timestamp\n\t\t\tconst end = start + duration\n\t\t\trow.addItem(new SimpleItem({\n\t\t\t\tstart,\n\t\t\t\tend,\n\t\t\t\tcontent: <div className={styles.cooldown}/>,\n\t\t\t}))\n\t\t}\n\t}\n\n\tprivate addChargeItems(row: ContainerRow, history: ChargeHistoryEntry[]) {\n\t\tfor (const entry of history) {\n\t\t\tconst item = entry.delta < 0\n\t\t\t\t? new ActionItem({\n\t\t\t\t\tdepth: ItemDepth.ACTION,\n\t\t\t\t\tstart: entry.timestamp - this.parser.pull.timestamp,\n\t\t\t\t\taction: entry.action,\n\t\t\t\t})\n\t\t\t\t: new ChargeGainItem({\n\t\t\t\t\tdepth: ItemDepth.CHARGE_GAIN,\n\t\t\t\t\tstart: entry.timestamp - this.parser.pull.timestamp,\n\t\t\t\t})\n\t\t\trow.addItem(item)\n\t\t}\n\t}\n\n\tprivate getCooldownDuration(entry: CooldownHistoryEntry) {\n\t\tlet duration = entry.end - entry.start\n\n\t\t// If the cooldown expired naturally, it _may_ have a cast time greater than its cooldown.\n\t\tif (entry.endReason === CooldownEndReason.EXPIRED) {\n\t\t\tconst castTime = this.castTime.forAction(entry.action.id, entry.start) ?? 0\n\n\t\t\t// We add the animation lock constant to the cast time to mimic the game's\n\t\t\t// behaviour - also sometimes known as \"caster tax\".\n\t\t\tduration = Math.max(duration, castTime + ANIMATION_LOCK)\n\t\t}\n\n\t\treturn duration\n\t}\n}\n\nclass ChargeGainItem extends BaseItem {\n\tContent = () => (\n\t\t<div className={styles.chargeGain}>\n\t\t\t<Icon name=\"angle double up\" className={styles.icon}/>\n\t\t</div>\n\t)\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"backgroundColour\":\"rgba(213, 221, 246, .4)\",\"chargeColor\":\"color(rgba(213, 221, 246, .4) a(100%) l(-20%))\",\"cooldown\":\"ActionTimeline-module_cooldown__3u1x3\",\"chargeGain\":\"ActionTimeline-module_chargeGain__3-Of9\",\"icon\":\"ActionTimeline-module_icon__8OvsF\"};","import {t} from '@lingui/macro'\nimport {Plural, Trans} from '@lingui/react'\nimport {ActionLink} from 'components/ui/DbLink'\nimport {Action, ActionKey} from 'data/ACTIONS'\nimport {JOBS, RoleKey} from 'data/JOBS'\nimport {Analyser} from 'parser/core/Analyser'\nimport {dependency} from 'parser/core/Injectable'\nimport {CooldownDowntime} from 'parser/core/modules/CooldownDowntime'\nimport {Data} from 'parser/core/modules/Data'\nimport React, {Fragment, ReactNode} from 'react'\nimport {Accordion, Button, Icon, Message, Table} from 'semantic-ui-react'\nimport {CooldownEndReason, CooldownHistoryEntry, Cooldowns} from './Cooldowns'\nimport DISPLAY_ORDER from './DISPLAY_ORDER'\nimport {Timeline} from './Timeline'\n\nconst DEFENSIVE_ROLE_ACTIONS: Map<RoleKey, ActionKey[]> = new Map<RoleKey, ActionKey[]>([\n\t['TANK', ['RAMPART', 'REPRISAL']],\n\t['MELEE', ['FEINT', 'BLOODBATH', 'SECOND_WIND']],\n\t['PHYSICAL_RANGED', ['SECOND_WIND']],\n\t['MAGICAL_RANGED', ['ADDLE']],\n\t['HEALER', []],\n])\n\nexport class Defensives extends Analyser {\n\tstatic override handle = 'defensives'\n\tstatic override title = t('core.defensives.title')`Defensives`\n\tstatic override displayOrder = DISPLAY_ORDER.DEFENSIVES\n\n\t@dependency protected cooldowns!:Cooldowns\n\t@dependency protected cooldownDowntime!: CooldownDowntime\n\t@dependency protected data!: Data\n\t@dependency private timeline!: Timeline\n\n\t/**\n\t * Implementing modules should provide a list of job-specific defensive actions to track\n\t */\n\tprotected trackedDefensives: Action[] = []\n\t/**\n\t * Implementing modules may override the main header message text\n\t */\n\tprotected headerContent: ReactNode = <Trans id=\"core.defensives.header.content\">\n\t\tUsing your mitigation and healing cooldowns can help you survive mistakes, or relieve some stress on the healers and let them deal more damage.<br/>\n\t\tWhile you shouldn't use them at the expense of your rotation or buff alignment, you should try to find helpful times to use them.\n\t</Trans>\n\n\toverride initialise() {\n\t\tconst roleDefensives = DEFENSIVE_ROLE_ACTIONS.get(JOBS[this.parser.actor.job].role)?.map(key => this.data.actions[key]) ?? []\n\t\troleDefensives.forEach(roleAction => {\n\t\t\tif (!this.trackedDefensives.find(action => roleAction.id === action.id)) {\n\t\t\t\tthis.trackedDefensives.push(roleAction)\n\t\t\t}\n\t\t})\n\t}\n\n\tprivate getUsageCount(defensive: Action): number {\n\t\treturn this.getUses(defensive).length\n\t}\n\n\tprivate getUses(defensive: Action): CooldownHistoryEntry[] {\n\t\treturn this.cooldowns.cooldownHistory(defensive).filter((entry) => entry.endReason !== CooldownEndReason.INTERRUPTED)\n\t}\n\n\tprivate getMaxUses(defensive: Action): number {\n\t\tconst totalAdditionalUses = this.getUses(defensive).reduce((acc, usage) => acc + this.getAdditionalUsageData(defensive, usage.start).chargesBeforeNextUse, this.getAdditionalUsageData(defensive).chargesBeforeNextUse)\n\t\treturn this.getUsageCount(defensive) + totalAdditionalUses\n\t}\n\n\toverride output() {\n\t\tif (this.trackedDefensives.length === 0) {\n\t\t\treturn\n\t\t}\n\n\t\treturn <Fragment>\n\t\t\t<Message icon>\n\t\t\t\t<Icon name=\"info\" />\n\t\t\t\t<Message.Content>\n\t\t\t\t\t{this.headerContent}\n\t\t\t\t\t<br/><br/>\n\t\t\t\t\t<Trans id=\"core.defensives.header.sub-content\">\n\t\t\t\t\t\tThe below tables will show you where you can gain additional uses of these cooldowns, without interfering with your existing ones.\n\t\t\t\t\t</Trans>\n\t\t\t\t</Message.Content>\n\t\t\t</Message>\n\t\t\t<Accordion\n\t\t\t\texclusive={false}\n\t\t\t\tstyled\n\t\t\t\tfluid\n\t\t\t\tpanels={\n\t\t\t\t\tthis.trackedDefensives.map((defensive, index) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tkey: defensive.id,\n\t\t\t\t\t\t\ttitle: {\n\t\t\t\t\t\t\t\tcontent: <><ActionLink key={index} {...defensive} /> - {this.getUsageCount(defensive)} / {this.getMaxUses(defensive)}</>,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\tcontent: <Table compact unstackable celled>\n\t\t\t\t\t\t\t\t\t<Table.Body>\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tthis.tryGetAdditionalUseRow(defensive)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tthis.getUses(defensive).map((entry) => {\n\t\t\t\t\t\t\t\t\t\t\t\treturn this.getUsageRow(entry, defensive)\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t</Table.Body>\n\t\t\t\t\t\t\t\t</Table>,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t/>\n\t\t</Fragment>\n\t}\n\n\tprivate getUsageRow(entry: CooldownHistoryEntry, defensive: Action): ReactNode {\n\t\treturn <>\n\t\t\t<Table.Row key={entry.start}>\n\t\t\t\t<Table.Cell>\n\t\t\t\t\t<Trans id=\"core.defensives.table.usage-row.text\">Used at <Button\n\t\t\t\t\t\tcircular\n\t\t\t\t\t\tcompact\n\t\t\t\t\t\tsize=\"mini\"\n\t\t\t\t\t\ticon=\"time\"onClick={() => this.timeline.show(entry.start - this.parser.pull.timestamp, entry.end - this.parser.pull.timestamp)}>\n\t\t\t\t\t</Button> {this.parser.formatEpochTimestamp(entry.start)}\n\t\t\t\t\t</Trans>\n\t\t\t\t</Table.Cell>\n\t\t\t</Table.Row>\n\t\t\t{\n\t\t\t\tthis.tryGetAdditionalUseRow(defensive, entry.start)\n\t\t\t}\n\t\t</>\n\t}\n\n\tprivate getAdditionalUsageData(defensive: Action, timestamp: number = this.parser.pull.timestamp): {chargesBeforeNextUse: number, availableTimestamp: number, useByTimestamp: number} {\n\t\tlet availableTimestamp: number, currentCharges\n\n\t\tif (timestamp === this.parser.pull.timestamp) {\n\t\t\tavailableTimestamp = this.parser.pull.timestamp\n\t\t\tcurrentCharges = defensive.charges || 1\n\t\t} else {\n\t\t\tconst chargesAvailableEvent = this.cooldowns.chargeHistory(defensive).find(charges => charges.timestamp >= timestamp && charges.current > 0)\n\t\t\tavailableTimestamp = chargesAvailableEvent?.timestamp || (this.parser.pull.duration + this.parser.pull.timestamp)\n\t\t\tcurrentCharges = chargesAvailableEvent?.current || 0\n\t\t}\n\n\t\tconst cooldown = defensive.cooldown || this.parser.pull.duration\n\t\tconst nextEntry = this.getUses(defensive).find(historyEntry => historyEntry.start > timestamp)\n\t\tconst useByTimestamp = nextEntry != null ? (nextEntry.start - cooldown) : (this.parser.pull.timestamp + this.parser.pull.duration)\n\n\t\tif (useByTimestamp <= availableTimestamp) {\n\t\t\treturn {chargesBeforeNextUse: 0, availableTimestamp, useByTimestamp}\n\t\t}\n\n\t\treturn {chargesBeforeNextUse: currentCharges + Math.floor((useByTimestamp - availableTimestamp) / cooldown), availableTimestamp, useByTimestamp}\n\t}\n\n\tprivate tryGetAdditionalUseRow(defensive: Action, timestamp: number = this.parser.pull.timestamp): ReactNode {\n\t\tconst {chargesBeforeNextUse, availableTimestamp, useByTimestamp} = this.getAdditionalUsageData(defensive, timestamp)\n\n\t\tif (chargesBeforeNextUse === 0) {\n\t\t\treturn <></>\n\t\t}\n\n\t\treturn <Table.Row>\n\t\t\t<Table.Cell>\n\t\t\t\t<Trans id=\"core.defensives.table.extra-usage-row.text\"><Plural value={chargesBeforeNextUse} one=\"1 extra use\" other=\"# extra uses\"/> available between <Button\n\t\t\t\t\tcircular\n\t\t\t\t\tcompact\n\t\t\t\t\tsize=\"mini\"\n\t\t\t\t\ticon=\"time\"onClick={() => this.timeline.show(availableTimestamp - this.parser.pull.timestamp, useByTimestamp - this.parser.pull.timestamp)}>\n\t\t\t\t</Button> {this.parser.formatEpochTimestamp(availableTimestamp)} and {this.parser.formatEpochTimestamp(useByTimestamp)}\n\t\t\t\t</Trans>\n\t\t\t</Table.Cell>\n\t\t</Table.Row>\n\t}\n}\n","import {MessageDescriptor} from '@lingui/core'\nimport {t} from '@lingui/macro'\nimport {Trans} from '@lingui/react'\nimport TransMarkdown from 'components/ui/TransMarkdown'\nimport {BASE_GCD} from 'data/CONSTANTS'\nimport React from 'react'\nimport {Report} from 'report'\nimport {Analyser} from '../Analyser'\nimport {dependency} from '../Injectable'\nimport {Data} from './Data'\nimport {SpeedAdjustments} from './SpeedAdjustments'\nimport {SimpleStatistic, Statistics} from './Statistics'\n\nconst estimateHelp: Record<Report['meta']['source'] | '__all', MessageDescriptor> = {\n\t__all: t('core.gcd.no-statistics.v2')`This GCD recast is an *estimate*, and may be incorrect. If it is reporting a GCD recast *longer* than reality, you likely need to focus on keeping your GCD rolling.`,\n\tlegacyFflogs: t('core.gcd.estimate-help.fflogs')`Precise attribute values are only available from FF Logs for the player who logged the report in ACT.`,\n}\n\nexport class GlobalCooldown extends Analyser {\n\tstatic override handle = 'gcd'\n\n\t@dependency private data!: Data\n\t@dependency private statistics!: Statistics\n\t@dependency private speedAdjustments!: SpeedAdjustments\n\n\toverride initialise() {\n\t\tthis.addEventHook('complete', this.onComplete)\n\t}\n\n\t/**\n\t * Get the base recast time of the parsed actor's GCD cooldown group, in milliseconds.\n\t * The value returned from this function _may_ be an estimate - check {@link GlobalCooldown.isEstimated}\n\t * to see if it is.\n\t */\n\tpublic getDuration() {\n\t\treturn this.speedAdjustments.getAdjustedDuration({duration: BASE_GCD})\n\t}\n\n\t/** Returns whether the GCD duration calculated by this module is an estimate. */\n\tpublic isEstimated() {\n\t\treturn this.speedAdjustments.isAdjustmentEstimated()\n\t}\n\n\tprivate onComplete() {\n\t\tconst estimated = this.isEstimated()\n\n\t\tthis.statistics.add(new SimpleStatistic({\n\t\t\ttitle: estimated\n\t\t\t\t? <Trans id=\"core.gcd.estimated-gcd\">Estimated GCD</Trans>\n\t\t\t\t: <Trans id=\"core.gcd.gcd\">GCD Recast</Trans>,\n\t\t\ticon: this.data.actions.ATTACK.icon,\n\t\t\tvalue: this.parser.formatDuration(this.getDuration()),\n\t\t\tinfo: estimated ? <>\n\t\t\t\t<TransMarkdown source={estimateHelp.__all}/>\n\t\t\t\t<TransMarkdown source={estimateHelp[this.parser.report.meta.source]}/>\n\t\t\t</> : undefined,\n\t\t}))\n\t}\n}\n","import {t} from '@lingui/macro'\nimport {Trans} from '@lingui/react'\nimport {ActionLink, DataLink} from 'components/ui/DbLink'\nimport {Action, getPotencyWithMods, getBasePotency} from 'data/ACTIONS'\nimport {BonusModifier} from 'data/ACTIONS/type'\nimport {Event, Events} from 'event'\nimport {filter} from 'parser/core/filter'\nimport {dependency} from 'parser/core/Injectable'\nimport Checklist, {Requirement, Rule} from 'parser/core/modules/Checklist'\nimport DISPLAY_ORDER from 'parser/core/modules/DISPLAY_ORDER'\nimport {Timeline} from 'parser/core/modules/Timeline'\nimport React from 'react'\nimport {Button, Table} from 'semantic-ui-react'\nimport {Analyser} from '../Analyser'\nimport {Data} from './Data'\n\nexport interface PositionalResult {\n\tpositional: Action,\n\thits: Array<Events['damage']>,\n\tmisses: Array<Events['damage']>\n}\n\nconst NO_BONUS_PERCENT = 0\n\nexport abstract class Positionals extends Analyser {\n\t@dependency protected data!: Data\n\t@dependency private checklist!: Checklist\n\t@dependency private timeline!: Timeline\n\n\tstatic override handle = 'positionals'\n\tstatic override title = t('core.positionals.title')`Positionals`\n\tstatic override displayOrder = DISPLAY_ORDER.POSITIONALS\n\n\tprivate positionalResults: PositionalResult[] = []\n\n\t/**\n\t * Jobs MUST provide a list of their positional actions\n\t *\n\t * TODO: This should just be a filter on all actions for the job for\n\t * any actions they have with positional potencies.\n\t */\n\tprotected abstract positionals: Action[]\n\n\toverride initialise() {\n\t\tthis.addEventHook(\n\t\t\tfilter<Event>().source(this.parser.actor.id).type('damage')\n\t\t\t\t.cause(this.data.matchCauseActionId(this.positionals.map(positional => positional.id))), this.onCast)\n\t\tthis.addEventHook('complete', this.onComplete)\n\t}\n\n\tprivate onCast(event: Events['damage']) {\n\t\tif (event.cause.type !== 'action') {\n\t\t\treturn\n\t\t}\n\t\tconst action = this.data.getAction(event.cause.action)\n\t\tif (action == null) {\n\t\t\treturn\n\t\t}\n\t\tconst positional = this.positionals.find(positional => positional === action)\n\t\tif (positional == null) {\n\t\t\treturn\n\t\t}\n\n\t\tconst positionalResult = this.getOrCreatePositionalResult(positional)\n\n\t\t// All positionals are single target skills, so getting the 0 index\n\t\t// should be all we need to do here.\n\t\tif (this.positionalHit(positional, event.targets[0].bonusPercent)) {\n\t\t\tpositionalResult.hits.push(event)\n\t\t} else {\n\t\t\tpositionalResult.misses.push(event)\n\t\t}\n\t}\n\n\tprivate getOrCreatePositionalResult(positional: Action) {\n\t\tlet positionalResult = this.positionalResults.find(result => result.positional === positional)\n\t\tif (positionalResult == null) {\n\t\t\tpositionalResult = {\n\t\t\t\tpositional,\n\t\t\t\thits: [],\n\t\t\t\tmisses: [],\n\t\t\t}\n\t\t\tthis.positionalResults.push(positionalResult)\n\t\t}\n\t\treturn positionalResult\n\t}\n\n\t// The \"hit\" version of this function needs to check for more\n\t// things such as DRG's 5th hit combo buff and RPR's reaver buff.\n\t// Luckily, assessing misses is easy and sufficient for the purposes\n\t// of detecting positional hits.\n\tprivate missedPositionalBonusPercents(action: Action) {\n\t\tconst missed_positional_combo_bonus_percent = this.calculateBonusPercent(\n\t\t\tgetBasePotency(action),\n\t\t\tgetPotencyWithMods(action, [BonusModifier.COMBO], []))\n\t\treturn [...new Set([NO_BONUS_PERCENT, missed_positional_combo_bonus_percent])]\n\t}\n\n\t// Currently just checks that you didn't miss. Checking for hits would\n\t// otherwise be more complex.\n\tprivate positionalHit(action: Action, bonusPercent: number) {\n\t\treturn !this.missedPositionalBonusPercents(action).includes(bonusPercent)\n\t}\n\n\t// The bonusPercent is based on the final potency number.\n\tprivate calculateBonusPercent(base: number, bonus: number) {\n\t\treturn Math.trunc(100 * (1 - base / bonus))\n\t}\n\n\tprivate relativeTimestamp(timestamp: number) {\n\t\treturn timestamp - this.parser.pull.timestamp\n\t}\n\n\tprivate createTimelineButton(timestamp: number) {\n\t\tconst relative_timestamp = this.relativeTimestamp(timestamp)\n\t\treturn <Button\n\t\t\tcircular\n\t\t\tcompact\n\t\t\ticon=\"time\"\n\t\t\tsize=\"small\"\n\t\t\tonClick={() => this.timeline.show(relative_timestamp, relative_timestamp)}\n\t\t\tcontent={this.parser.formatEpochTimestamp(timestamp)}\n\t\t/>\n\t}\n\n\tprivate onComplete() {\n\t\tif (this.positionalResults.length === 0) {\n\t\t\treturn\n\t\t}\n\t\tthis.checklist.add(new Rule({\n\t\t\tname: <Trans id=\"core.positionals.checklist.title\">Hit your positionals</Trans>,\n\t\t\tdisplayOrder: DISPLAY_ORDER.POSITIONALS,\n\t\t\tdescription: <Trans id=\"core.positionals.checklist.description\">\n\t\t\t\tMelee DPS jobs have some skills that will do more damage when used from the rear or flank.\n\t\t\t\tMake sure you use those skills in the right position to do the most damage, or\n\t\t\t\tuse <DataLink action=\"TRUE_NORTH\"/> when you are out of position.\n\t\t\t</Trans>,\n\t\t\trequirements: this.positionalResults.map(this.positionalRequirement),\n\t\t}))\n\t}\n\tprivate positionalRequirement(result: PositionalResult) {\n\t\tconst actual = result.hits.length\n\t\tconst numMisses = result.misses.length\n\t\tconst expected = actual + numMisses\n\t\tlet percent = actual / expected * 100\n\t\tif (process.env.NODE_ENV === 'production') {\n\t\t\tpercent = Math.min(percent, 100)\n\t\t}\n\t\treturn new Requirement({\n\t\t\tname: <ActionLink {...result.positional}/>,\n\t\t\tpercent: percent,\n\t\t\tweight: expected,\n\t\t\toverrideDisplay: `${actual} / ${expected} (${percent.toFixed(2)}%)`,\n\t\t})\n\t}\n\n\toverride output(): React.ReactNode {\n\t\tconst totalMisses = this.positionalResults.reduce((total, current) => total + current.misses.length, 0)\n\n\t\tif (totalMisses === 0) { return }\n\n\t\treturn <Table compact unstackable celled textAlign=\"center\">\n\t\t\t<Table.Header>\n\t\t\t\t<Table.Row>\n\t\t\t\t\t<Table.HeaderCell>\n\t\t\t\t\t\t<strong><Trans id=\"core.ui.positionals-table.header.action\">Action</Trans></strong>\n\t\t\t\t\t</Table.HeaderCell>\n\t\t\t\t\t<Table.HeaderCell>\n\t\t\t\t\t\t<strong><Trans id=\"core.ui.positionals-table.header.hits\">Hits</Trans></strong>\n\t\t\t\t\t</Table.HeaderCell>\n\t\t\t\t\t<Table.HeaderCell>\n\t\t\t\t\t\t<strong><Trans id=\"core.ui.positionals-table.header.misses\">Misses</Trans></strong>\n\t\t\t\t\t</Table.HeaderCell>\n\t\t\t\t</Table.Row>\n\t\t\t</Table.Header>\n\t\t\t<Table.Body>\n\t\t\t\t{\n\t\t\t\t\tthis.positionalResults.map(result => {\n\t\t\t\t\t\tconst numHits = result.hits.length\n\t\t\t\t\t\tconst numMisses = result.misses.length\n\t\t\t\t\t\tconst success = numMisses === 0\n\t\t\t\t\t\treturn <Table.Row key={result.positional.id}>\n\t\t\t\t\t\t\t<Table.Cell style={{whiteSpace: 'nowrap'}}>\n\t\t\t\t\t\t\t\t<ActionLink {...result.positional} showName={false} />\n\t\t\t\t\t\t\t</Table.Cell>\n\t\t\t\t\t\t\t<Table.Cell\n\t\t\t\t\t\t\t\ttextAlign=\"center\"\n\t\t\t\t\t\t\t\tpositive={success}\n\t\t\t\t\t\t\t\tnegative={!success}\n\t\t\t\t\t\t\t>{numHits}/{numMisses + numHits}\n\t\t\t\t\t\t\t</Table.Cell>\n\t\t\t\t\t\t\t<Table.Cell textAlign=\"left\">\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tresult.misses.map(miss => {\n\t\t\t\t\t\t\t\t\t\treturn this.createTimelineButton(miss.timestamp)\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</Table.Cell>\n\t\t\t\t\t\t</Table.Row>\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t</Table.Body>\n\t\t</Table>\n\t}\n}\n","import {t} from '@lingui/macro'\nimport {Trans, Plural} from '@lingui/react'\nimport NormalisedMessage from 'components/ui/NormalisedMessage'\nimport Rotation from 'components/ui/Rotation'\nimport {Action} from 'data/ACTIONS'\nimport {BASE_GCD} from 'data/CONSTANTS'\nimport {Event, Events} from 'event'\nimport {Analyser} from 'parser/core/Analyser'\nimport {filter} from 'parser/core/filter'\nimport {dependency} from 'parser/core/Injectable'\nimport CastTime from 'parser/core/modules/CastTime'\nimport {Data} from 'parser/core/modules/Data'\nimport {Invulnerability} from 'parser/core/modules/Invulnerability'\nimport Suggestions, {TieredSuggestion, SEVERITY} from 'parser/core/modules/Suggestions'\nimport React, {ReactNode} from 'react'\nimport {Accordion} from 'semantic-ui-react'\nimport {matchClosestLower} from 'utilities'\n\nconst CAST_TIME_MAX_WEAVES = {\n\t0: 2,\n\t1000: 1,\n\t2500: 0,\n}\nconst REDUCE_MAX_WEAVES_RECAST_BELOW = 1800\nconst DEFAULT_MAX_WEAVES = 2\n\nconst WEAVING_SEVERITY = {\n\t1: SEVERITY.MEDIUM,\n\t5: SEVERITY.MAJOR,\n}\n\nexport interface Weave {\n\tleadingGcdEvent?: Events['action'],\n\ttrailingGcdEvent: Events['action'],\n\tgcdTimeDiff: number,\n\tweaves: Array<Events['action']>,\n}\n\nexport class Weaving extends Analyser {\n\tstatic override handle = 'weaving'\n\n\t@dependency protected castTime!: CastTime\n\t@dependency protected data!: Data\n\t@dependency private invulnerability!: Invulnerability\n\t@dependency protected suggestions!: Suggestions\n\n\tstatic override title = t('core.weaving.title')`Weaving Issues`\n\n\tprotected suggestionIcon: string = 'https://xivapi.com/i/001000/001785.png' // WVR Focused Synth\n\n\tprotected moduleLink = (\n\t\t<a style={{cursor: 'pointer'}} onClick={() => this.parser.scrollTo(Weaving.handle)}>\n\t\t\t<NormalisedMessage message={Weaving.title}/>\n\t\t</a>\n\t)\n\tprotected suggestionContent: ReactNode = <Trans id=\"core.weaving.content\">\n\t\tAvoid weaving more actions than you have time for in a single GCD window. Doing so will delay your next GCD, reducing possible uptime. Check the {this.moduleLink} module below for more detailed analysis.\n\t</Trans>\n\n\tprotected severity = WEAVING_SEVERITY\n\n\tprivate weaves: Array<Events['action']> = []\n\tprivate ongoingCastEvent?: Events['prepare']\n\tprivate leadingGcdEvent?: Events['action']\n\tprivate trailingGcdEvent?: Events['action']\n\tprivate badWeaves: Weave[] = []\n\n\toverride initialise() {\n\t\tconst playerFilter = filter<Event>().source(this.parser.actor.id)\n\n\t\tthis.addEventHook(playerFilter.type('prepare'), this.onBeginCast)\n\t\tthis.addEventHook(playerFilter.type('action'), this.onCast)\n\t\tthis.addEventHook(filter<Event>().type('complete'), this.onComplete)\n\t\tthis.addEventHook(filter<Event>().type('death'), this.clearWeave)\n\t}\n\n\tprivate onBeginCast(event: Events['prepare']) {\n\t\tthis.ongoingCastEvent = event\n\t}\n\n\tprivate onCast(event: Events['action']) {\n\t\tconst action = this.data.getAction(event.action)\n\n\t\t// If the action is an auto, just ignore it\n\t\tif (!action || action.autoAttack) {\n\t\t\treturn\n\t\t}\n\n\t\t// If it's not a GCD, just bump the weave count\n\t\tif (this.isOgcd(action)) {\n\t\t\tthis.weaves.push(event)\n\t\t\treturn\n\t\t}\n\n\t\tif (this.ongoingCastEvent && this.ongoingCastEvent.action === action.id) {\n\t\t\t// This event is the end of a GCD cast\n\t\t\tthis.trailingGcdEvent = {\n\t\t\t\t...event,\n\t\t\t\t// Override the timestamp of the GCD with when its cast began\n\t\t\t\ttimestamp: this.ongoingCastEvent.timestamp,\n\t\t\t}\n\t\t} else {\n\t\t\t// This event was an instant GCD (or log missed the cast starting)\n\t\t\tthis.trailingGcdEvent = event\n\t\t}\n\n\t\t// Always reset the ongoing cast\n\t\tthis.ongoingCastEvent = undefined\n\n\t\t// Throw the current state onto the history\n\t\tthis.saveIfBad()\n\n\t\t// Reset\n\t\tthis.leadingGcdEvent = this.trailingGcdEvent\n\t\tthis.weaves = []\n\t}\n\n\tprivate onComplete() {\n\t\t// If there's been at least one gcd, run a cleanup on any remnant data\n\t\tif (this.leadingGcdEvent) {\n\t\t\tthis.saveIfBad()\n\t\t}\n\n\t\t// Few triples is medium, any more is major\n\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\ticon: this.suggestionIcon,\n\t\t\tcontent: this.suggestionContent,\n\t\t\twhy: <Plural\n\t\t\t\tid=\"core.weaving.why\"\n\t\t\t\tvalue={this.badWeaves.length}\n\t\t\t\t_1=\"# instance of incorrect weaving\"\n\t\t\t\tother=\"# instances of incorrect weaving\"\n\t\t\t/>,\n\t\t\ttiers: this.severity,\n\t\t\tvalue: this.badWeaves.length,\n\t\t}))\n\t}\n\n\tprivate saveIfBad() {\n\t\tif (this.trailingGcdEvent == null) { return }\n\n\t\tconst leadingTimestamp = this.leadingGcdEvent?.timestamp ?? this.parser.pull.timestamp\n\t\tconst gcdTimeDiff = this.trailingGcdEvent.timestamp\n\t\t\t- leadingTimestamp\n\t\t\t- this.invulnerability.getDuration({\n\t\t\t\tstart: leadingTimestamp,\n\t\t\t\tend: this.trailingGcdEvent.timestamp,\n\t\t\t})\n\n\t\tconst weave: Weave = {\n\t\t\tleadingGcdEvent: this.leadingGcdEvent,\n\t\t\ttrailingGcdEvent: this.trailingGcdEvent,\n\t\t\tgcdTimeDiff,\n\t\t\tweaves: this.weaves,\n\t\t}\n\n\t\tif (weave.weaves.length === 0) {\n\t\t\treturn\n\t\t}\n\n\t\tif (this.isBadWeave(weave)) {\n\t\t\tthis.badWeaves.push(weave)\n\t\t}\n\t}\n\n\tprivate isOgcd(action: Action) {\n\t\treturn !action.onGcd && !action.autoAttack\n\t}\n\n\tprivate isBadWeave(weave: Weave) {\n\t\t// Calc. the no. of weaves - we're ignoring any made while the boss is untargetable, and events that happened before the pull\n\t\tconst weaveCount = weave.weaves.filter(\n\t\t\tevent => true\n\t\t\t\t&& !this.invulnerability.isActive({timestamp: event.timestamp, types: ['untargetable']})\n\t\t\t\t&& event.timestamp >= this.parser.pull.timestamp,\n\t\t).length\n\n\t\tconst recast = ((weave.leadingGcdEvent != null) ? this.castTime.recastForEvent(weave.leadingGcdEvent) : undefined) ?? BASE_GCD\n\t\t// Check the downtime-adjusted GCD time difference for this weave - do not treat multiple weaves during downtime as bad weaves\n\t\treturn weave.gcdTimeDiff > recast && weaveCount > this.getMaxWeaves(weave)\n\t}\n\n\tprivate clearWeave() {\n\t\t// prompts saving any existing weaves if they're bad, and reset\n\t\tif (this.weaves.length > 0) {\n\t\t\tthis.saveIfBad()\n\t\t}\n\n\t\t// remove existing weaves and pretend the next leadingGcdEvent is like a fresh start (which I guess it is)\n\t\tthis.weaves = []\n\t\tthis.leadingGcdEvent = undefined\n\t}\n\n\t/**\n\t * Implementing classes MAY override this in order to provide custom logic for determining the number of max weaves, given the leading GCD Event\n\t * @param event The Action Event of the leading GCD.  Will be undefined for the first GCD of the pull - default behavior is to allow 2 weaves in case of missing pre-pull action\n\t * @returns number of allowed weaves after the leading GCD before flagging as bad weaving\n\t */\n\tprotected getMaxWeaves(weave: Weave): number {\n\t\tif (weave.leadingGcdEvent == null) {\n\t\t\treturn DEFAULT_MAX_WEAVES\n\t\t}\n\n\t\tconst castTime = this.castTime.forEvent(weave.leadingGcdEvent)\n\t\tif (castTime == null)  {\n\t\t\treturn DEFAULT_MAX_WEAVES\n\t\t}\n\n\t\tconst maxWeaves = matchClosestLower(CAST_TIME_MAX_WEAVES, castTime) ?? DEFAULT_MAX_WEAVES\n\t\tconst recastTime = this.castTime.recastForEvent(weave.leadingGcdEvent) ?? BASE_GCD\n\n\t\treturn maxWeaves - (recastTime < REDUCE_MAX_WEAVES_RECAST_BELOW ? 1 : 0)\n\t}\n\n\toverride output() {\n\t\tif (this.badWeaves.length === 0) {\n\t\t\treturn false\n\t\t}\n\n\t\tconst panels = this.badWeaves.map(item => ({\n\t\t\tkey: item.leadingGcdEvent?.timestamp ?? this.parser.pull.timestamp,\n\t\t\ttitle: {\n\t\t\t\tcontent: <>\n\t\t\t\t\t<strong>{this.parser.formatEpochTimestamp(item.leadingGcdEvent?.timestamp ?? this.parser.pull.timestamp)}</strong>\n\t\t\t\t\t&nbsp;-&nbsp;\n\t\t\t\t\t<Plural\n\t\t\t\t\t\tid=\"core.weaving.panel-count\"\n\t\t\t\t\t\tvalue={item.weaves.length}\n\t\t\t\t\t\t_1=\"# weave\"\n\t\t\t\t\t\tother=\"# weaves\"\n\t\t\t\t\t/>\n\t\t\t\t\t&nbsp;(\n\t\t\t\t\t{this.parser.formatDuration(item.gcdTimeDiff)}\n\t\t\t\t\t&nbsp;\n\t\t\t\t\t<Trans id=\"core.weaving.between-gcds\">between GCDs</Trans>\n\t\t\t\t\t)\n\t\t\t\t</>,\n\t\t\t},\n\t\t\tcontent: {\n\t\t\t\tcontent: <Rotation events={[\n\t\t\t\t\t...(item.leadingGcdEvent != null ? [item.leadingGcdEvent] : []),\n\t\t\t\t\t...item.weaves,\n\t\t\t\t]}/>,\n\t\t\t},\n\t\t}))\n\n\t\treturn <Accordion\n\t\t\texclusive={false}\n\t\t\tpanels={panels}\n\t\t\tstyled\n\t\t\tfluid\n\t\t/>\n\t}\n}\n","import {Trans} from '@lingui/react'\nimport {ActionRow, ActionTimeline as CoreActionTimeline} from 'parser/core/modules/ActionTimeline'\nimport React from 'react'\n\nexport class ActionTimeline extends CoreActionTimeline {\n\tstatic override rows: ActionRow[] = [\n\t\t...CoreActionTimeline.rows,\n\t\t{\n\t\t\t// This row displays the cooldown group of the non-kassatsu, non-TCJ, mudra cooldown\n\t\t\tcontent: 'TEN',\n\t\t\tlabel: <Trans id=\"nin.action-timeline.mudra\">Mudra</Trans>,\n\t\t},\n\t\t'KASSATSU',\n\t\t'TEN_CHI_JIN',\n\t\t'TRICK_ATTACK',\n\t\t'DREAM_WITHIN_A_DREAM',\n\t\t'BUNSHIN',\n\t\t'BHAVACAKRA',\n\t\t'MUG',\n\t\t'MEISUI',\n\t\t'HELLFROG_MEDIUM',\n\t\t'SHUKUCHI',\n\t\t'SHADE_SHIFT',\n\t]\n}\n","import ACTIONS from 'data/ACTIONS'\nimport {Combos as CoreCombos} from 'parser/core/modules/Combos'\n\nexport class Combos extends CoreCombos {\n\t// Overrides\n\toverride suggestionIcon = ACTIONS.SPINNING_EDGE.icon\n}\n","import {Defensives as CoreDefensives} from 'parser/core/modules/Defensives'\n\nexport class Defensives extends CoreDefensives {\n\tprotected override trackedDefensives = [\n\t\tthis.data.actions.SHADE_SHIFT,\n\t]\n}\n","import {Trans, Plural} from '@lingui/react'\nimport {ActionLink} from 'components/ui/DbLink'\nimport {ActionKey} from 'data/ACTIONS'\nimport {EncounterKey} from 'data/ENCOUNTERS'\nimport {Cause, Event, Events} from 'event'\nimport {Analyser} from 'parser/core/Analyser'\nimport {filter, oneOf} from 'parser/core/filter'\nimport {dependency} from 'parser/core/Injectable'\nimport Checklist, {Rule, Requirement} from 'parser/core/modules/Checklist'\nimport {Data} from 'parser/core/modules/Data'\nimport {Death} from 'parser/core/modules/Death'\nimport Suggestions, {TieredSuggestion, SEVERITY} from 'parser/core/modules/Suggestions'\nimport React, {Fragment} from 'react'\nimport {Icon, Message} from 'semantic-ui-react'\nimport DISPLAY_ORDER from './DISPLAY_ORDER'\n\nconst HUTON_MAX_DURATION_MILLIS = 60000 // Not in STATUSES/NIN.js because lolgauges\n\n// TODO - Revisit how this sim works in the first place because it's fucky\nconst HUTON_START_DURATION_MILLIS_HIGH = 55000\nconst HUTON_START_DURATION_MILLIS_LOW = 49000\n\nconst HUTON_EXTENSION_LONG = 30000\nconst HUTON_EXTENSION_SHORT = 10000\n\nconst HUTON_EXTENSION_MILLIS: Array<[ActionKey, number]> = [\n\t['ARMOR_CRUSH', HUTON_EXTENSION_LONG],\n\t['HAKKE_MUJINSATSU', HUTON_EXTENSION_SHORT],\n]\n\nconst DOWNTIME_DIFFERENCE_TOLERANCE = 10000 // If the downtime estimates are off by more than this, we can probably toss the low estimate\n\n// Some bosses *coughChadarnookcough* require fucky pulls that result in your Huton timer being lower than normal when the fight starts\nconst BOSS_ADJUSTMENTS: Partial<Record<EncounterKey, number>> = {\n\t// DEMON_CHADARNOOK: 15000,\n}\n\ninterface HutonEstimate {\n\tcurrent: number,\n\tclipped: number,\n\tdowntime: number,\n\tbadAcs: number,\n}\n\nexport class Huton extends Analyser {\n\tstatic override handle = 'huton'\n\n\t@dependency private checklist!: Checklist\n\t@dependency private data!: Data\n\t@dependency private death!: Death\n\t@dependency private suggestions!: Suggestions\n\n\tprivate hutonExtensionMillis = new Map(HUTON_EXTENSION_MILLIS.map(\n\t\tpair => [this.data.actions[pair[0]].id, pair[1]]\n\t))\n\n\tprivate highEstimate: HutonEstimate = {\n\t\tcurrent: HUTON_START_DURATION_MILLIS_HIGH - (BOSS_ADJUSTMENTS[this.parser.pull.encounter.key ?? 'TRASH'] || 0),\n\t\tclipped: 0,\n\t\tdowntime: 0,\n\t\tbadAcs: 0,\n\t}\n\tprivate lowEstimate: HutonEstimate = {\n\t\tcurrent: HUTON_START_DURATION_MILLIS_LOW - (BOSS_ADJUSTMENTS[this.parser.pull.encounter.key ?? 'TRASH'] || 0),\n\t\tclipped: 0,\n\t\tdowntime: 0,\n\t\tbadAcs: 0,\n\t}\n\tprivate lastEventTime: number = this.parser.pull.timestamp // This one is shared\n\n\toverride initialise() {\n\t\tconst playerFilter = filter<Event>().source(this.parser.actor.id)\n\t\tconst pets = this.parser.pull.actors.filter(actor => actor.owner === this.parser.actor).map(actor => actor.id)\n\t\tthis.addEventHook(playerFilter.type('action').action(oneOf([this.data.actions.HUTON.id, this.data.actions.HURAIJIN.id])), this.onHutonCast)\n\t\tthis.addEventHook(playerFilter.type('combo').action(oneOf(HUTON_EXTENSION_MILLIS.map(pair => this.data.actions[pair[0]].id))), this.onHutonCombo)\n\t\tthis.addEventHook(filter<Event>()\n\t\t\t.source(oneOf(pets))\n\t\t\t.type('damage')\n\t\t\t.cause(filter<Cause>().action(this.data.actions.PHANTOM_KAMAITACHI_BUNSHIN.id)), this.onKamaitachi)\n\t\tthis.addEventHook({type: 'death', actor: this.parser.actor.id}, this.onDeath)\n\t\tthis.addEventHook({type: 'raise', actor: this.parser.actor.id}, this.onRaise)\n\t\tthis.addEventHook('complete', this.onComplete)\n\t}\n\n\tprivate handleHutonRecast(estimate: HutonEstimate, elapsedTime: number) {\n\t\tif (estimate.current === 0) {\n\t\t\testimate.downtime += elapsedTime\n\t\t}\n\n\t\testimate.current = HUTON_MAX_DURATION_MILLIS\n\t}\n\n\tprivate onHutonCast(event: Events['action']) {\n\t\tconst elapsedTime = (event.timestamp - this.lastEventTime)\n\t\tthis.handleHutonRecast(this.highEstimate, elapsedTime)\n\t\tthis.handleHutonRecast(this.lowEstimate, elapsedTime)\n\t\tthis.lastEventTime = event.timestamp\n\t}\n\n\tprivate handleHutonExtension(estimate: HutonEstimate, actionId: number, amount: number, elapsedTime: number) {\n\t\tlet newDuration = estimate.current - elapsedTime\n\t\tif (newDuration <= 0) {\n\t\t\testimate.current = 0\n\t\t\testimate.downtime -= newDuration // Since it's negative, this is basically addition\n\t\t\tif (actionId === this.data.actions.ARMOR_CRUSH.id) {\n\t\t\t\t// Only flag actual Armor Crushes for the badAcs property\n\t\t\t\testimate.badAcs++\n\t\t\t}\n\t\t} else {\n\t\t\tnewDuration += amount\n\t\t\testimate.clipped += Math.max(newDuration - HUTON_MAX_DURATION_MILLIS, 0)\n\t\t\testimate.current = Math.min(newDuration, HUTON_MAX_DURATION_MILLIS)\n\t\t}\n\t}\n\n\tprivate onHutonCombo(event: Events['combo']) {\n\t\tconst elapsedTime = (event.timestamp - this.lastEventTime)\n\t\tconst action = this.data.getAction(event.action)\n\t\tif (action == null) { return }\n\n\t\t// The .get() should never be undefined but we must appease the ts lint gods\n\t\tconst extension = this.hutonExtensionMillis.get(action.id) ?? 0\n\t\tthis.handleHutonExtension(this.highEstimate, action.id, extension, elapsedTime)\n\t\tthis.handleHutonExtension(this.lowEstimate, action.id, extension, elapsedTime)\n\t\tthis.lastEventTime = event.timestamp\n\t}\n\n\tprivate onKamaitachi(event: Events['damage']) {\n\t\tconst elapsedTime = (event.timestamp - this.lastEventTime)\n\t\tthis.handleHutonExtension(this.highEstimate, this.data.actions.PHANTOM_KAMAITACHI_BUNSHIN.id, HUTON_EXTENSION_SHORT, elapsedTime)\n\t\tthis.handleHutonExtension(this.lowEstimate, this.data.actions.PHANTOM_KAMAITACHI_BUNSHIN.id, HUTON_EXTENSION_SHORT, elapsedTime)\n\t\tthis.lastEventTime = event.timestamp\n\t}\n\n\tprivate onDeath() {\n\t\t// RIP\n\t\tthis.highEstimate.current = 0\n\t\tthis.lowEstimate.current = 0\n\t}\n\n\tprivate onRaise(event: Events['raise']) {\n\t\t// So floor time doesn't count against Huton uptime\n\t\tthis.lastEventTime = event.timestamp\n\t}\n\n\tprivate getHutonAverages() {\n\t\tif (this.lowEstimate.downtime - this.highEstimate.downtime > DOWNTIME_DIFFERENCE_TOLERANCE) {\n\t\t\t// If the estimates are too far apart, the low one was probably bad, so we can just return the high one as-is\n\t\t\treturn {\n\t\t\t\tclipped: this.highEstimate.clipped,\n\t\t\t\tdowntime: this.highEstimate.downtime,\n\t\t\t\tbadAcs: this.highEstimate.badAcs,\n\t\t\t}\n\t\t}\n\n\t\t// Otherwise, average the results\n\t\treturn {\n\t\t\tclipped: Math.round((this.highEstimate.clipped + this.lowEstimate.clipped) / 2),\n\t\t\tdowntime: Math.round((this.highEstimate.downtime + this.lowEstimate.downtime) / 2),\n\t\t\tbadAcs: Math.round((this.highEstimate.badAcs + this.lowEstimate.badAcs) / 2),\n\t\t}\n\t}\n\n\tprivate onComplete() {\n\t\tconst {clipped, downtime, badAcs} = this.getHutonAverages()\n\t\tconst duration = this.parser.currentDuration - this.death.deadTime\n\t\tconst uptime = ((duration - downtime) / duration) * 100\n\t\tthis.checklist.add(new Rule({\n\t\t\tname: <Trans id=\"nin.huton.checklist.name\">Keep Huton up</Trans>,\n\t\t\tdescription: <Fragment>\n\t\t\t\t<Trans id=\"nin.huton.checklist.description\"><ActionLink action=\"HUTON\"/> provides you with a 15% attack speed increase and as such is a <em>huge</em> part of a NIN's personal DPS. Do your best not to let it drop, and recover it as quickly as possible if it does.</Trans>\n\t\t\t\t<Message warning icon>\n\t\t\t\t\t<Icon name=\"warning sign\"/>\n\t\t\t\t\t<Message.Content>\n\t\t\t\t\t\t<Trans id=\"nin.huton.checklist.description.warning\">As Huton is now a gauge instead of a buff, please bear in mind that this is an estimate, not an exact value. This also applies to any Huton-related suggestions below.</Trans>\n\t\t\t\t\t</Message.Content>\n\t\t\t\t</Message>\n\t\t\t</Fragment>,\n\t\t\tdisplayOrder: DISPLAY_ORDER.HUTON,\n\t\t\trequirements: [\n\t\t\t\tnew Requirement({\n\t\t\t\t\tname: <Trans id=\"nin.huton.checklist.requirement.name\"><ActionLink action=\"HUTON\"/> uptime</Trans>,\n\t\t\t\t\tpercent: () => uptime,\n\t\t\t\t}),\n\t\t\t],\n\t\t\ttarget: 99,\n\t\t}))\n\n\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\ticon: this.data.actions.HUTON.icon,\n\t\t\tcontent: <Trans id=\"nin.huton.suggestions.clipping.content\">\n\t\t\t\tAvoid using <ActionLink action=\"ARMOR_CRUSH\"/> when <ActionLink action=\"HUTON\"/> has more than 30 seconds left on its duration. The excess time is wasted, so using <ActionLink action=\"AEOLIAN_EDGE\"/> is typically the better option.\n\t\t\t</Trans>,\n\t\t\ttiers: {\n\t\t\t\t15000: SEVERITY.MINOR,\n\t\t\t\t60000: SEVERITY.MEDIUM,\n\t\t\t},\n\t\t\tvalue: clipped,\n\t\t\twhy: <Trans id=\"nin.huton.suggestions.clipping.why\">\n\t\t\t\tYou clipped {this.parser.formatDuration(clipped)} of Huton with early Armor Crushes.\n\t\t\t</Trans>,\n\t\t}))\n\n\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\ticon: this.data.actions.ARMOR_CRUSH.icon,\n\t\t\tcontent: <Trans id=\"nin.huton.suggestions.futile-ac.content\">\n\t\t\t\tAvoid using <ActionLink action=\"ARMOR_CRUSH\"/> when <ActionLink action=\"HUTON\"/> is down, as it provides no benefit and does less DPS than your other combo finishers.\n\t\t\t</Trans>,\n\t\t\ttiers: {\n\t\t\t\t1: SEVERITY.MINOR,\n\t\t\t\t2: SEVERITY.MEDIUM,\n\t\t\t},\n\t\t\tvalue: badAcs,\n\t\t\twhy: <Trans id=\"nin.huton.suggestions.futile-ac.why\">\n\t\t\t\tYou used Armor Crush <Plural value={badAcs} one=\"# time\" other=\"# times\"/> when Huton was down.\n\t\t\t</Trans>,\n\t\t}))\n\t}\n}\n","export default {\n\tHUTON: 1,\n\tSHADOW_FANG: 2,\n}\n","import CastTime from 'parser/core/modules/CastTime'\n\nconst HUTON_MODIFIER = 0.85\n\n// This is a TEMPORARY workaround to the lack of a status for Huton, only until the Huton module can be ported to Analyser (requires Combos to be ported)\n//   Move this to the Huton module so it synthesizes the CastTime adjustment after it is ported\nexport class HutonCastTime extends CastTime {\n\tprivate pomIndex: number | null = null\n\n\toverride initialise() {\n\t\tsuper.initialise()\n\n\t\tthis.setPercentageAdjustment('all', HUTON_MODIFIER, 'both')\n\t}\n}\n","import {Trans, Plural} from '@lingui/react'\nimport {ActionLink} from 'components/ui/DbLink'\nimport {Event, Events} from 'event'\nimport {Analyser} from 'parser/core/Analyser'\nimport {filter, oneOf} from 'parser/core/filter'\nimport {dependency} from 'parser/core/Injectable'\nimport {Actors} from 'parser/core/modules/Actors'\nimport {Data} from 'parser/core/modules/Data'\nimport Suggestions, {Suggestion, SEVERITY} from 'parser/core/modules/Suggestions'\nimport React from 'react'\n\nexport class Kassatsu extends Analyser {\n\tstatic override handle = 'kassatsu'\n\n\t@dependency private actors!: Actors\n\t@dependency private data!: Data\n\t@dependency private suggestions!: Suggestions\n\n\tprivate kassatsuSpent: boolean = false\n\tprivate kassatsuWastes: number = 0\n\tprivate kassatsuUses: {[key: number]: number} = {\n\t\t[this.data.actions.FUMA_SHURIKEN.id]: 0,\n\t\t[this.data.actions.GOKA_MEKKYAKU.id]: 0,\n\t\t[this.data.actions.RAITON.id]: 0,\n\t\t[this.data.actions.HYOSHO_RANRYU.id]: 0,\n\t\t[this.data.actions.HUTON.id]: 0,\n\t\t[this.data.actions.DOTON.id]: 0,\n\t\t[this.data.actions.SUITON.id]: 0,\n\t\t[this.data.actions.RABBIT_MEDIUM.id]: 0,\n\t}\n\n\toverride initialise() {\n\t\tconst playerFilter = filter<Event>().source(this.parser.actor.id)\n\t\tthis.addEventHook(playerFilter.type('action').action(oneOf(Object.keys(this.kassatsuUses).map(Number))), this.onNinjutsuCast)\n\t\tthis.addEventHook(playerFilter.type('statusRemove').status(this.data.statuses.KASSATSU.id), this.onRemoveKassatsu)\n\t\tthis.addEventHook('complete', this.onComplete)\n\t}\n\n\tprivate onNinjutsuCast(event: Events['action']) {\n\t\tconst abilityId = event.action\n\t\tif (this.actors.current.hasStatus(this.data.statuses.KASSATSU.id)) {\n\t\t\tthis.kassatsuUses[abilityId]++\n\t\t\tthis.kassatsuSpent = true\n\t\t}\n\t}\n\n\tprivate onRemoveKassatsu() {\n\t\tif (!this.kassatsuSpent) {\n\t\t\tthis.kassatsuWastes++\n\t\t}\n\n\t\t// Reset the flag for the next time it's cast\n\t\tthis.kassatsuSpent = false\n\t}\n\n\tprivate onComplete() {\n\t\tif (this.kassatsuWastes > 0) {\n\t\t\tthis.suggestions.add(new Suggestion({\n\t\t\t\ticon: this.data.actions.KASSATSU.icon,\n\t\t\t\tcontent: <Trans id=\"nin.kassatsu.suggestions.waste.content\">\n\t\t\t\t\tBe careful not to let <ActionLink action=\"KASSATSU\"/> fall off, as it wastes a 30% potency buff and means that you're delaying your Ninjutsu casts significantly.\n\t\t\t\t</Trans>,\n\t\t\t\tseverity: SEVERITY.MAJOR,\n\t\t\t\twhy: <Trans id=\"nin.kassatsu.suggestions.waste.why\">\n\t\t\t\t\tYou allowed Kassatsu to fall off <Plural value={this.kassatsuWastes} one=\"# time\" other=\"# times\"/>.\n\t\t\t\t</Trans>,\n\t\t\t}))\n\t\t}\n\n\t\tif (this.kassatsuUses[this.data.actions.HUTON.id] > 0) {\n\t\t\tthis.suggestions.add(new Suggestion({\n\t\t\t\ticon: this.data.actions.HUTON.icon,\n\t\t\t\tcontent: <Trans id=\"nin.kassatsu.suggestions.huton.content\">\n\t\t\t\t\tAvoid using <ActionLink action=\"HUTON\"/> under <ActionLink action=\"KASSATSU\"/>, as it does no damage and completely wastes the 30% potency buff Kassatsu provides.\n\t\t\t\t</Trans>,\n\t\t\t\tseverity: SEVERITY.MAJOR,\n\t\t\t\twhy: <Trans id=\"nin.kassatsu.suggestions.huton.why\">\n\t\t\t\t\tYou cast Huton <Plural value={this.kassatsuUses[this.data.actions.HUTON.id]} one=\"# time\" other=\"# times\"/> under Kassatsu.\n\t\t\t\t</Trans>,\n\t\t\t}))\n\t\t}\n\n\t\tconst generalBads = this.kassatsuUses[this.data.actions.FUMA_SHURIKEN.id] + this.kassatsuUses[this.data.actions.RAITON.id] + this.kassatsuUses[this.data.actions.DOTON.id]\n\t\tif (generalBads > 0) {\n\t\t\tthis.suggestions.add(new Suggestion({\n\t\t\t\ticon: this.data.actions.FUMA_SHURIKEN.icon,\n\t\t\t\tcontent: <Trans id=\"nin.kassatsu.suggestions.generalbads.content\">\n\t\t\t\t\tAvoid using <ActionLink action=\"FUMA_SHURIKEN\"/>, <ActionLink action=\"RAITON\"/>, and <ActionLink action=\"DOTON\"/> under <ActionLink action=\"KASSATSU\"/>. For raw damage, <ActionLink action=\"HYOSHO_RANRYU\"/> and <ActionLink action=\"GOKA_MEKKYAKU\"/> should always be used in single-target and AoE situations respectively.\n\t\t\t\t</Trans>,\n\t\t\t\tseverity: SEVERITY.MAJOR,\n\t\t\t\twhy: <Trans id=\"nin.kassatsu.suggestions.generalbads.why\">\n\t\t\t\t\tYou cast standard damaging Ninjutsu <Plural value={generalBads} one=\"# time\" other=\"# times\"/> under Kassatsu.\n\t\t\t\t</Trans>,\n\t\t\t}))\n\t\t}\n\n\t\tif (this.kassatsuUses[this.data.actions.SUITON.id] > 0) {\n\t\t\tthis.suggestions.add(new Suggestion({\n\t\t\t\ticon: this.data.actions.SUITON.icon,\n\t\t\t\tcontent: <Trans id=\"nin.kassatsu.suggestions.suiton.content\">\n\t\t\t\t\tAvoid using <ActionLink action=\"SUITON\"/> under <ActionLink action=\"KASSATSU\"/> unless using it to set up for a critically important <ActionLink action=\"TRICK_ATTACK\"/>. It's generally best to use it on <ActionLink action=\"HYOSHO_RANRYU\"/> while Trick Attack is up, as its cooldown should align it with every window.\n\t\t\t\t</Trans>,\n\t\t\t\tseverity: SEVERITY.MEDIUM,\n\t\t\t\twhy: <Trans id=\"nin.kassatsu.suggestions.suiton.why\">\n\t\t\t\t\tYou cast Suiton <Plural value={this.kassatsuUses[this.data.actions.SUITON.id]} one=\"# time\" other=\"# times\"/> under Kassatsu.\n\t\t\t\t</Trans>,\n\t\t\t}))\n\t\t}\n\n\t\tif (this.kassatsuUses[this.data.actions.RABBIT_MEDIUM.id] > 0) {\n\t\t\tthis.suggestions.add(new Suggestion({\n\t\t\t\ticon: this.data.actions.RABBIT_MEDIUM.icon,\n\t\t\t\tcontent: <Trans id=\"nin.kassatsu.suggestions.rabbit.content\">\n\t\t\t\t\tBe especially careful not to flub your mudras under <ActionLink action=\"KASSATSU\"/>, as <ActionLink action=\"RABBIT_MEDIUM\"/> does no damage and completely wastes the 30% potency buff Kassatsu provides.\n\t\t\t\t</Trans>,\n\t\t\t\tseverity: SEVERITY.MAJOR,\n\t\t\t\twhy: <Trans id=\"nin.kassatsu.suggestions.rabbit.why\">\n\t\t\t\t\tYou cast Rabbit Medium <Plural value={this.kassatsuUses[this.data.actions.RABBIT_MEDIUM.id]} one=\"# time\" other=\"# times\"/> under Kassatsu.\n\t\t\t\t</Trans>,\n\t\t\t}))\n\t\t}\n\t}\n}\n","import {Trans, Plural} from '@lingui/react'\nimport {ActionLink} from 'components/ui/DbLink'\nimport {Event, Events} from 'event'\nimport {Analyser} from 'parser/core/Analyser'\nimport {filter, oneOf} from 'parser/core/filter'\nimport {dependency} from 'parser/core/Injectable'\nimport {Actors} from 'parser/core/modules/Actors'\nimport {Data} from 'parser/core/modules/Data'\nimport Suggestions, {TieredSuggestion, Suggestion, SEVERITY} from 'parser/core/modules/Suggestions'\nimport React from 'react'\n\nconst DOTON_TICK_TARGET = 6\nconst JUSTIFIABLE_DOTON_TICKS = 10\n\ninterface DotonCast {\n\ttcj: boolean,\n\tticks: number[],\n\tprepull: boolean,\n}\n\nexport class Ninjutsu extends Analyser {\n\tstatic override handle = 'ninjutsu'\n\n\t@dependency private actors!: Actors\n\t@dependency private data!: Data\n\t@dependency private suggestions!: Suggestions\n\n\tprivate hyotonCount: number = 0\n\tprivate rabbitCount: number = 0\n\tprivate current?: DotonCast\n\tprivate history: DotonCast[] = []\n\n\toverride initialise() {\n\t\tconst playerFilter = filter<Event>().source(this.parser.actor.id)\n\t\tthis.addEventHook(playerFilter.type('action').action(oneOf([this.data.actions.HYOTON.id, this.data.actions.HYOTON_TCJ.id])), () => { this.hyotonCount++ })\n\t\tthis.addEventHook(playerFilter.type('action').action(this.data.actions.RABBIT_MEDIUM.id), () => { this.rabbitCount++ })\n\t\tthis.addEventHook(playerFilter.type('action').action(oneOf([this.data.actions.DOTON.id, this.data.actions.DOTON_TCJ.id])), this.onDotonCast)\n\t\tthis.addEventHook(playerFilter.type('damage').cause(this.data.matchCauseStatus(['DOTON'])), event => { this.current?.ticks.push(event.targets.length ?? 0) })\n\t\tthis.addEventHook(playerFilter.type('statusRemove').status(this.data.statuses.DOTON.id), this.finishDotonWindow)\n\t\tthis.addEventHook('complete', this.onComplete)\n\t}\n\n\tprivate onDotonCast(event: Events['action']) {\n\t\tthis.finishDotonWindow()\n\n\t\tthis.current = {\n\t\t\ttcj: this.actors.current.hasStatus(this.data.statuses.TEN_CHI_JIN.id),\n\t\t\tticks: [],\n\t\t\tprepull: event.timestamp < this.parser.pull.timestamp,\n\t\t}\n\t}\n\n\tprivate finishDotonWindow() {\n\t\tif (this.current == null) {\n\t\t\treturn\n\t\t}\n\n\t\tthis.history.push(this.current)\n\t\tthis.current = undefined\n\t}\n\n\tprivate appraiseDotonCasts() {\n\t\tconst result = {\n\t\t\tbadTcjs: 0, // Single-target TCJ Dotons (do not do this)\n\t\t\tbadAoes: 0, // AoE Dotons that fell short of 6 ticks (Katon will be more damage)\n\t\t\tbadStds: 0, // Single-target regular Dotons (also do not do this)\n\t\t}\n\n\t\tthis.history.forEach(cast => {\n\t\t\tif (cast.tcj && cast.ticks.every(tick => tick === 1)) {\n\t\t\t\t// If it's a fully single-target TCJ, flag it\n\t\t\t\tresult.badTcjs++\n\t\t\t} else if (cast.ticks.every(tick => tick > 1)) {\n\t\t\t\t// If it's a fully multi-target Doton that misses at least 2 ticks, flag it\n\t\t\t\tif (cast.ticks.length < DOTON_TICK_TARGET) {\n\t\t\t\t\tresult.badAoes++\n\t\t\t\t}\n\t\t\t} else if (!cast.prepull && cast.ticks.reduce((accum, value) => accum + value, 0) < JUSTIFIABLE_DOTON_TICKS) {\n\t\t\t\t// If it's a partial or entirely single-target and it doesn't reach the hit threshold for a good Doton, flag it\n\t\t\t\t// Note: Fully single-target Dotons will never reach this threshold\n\t\t\t\tresult.badStds++\n\t\t\t}\n\t\t})\n\n\t\treturn result\n\t}\n\n\tprivate onComplete() {\n\t\tthis.finishDotonWindow()\n\n\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\ticon: this.data.actions.HYOTON.icon,\n\t\t\tcontent: <Trans id=\"nin.ninjutsu.suggestions.hyoton.content\">\n\t\t\t\tAvoid using <ActionLink action=\"HYOTON\"/>, as it's the weakest of the mudra combinations and should typically never be used in raid content.\n\t\t\t</Trans>,\n\t\t\ttiers: {\n\t\t\t\t1: SEVERITY.MINOR, // Probably a fat finger\n\t\t\t\t2: SEVERITY.MEDIUM, // Probably deliberate\n\t\t\t},\n\t\t\tvalue: this.hyotonCount,\n\t\t\twhy: <Trans id=\"nin.ninjutsu.suggestions.hyoton.why\">\n\t\t\t\tYou cast Hyoton <Plural value={this.hyotonCount} one=\"# time\" other=\"# times\"/>.\n\t\t\t</Trans>,\n\t\t}))\n\n\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\ticon: this.data.actions.RABBIT_MEDIUM.icon,\n\t\t\tcontent: <Trans id=\"nin.ninjutsu.suggestions.rabbit.content\">\n\t\t\t\tBe careful not to flub your mudras, as using <ActionLink action=\"RABBIT_MEDIUM\"/> can cost you considerable DPS by reducing the number of <ActionLink action=\"TRICK_ATTACK\"/>s you can do during the fight.\n\t\t\t</Trans>,\n\t\t\ttiers: {\n\t\t\t\t1: SEVERITY.MEDIUM, // You were having a bad day, mudra lag, etc.\n\t\t\t\t3: SEVERITY.MAJOR, // Holy shit get better internet\n\t\t\t},\n\t\t\tvalue: this.rabbitCount,\n\t\t\twhy: <Trans id=\"nin.ninjutsu.suggestions.rabbit.why\">\n\t\t\t\tYou cast Rabbit Medium <Plural value={this.rabbitCount} one=\"# time\" other=\"# times\"/>.\n\t\t\t</Trans>,\n\t\t}))\n\n\t\tconst {badTcjs, badAoes, badStds} = this.appraiseDotonCasts()\n\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\ticon: this.data.actions.DOTON.icon,\n\t\t\tcontent: <Trans id=\"nin.ninjutsu.suggestions.tcj-doton.content\">\n\t\t\t\tAvoid using <ActionLink action=\"DOTON\"/> under <ActionLink action=\"TEN_CHI_JIN\"/> unless you're up against multiple targets. On a single target, using the <ActionLink action=\"SUITON\"/> combo will do equivalent or better damage and keep it aligned with <ActionLink action=\"MEISUI\"/>.\n\t\t\t</Trans>,\n\t\t\ttiers: {\n\t\t\t\t1: SEVERITY.MEDIUM,\n\t\t\t\t2: SEVERITY.MAJOR,\n\t\t\t},\n\t\t\tvalue: badTcjs,\n\t\t\twhy: <Trans id=\"nin.ninjutsu.suggestions.tcj-doton.why\">\n\t\t\t\tYou cast a single-target Doton under Ten Chi Jin <Plural value={badTcjs} one=\"# time\" other=\"# times\"/>.\n\t\t\t</Trans>,\n\t\t}))\n\n\t\tif (badAoes > 0) {\n\t\t\tthis.suggestions.add(new Suggestion({\n\t\t\t\ticon: this.data.actions.DOTON.icon,\n\t\t\t\tcontent: <Trans id=\"nin.ninjutsu.suggestions.aoe-doton.content\">\n\t\t\t\t\t<ActionLink action=\"DOTON\"/> requires at least {DOTON_TICK_TARGET} ticks to be worthwhile in an AoE setting. Use <ActionLink action=\"KATON\"/> instead against adds that will die quickly.\n\t\t\t\t</Trans>,\n\t\t\t\tseverity: SEVERITY.MINOR,\n\t\t\t\twhy: <Trans id=\"nin.ninjutsu.suggestions.aoe-doton.why\">\n\t\t\t\t\tYou cast an unoptimized Doton cast <Plural value={badAoes} one=\"# time\" other=\"# times\"/>.\n\t\t\t\t</Trans>,\n\t\t\t}))\n\t\t}\n\n\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\ticon: this.data.actions.DOTON.icon,\n\t\t\tcontent: <Trans id=\"nin.ninjutsu.suggestions.st-doton.content\">\n\t\t\t\tAvoid using <ActionLink action=\"DOTON\"/> on single targets, as it does less damage than <ActionLink action=\"RAITON\"/> if any ticks miss and uses more mudras, resulting in more GCD delay for no gain.\n\t\t\t</Trans>,\n\t\t\ttiers: {\n\t\t\t\t1: SEVERITY.MINOR,\n\t\t\t\t2: SEVERITY.MEDIUM,\n\t\t\t\t3: SEVERITY.MAJOR,\n\t\t\t},\n\t\t\tvalue: badStds,\n\t\t\twhy: <Trans id=\"nin.ninjutsu.suggestions.st-doton.why\">\n\t\t\t\tYou cast a single-target Doton <Plural value={badStds} one=\"# time\" other=\"# times\"/>.\n\t\t\t</Trans>,\n\t\t}))\n\t}\n}\n","import {t} from '@lingui/macro'\nimport {Trans, Plural} from '@lingui/react'\nimport {ActionLink} from 'components/ui/DbLink'\nimport {JOBS} from 'data/JOBS'\nimport {Cause, Event, Events} from 'event'\nimport {filter, oneOf} from 'parser/core/filter'\nimport {dependency} from 'parser/core/Injectable'\nimport {CounterGauge, Gauge as CoreGauge} from 'parser/core/modules/Gauge'\nimport Suggestions, {TieredSuggestion, SEVERITY} from 'parser/core/modules/Suggestions'\nimport React from 'react'\nimport {isSuccessfulHit} from 'utilities'\n\ntype GaugeModifier = Partial<Record<Event['type'], number>>\n\n// Constants\nconst BUNSHIN_GAIN = 5\nconst BUNSHIN_GAIN_KAMAITACHI = 10\nconst HELLFROG_TARGET_MINIMUM = 3\n\nconst OVERCAP_SEVERITY = {\n\t20: SEVERITY.MINOR,\n\t50: SEVERITY.MAJOR,\n}\nconst FROG_SEVERITY = {\n\t1: SEVERITY.MEDIUM,\n}\n\nexport class Ninki extends CoreGauge {\n\tstatic override title = t('nin.ninki.title')`Ninki Gauge`\n\n\t@dependency private suggestions!: Suggestions\n\n\tprivate ninkiGauge = this.add(new CounterGauge({\n\t\tgraph: {\n\t\t\tlabel: <Trans id=\"nin.ninki.resource.label\">Ninki</Trans>,\n\t\t\tcolor: JOBS.NINJA.colour,\n\t\t},\n\t}))\n\n\tprivate ninkiFilters = {\n\t\taction: [\n\t\t\tthis.data.actions.BHAVACAKRA.id,\n\t\t\tthis.data.actions.HELLFROG_MEDIUM.id,\n\t\t\tthis.data.actions.BUNSHIN.id,\n\t\t\tthis.data.actions.MEISUI.id,\n\t\t],\n\t\tcombo: [\n\t\t\tthis.data.actions.SPINNING_EDGE.id,\n\t\t\tthis.data.actions.GUST_SLASH.id,\n\t\t\tthis.data.actions.AEOLIAN_EDGE.id,\n\t\t\tthis.data.actions.ARMOR_CRUSH.id,\n\t\t\tthis.data.actions.DEATH_BLOSSOM.id,\n\t\t\tthis.data.actions.HAKKE_MUJINSATSU.id,\n\t\t],\n\t\tdamage: [\n\t\t\tthis.data.actions.HURAIJIN.id,\n\t\t\tthis.data.actions.FORKED_RAIJU.id,\n\t\t\tthis.data.actions.FLEETING_RAIJU.id,\n\t\t\tthis.data.actions.THROWING_DAGGER.id,\n\t\t\tthis.data.actions.MUG.id,\n\t\t],\n\t}\n\n\tprivate ninkiModifiers = new Map<number, GaugeModifier>([\n\t\t// Builders\n\t\t[this.data.actions.SPINNING_EDGE.id, {combo: 5}],\n\t\t[this.data.actions.GUST_SLASH.id, {combo: 5}],\n\t\t[this.data.actions.AEOLIAN_EDGE.id, {combo: 15}],\n\t\t[this.data.actions.ARMOR_CRUSH.id, {combo: 15}],\n\t\t[this.data.actions.DEATH_BLOSSOM.id, {combo: 5}],\n\t\t[this.data.actions.HAKKE_MUJINSATSU.id, {combo: 5}],\n\t\t[this.data.actions.HURAIJIN.id, {damage: 5}],\n\t\t[this.data.actions.FORKED_RAIJU.id, {damage: 5}],\n\t\t[this.data.actions.FLEETING_RAIJU.id, {damage: 5}],\n\t\t[this.data.actions.THROWING_DAGGER.id, {damage: 5}],\n\t\t[this.data.actions.MUG.id, {damage: 40}],\n\t\t[this.data.actions.MEISUI.id, {action: 50}],\n\t\t// Spenders\n\t\t[this.data.actions.BHAVACAKRA.id, {action: -50}],\n\t\t[this.data.actions.HELLFROG_MEDIUM.id, {action: -50}],\n\t\t[this.data.actions.BUNSHIN.id, {action: -50}],\n\t])\n\n\tprivate erroneousFrogs: number = 0 // This is my new band name\n\n\toverride initialise() {\n\t\tsuper.initialise()\n\n\t\tconst playerFilter = filter<Event>().source(this.parser.actor.id)\n\t\tconst pets = this.parser.pull.actors.filter(actor => actor.owner === this.parser.actor).map(actor => actor.id)\n\t\tthis.addEventHook(playerFilter.type('action').action(oneOf(this.ninkiFilters.action)), this.onGaugeModifier)\n\t\tthis.addEventHook(playerFilter.type('combo').action(oneOf(this.ninkiFilters.combo)), this.onGaugeModifier)\n\t\tthis.addEventHook(playerFilter.type('damage').cause(filter<Cause>().action(oneOf(this.ninkiFilters.damage))), this.onDamage)\n\t\tthis.addEventHook(filter<Event>().source(oneOf(pets)).type('damage'), this.onBunshinHit)\n\t\tthis.addEventHook(playerFilter.type('damage').cause(filter<Cause>().action(this.data.actions.HELLFROG_MEDIUM.id)), this.onHellfrog)\n\t\tthis.addEventHook('complete', this.onComplete)\n\t}\n\n\tprivate onBunshinHit(event: Events['damage']) {\n\t\tif (event.cause.type === 'action' && event.cause.action === this.data.actions.PHANTOM_KAMAITACHI_BUNSHIN.id) {\n\t\t\tthis.ninkiGauge.modify(BUNSHIN_GAIN_KAMAITACHI)\n\t\t} else {\n\t\t\tthis.ninkiGauge.modify(BUNSHIN_GAIN)\n\t\t}\n\t}\n\n\tprivate onDamage(event: Events['damage']) {\n\t\tif (!isSuccessfulHit(event) || event.cause.type !== 'action') {\n\t\t\treturn\n\t\t}\n\n\t\tconst modifier = this.ninkiModifiers.get(event.cause.action)\n\t\tif (modifier != null) {\n\t\t\tconst amount = modifier[event.type] ?? 0\n\t\t\tthis.ninkiGauge.modify(amount)\n\t\t}\n\t}\n\n\tprivate onGaugeModifier(event: Events['action' | 'combo']) {\n\t\tconst modifier = this.ninkiModifiers.get(event.action)\n\t\tif (modifier != null) {\n\t\t\tconst amount = modifier[event.type] ?? 0\n\t\t\tthis.ninkiGauge.modify(amount)\n\t\t}\n\t}\n\n\tprivate onHellfrog(event: Events['damage']) {\n\t\tif (event.targets.length < HELLFROG_TARGET_MINIMUM) {\n\t\t\t// If we have a Hellfrog event with fewer than 3 targets, it should've been a Bhava instead\n\t\t\tthis.erroneousFrogs++\n\t\t}\n\t}\n\n\tprivate onComplete() {\n\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\ticon: 'https://xivapi.com/i/005000/005411.png',\n\t\t\tcontent: <Trans id=\"nin.ninki.suggestions.waste.content\">\n\t\t\t\tAvoid using <ActionLink action=\"MUG\"/> and <ActionLink action=\"MEISUI\"/> when above 40 Ninki and holding your Ninki spenders when near or at cap (with a few small exceptions) in order to maximize the number of spenders you can use over the course of a fight.\n\t\t\t</Trans>,\n\t\t\ttiers: OVERCAP_SEVERITY,\n\t\t\tvalue: this.ninkiGauge.overCap,\n\t\t\twhy: <Trans id=\"nin.ninki.suggestions.waste.why\">\n\t\t\t\tOvercapping caused you to lose {this.ninkiGauge.overCap} Ninki over the fight.\n\t\t\t</Trans>,\n\t\t}))\n\n\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\ticon: this.data.actions.HELLFROG_MEDIUM.icon,\n\t\t\tcontent: <Trans id=\"nin.ninki.suggestions.frog.content\">\n\t\t\t\tAvoid using <ActionLink action=\"HELLFROG_MEDIUM\"/> when you have fewer than three targets, as <ActionLink action=\"BHAVACAKRA\"/> is otherwise a potency gain.\n\t\t\t</Trans>,\n\t\t\ttiers: FROG_SEVERITY,\n\t\t\tvalue: this.erroneousFrogs,\n\t\t\twhy: <Trans id=\"nin.ninki.suggestions.frog.why\">\n\t\t\t\tYou used Hellfrog Medium <Plural value={this.erroneousFrogs} one=\"# time\" other=\"# times\"/> when other spenders were available.\n\t\t\t</Trans>,\n\t\t}))\n\t}\n}\n","import {Events} from 'event'\nimport {CooldownDowntime} from 'parser/core/modules/CooldownDowntime'\n\nconst KASSATSU_FIRST_USE_OFFSET = 1000 // After opening Suiton\nconst MUG_FIRST_USE_OFFSET = 6000 // After second combo GCD\nconst BUNSHIN_FIRST_USE_OFFSET = 7000 // After second combo GCD (second weave)\nconst TRICK_FIRST_USE_OFFSET = 10000 // After fourth combo GCD\nconst DWAD_FIRST_USE_OFFSET = 12250 // After SF\nconst TCJ_FIRST_USE_OFFSET = 17250 // After two Ninjutsu\nconst MEISUI_FIRST_USE_OFFSET = 20750 // After TCJ\n\nexport class OGCDDowntime extends CooldownDowntime {\n\toverride trackedCds = [\n\t\t{\n\t\t\tcooldowns: [this.data.actions.KASSATSU],\n\t\t\tfirstUseOffset: KASSATSU_FIRST_USE_OFFSET,\n\t\t},\n\t\t{\n\t\t\tcooldowns: [this.data.actions.MUG],\n\t\t\tfirstUseOffset: MUG_FIRST_USE_OFFSET,\n\t\t},\n\t\t{\n\t\t\tcooldowns: [this.data.actions.BUNSHIN],\n\t\t\tfirstUseOffset: BUNSHIN_FIRST_USE_OFFSET,\n\t\t},\n\t\t{\n\t\t\tcooldowns: [this.data.actions.TRICK_ATTACK],\n\t\t\tfirstUseOffset: TRICK_FIRST_USE_OFFSET,\n\t\t},\n\t\t{\n\t\t\tcooldowns: [this.data.actions.DREAM_WITHIN_A_DREAM],\n\t\t\tfirstUseOffset: DWAD_FIRST_USE_OFFSET,\n\t\t},\n\t\t{\n\t\t\tcooldowns: [this.data.actions.TEN_CHI_JIN],\n\t\t\tfirstUseOffset: TCJ_FIRST_USE_OFFSET,\n\t\t},\n\t\t{\n\t\t\tcooldowns: [this.data.actions.MEISUI],\n\t\t\tfirstUseOffset: MEISUI_FIRST_USE_OFFSET,\n\t\t},\n\t]\n\n\tprivate dreamTimestamps: number[] = []\n\n\toverride countUsage(event: Events['action']) {\n\t\tif (event.action !== this.data.actions.DREAM_WITHIN_A_DREAM.id) {\n\t\t\treturn true\n\t\t}\n\n\t\tif (this.dreamTimestamps.indexOf(event.timestamp) > -1) {\n\t\t\treturn false\n\t\t}\n\n\t\tthis.dreamTimestamps.push(event.timestamp)\n\t\treturn true\n\t}\n}\n","import {Positionals as CorePositionals} from 'parser/core/modules/Positionals'\n\nexport class Positionals extends CorePositionals {\n\tpositionals = [\n\t\tthis.data.actions.ARMOR_CRUSH,\n\t\tthis.data.actions.TRICK_ATTACK,\n\t\tthis.data.actions.AEOLIAN_EDGE,\n\t]\n}\n","import {Trans, Plural} from '@lingui/react'\nimport {StatusLink} from 'components/ui/DbLink'\nimport {Event, Events} from 'event'\nimport {Analyser} from 'parser/core/Analyser'\nimport {filter, oneOf} from 'parser/core/filter'\nimport {dependency} from 'parser/core/Injectable'\nimport {Actors} from 'parser/core/modules/Actors'\nimport {Data} from 'parser/core/modules/Data'\nimport Suggestions, {TieredSuggestion, SEVERITY} from 'parser/core/modules/Suggestions'\nimport React from 'react'\n\nexport class Raiju extends Analyser {\n\tstatic override handle = 'raiju'\n\n\t@dependency private actors!: Actors\n\t@dependency private data!: Data\n\t@dependency private suggestions!: Suggestions\n\n\tprivate currentStacks: number = 0\n\tprivate droppedStacks: number = 0\n\n\tprivate breakingGcds = [\n\t\tthis.data.actions.SPINNING_EDGE.id,\n\t\tthis.data.actions.GUST_SLASH.id,\n\t\tthis.data.actions.AEOLIAN_EDGE.id,\n\t\tthis.data.actions.ARMOR_CRUSH.id,\n\t\tthis.data.actions.DEATH_BLOSSOM.id,\n\t\tthis.data.actions.HAKKE_MUJINSATSU.id,\n\t\tthis.data.actions.HURAIJIN.id,\n\t]\n\n\toverride initialise() {\n\t\tconst playerFilter = filter<Event>().source(this.parser.actor.id)\n\t\tthis.addEventHook(playerFilter.type('statusApply').status(this.data.statuses.RAIJU_READY.id), this.onRaijuReady)\n\t\tthis.addEventHook(playerFilter.type('statusRemove').status(this.data.statuses.RAIJU_READY.id), () => this.currentStacks = 0)\n\t\tthis.addEventHook(playerFilter.type('action').action(oneOf(this.breakingGcds)), this.onBreakingGcd)\n\t\tthis.addEventHook('complete', this.onComplete)\n\t}\n\n\tprivate onRaijuReady(event: Events['statusApply']) {\n\t\tthis.currentStacks = event.data ?? 1\n\t}\n\n\tprivate onBreakingGcd() {\n\t\tthis.droppedStacks += this.currentStacks\n\t\tthis.currentStacks = 0\n\t}\n\n\tprivate onComplete() {\n\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\ticon: this.data.actions.FLEETING_RAIJU.icon,\n\t\t\tcontent: <Trans id=\"nin.raiju.suggestions.dropped.content\">\n\t\t\t\tAvoid using any of your non-Raiju melee GCDs while you have stacks of <StatusLink status=\"RAIJU_READY\"/>, as it will cause the stacks to fall off.\n\t\t\t</Trans>,\n\t\t\ttiers: {\n\t\t\t\t1: SEVERITY.MAJOR,\n\t\t\t},\n\t\t\tvalue: this.droppedStacks,\n\t\t\twhy: <Trans id=\"nin.raiju.suggestions.dropped.why\">\n\t\t\t\tYou dropped <Plural value={this.droppedStacks} one=\"# stack\" other=\"# stacks\"/> of Raiju Ready.\n\t\t\t</Trans>,\n\t\t}))\n\t}\n}\n","import {Trans, Plural} from '@lingui/react'\nimport {ActionLink} from 'components/ui/DbLink'\nimport {ActionKey} from 'data/ACTIONS'\nimport {Event, Events} from 'event'\nimport {Analyser} from 'parser/core/Analyser'\nimport {EventHook} from 'parser/core/Dispatcher'\nimport {filter} from 'parser/core/filter'\nimport {dependency} from 'parser/core/Injectable'\nimport {Data} from 'parser/core/modules/Data'\nimport Downtime from 'parser/core/modules/Downtime'\nimport Suggestions, {TieredSuggestion, SEVERITY} from 'parser/core/modules/Suggestions'\nimport React from 'react'\nimport {matchClosestHigher} from 'utilities'\n\nconst OPTIMAL_GCD_COUNT = 4 // Opener should be Suiton > AE combo before Trick\n\nconst MUDRAS: ActionKey[] = [\n\t'TEN',\n\t'TEN_KASSATSU',\n\t'CHI',\n\t'CHI_KASSATSU',\n\t'JIN',\n\t'JIN_KASSATSU',\n]\n\nexport class TrickAttackUsage extends Analyser {\n\tstatic override handle = 'taUsage'\n\n\t@dependency private data!: Data\n\t@dependency private downtime!: Downtime\n\t@dependency private suggestions!: Suggestions\n\n\tprivate mudraActions: number[] = []\n\n\tprivate taCasts: number[] = []\n\tprivate lostTime: number = 0\n\tprivate gcdCount: number = 0\n\tprivate castHook?: EventHook<Events['action']>\n\n\toverride initialise() {\n\t\tthis.mudraActions = MUDRAS.map(k => this.data.actions[k].id)\n\n\t\tconst playerFilter = filter<Event>().source(this.parser.actor.id)\n\t\t// Hook to track casts before the first Trick for the opener timing suggestion\n\t\tthis.castHook = this.addEventHook(playerFilter.type('action'), this.onCast)\n\t\tthis.addEventHook(playerFilter.type('action').action(this.data.actions.TRICK_ATTACK.id), this.onTrickAttack)\n\t\tthis.addEventHook('complete', this.onComplete)\n\t}\n\n\tprivate onCast(event: Events['action']) {\n\t\tconst action = this.data.getAction(event.action)\n\t\tif (event.timestamp >= this.parser.pull.timestamp && action?.onGcd && !this.mudraActions.includes(action.id)) {\n\t\t\t// Don't count the individual mudras as GCDs for this - they'll make the count screw if Suiton wasn't set up pre-pull\n\t\t\tthis.gcdCount++\n\t\t}\n\t}\n\n\tprivate onTrickAttack(event: Events['action']) {\n\t\tif (this.castHook != null) {\n\t\t\tthis.removeEventHook(this.castHook)\n\t\t\tthis.castHook = undefined\n\t\t}\n\n\t\tif (this.taCasts.length > 0) {\n\t\t\tconst lastCast = this.taCasts[this.taCasts.length - 1]\n\t\t\tconst taAvailable = lastCast + this.data.actions.TRICK_ATTACK.cooldown\n\t\t\tconst downtime = this.downtime.getDowntime(taAvailable, event.timestamp)\n\t\t\tthis.lostTime += Math.max((event.timestamp - taAvailable) - downtime, 0)\n\t\t}\n\n\t\tthis.taCasts.push(event.timestamp)\n\t}\n\n\tprivate onComplete() {\n\t\tif (this.taCasts.length > 0) {\n\t\t\tconst lastCast = this.taCasts[this.taCasts.length - 1]\n\t\t\t// lostTime is only the time they were actually holding it off CD, but we want to add in the CD time of the final cast for\n\t\t\t// calculating how many theoretical casts were lost. For example, 20s of holding + last cast 40s before the end of the fight\n\t\t\t// would mean that they could've squeezed in an extra cast with perfect timing.\n\t\t\tconst lostCasts = Math.floor((this.lostTime + (this.parser.currentEpochTimestamp - lastCast)) / this.data.actions.TRICK_ATTACK.cooldown)\n\t\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\t\ticon: this.data.actions.TRICK_ATTACK.icon,\n\t\t\t\tcontent: <Trans id=\"nin.ta-usage.suggestions.missed.content\">\n\t\t\t\t\tAvoid holding <ActionLink action=\"TRICK_ATTACK\"/> for extended periods of time. It's typically ideal to use it as close to on cooldown as possible in order to keep it aligned with raid buffs, as well as maximizing the number of uses per fight.\n\t\t\t\t</Trans>,\n\t\t\t\tvalue: lostCasts,\n\t\t\t\ttiers: {\n\t\t\t\t\t1: SEVERITY.MEDIUM,\n\t\t\t\t\t2: SEVERITY.MAJOR,\n\t\t\t\t},\n\t\t\t\twhy: <Trans id=\"nin.ta-usage.suggestions.missed.why\">\n\t\t\t\t\tYou delayed Trick Attack for a cumulative {this.parser.formatDuration(this.lostTime)}, costing you <Plural value={lostCasts} one=\"# potential use\" other=\"# potential uses\"/>.\n\t\t\t\t</Trans>,\n\t\t\t}))\n\n\t\t\t// Suppressing this suggestion for any 6.1+ parses, since Trick isn't a raid buff anymore and it's not really worth updating/keeping around for Mug\n\t\t\tif (this.parser.patch.before('6.1')) {\n\t\t\t\tconst distanceFromOptimal = Math.abs(OPTIMAL_GCD_COUNT - this.gcdCount)\n\t\t\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\t\t\ticon: this.data.actions.TRICK_ATTACK.icon,\n\t\t\t\t\tcontent: <Trans id=\"nin.ta-usage.suggestions.opener.content\">\n\t\t\t\t\t\tAvoid unconventional timings for your first <ActionLink action=\"TRICK_ATTACK\"/> of the fight in order to line it up raid buffs. In most openers, Trick Attack should be weaved in approximately 8-9 seconds into the fight.\n\t\t\t\t\t</Trans>,\n\t\t\t\t\tvalue: distanceFromOptimal,\n\t\t\t\t\ttiers: {\n\t\t\t\t\t\t1: SEVERITY.MEDIUM,\n\t\t\t\t\t\t2: SEVERITY.MAJOR,\n\t\t\t\t\t},\n\t\t\t\t\twhy: <Trans id=\"nin.ta-usage.suggestions.opener.why\">\n\t\t\t\t\t\tYour first Trick Attack was <Plural value={this.gcdCount} one=\"# GCD\" other=\"# GCDs\"/> into your opener.\n\t\t\t\t\t</Trans>,\n\t\t\t\t}))\n\t\t\t}\n\t\t}\n\n\t\t// WHY ARE YOU EVEN PLAYING THIS JOB\n\t\tthis.suggestions.add(new TieredSuggestion({\n\t\t\ticon: this.data.actions.TRICK_ATTACK.icon,\n\t\t\tcontent: <Trans id=\"nin.ta-usage.suggestions.none.content\">\n\t\t\t\t<ActionLink action=\"TRICK_ATTACK\"/> is a very powerful personal buff and should be used on cooldown, or as close to it as possible depending on the flow of the fight.\n\t\t\t</Trans>,\n\t\t\tvalue: this.taCasts.length,\n\t\t\ttiers: {\n\t\t\t\t0: SEVERITY.MAJOR,\n\t\t\t},\n\t\t\tmatcher: matchClosestHigher,\n\t\t\twhy: <Trans id=\"nin.ta-usage.suggestions.none.why\">\n\t\t\t\tYou didn't use Trick Attack once the entire fight.\n\t\t\t</Trans>,\n\t\t}))\n\t}\n}\n","import {t} from '@lingui/macro'\nimport {Trans, Plural} from '@lingui/react'\nimport {ActionLink} from 'components/ui/DbLink'\nimport {ActionKey} from 'data/ACTIONS'\nimport {dependency} from 'parser/core/Injectable'\nimport {BuffWindow, EvaluatedAction, ExpectedActionsEvaluator, ExpectedGcdCountEvaluator, LimitedActionsEvaluator, NotesEvaluator, TrackedAction} from 'parser/core/modules/ActionWindow'\nimport {HistoryEntry} from 'parser/core/modules/ActionWindow/History'\nimport {GlobalCooldown} from 'parser/core/modules/GlobalCooldown'\nimport {SEVERITY} from 'parser/core/modules/Suggestions'\nimport React from 'react'\n\n// TCJ windows should have 5-6 Ninjutsu + 2-3 (or 3-4, with good ping) weaponskills, non-TCJ windows should have 3 Ninjutsu + 4 weaponskills\nconst BASE_GCDS_PER_WINDOW = 7\n\n// For opener detection - first Trick should be 8-9s into the fight, with a bit of wiggle room for late starts\nconst FIRST_TRICK_BUFFER = 12000\n\nconst MUDRAS: ActionKey[] = [\n\t'TEN',\n\t'TEN_KASSATSU',\n\t'CHI',\n\t'CHI_KASSATSU',\n\t'JIN',\n\t'JIN_KASSATSU',\n]\n\nclass TCJEvaluator extends NotesEvaluator {\n\n\t// Because this class is not an Analyser, it cannot use Data directly\n\t// to get the id for Ten Chi Jin, so it has to take it in here.\n\tprivate tcjId: number\n\n\tconstructor(tcjId: number) {\n\t\tsuper()\n\t\tthis.tcjId = tcjId\n\t}\n\n\theader = {\n\t\theader: <Trans id =\"nin.taWindow.chart.notes.header\">TCJ Used</Trans>,\n\t\taccessor: 'tcjused',\n\t}\n\n\toverride generateNotes(window: HistoryEntry<EvaluatedAction[]>) {\n\t\t// TODO - Add a note in here about Meisui-buffed Bhava, maybe?\n\t\treturn window.data.find(cast => cast.action.id === this.tcjId) ?\n\t\t\t<Trans id=\"nin.taWindow.chart.notes.yes\">Yes</Trans> :\n\t\t\t<Trans id=\"nin.taWindow.chart.notes.no\">No</Trans>\n\t}\n}\n\nexport class TrickAttackWindow extends BuffWindow {\n\tstatic override handle = 'taWindow'\n\tstatic override title = t('nin.taWindow.title')`Trick Attack Windows`\n\n\t@dependency globalCooldown!: GlobalCooldown\n\n\t// The Trick Attack debuff changed in 6.1, so we need to track a different one depending on the patch\n\toverride buffStatus = this.parser.patch.before('6.1') ? this.data.statuses.TRICK_ATTACK_VULNERABILITY_UP : this.data.statuses.TRICK_ATTACK\n\n\toverride initialise() {\n\t\tsuper.initialise()\n\n\t\tthis.ignoreActions(MUDRAS.map(k => this.data.actions[k].id))\n\n\t\tconst suggestionIcon = this.data.actions.TRICK_ATTACK.icon\n\t\tconst suggestionWindowName = <ActionLink action=\"TRICK_ATTACK\" showIcon={false}/>\n\t\tthis.addEvaluator(new ExpectedGcdCountEvaluator({\n\t\t\texpectedGcds: BASE_GCDS_PER_WINDOW,\n\t\t\tglobalCooldown: this.globalCooldown,\n\t\t\thasStacks: false,\n\t\t\tsuggestionIcon,\n\t\t\tsuggestionContent: <Trans id=\"nin.taWindow.suggestions.gcds.content\">\n\t\t\t\tWhile the exact number of GCDs per window will vary depending on whether <ActionLink action=\"TEN_CHI_JIN\"/> is up, every <ActionLink action=\"TRICK_ATTACK\"/> window should contain at least <Plural value={BASE_GCDS_PER_WINDOW} one=\"# GCD\" other=\"# GCDs\" />.\n\t\t\t</Trans>,\n\t\t\tsuggestionWindowName,\n\t\t\tseverityTiers: {\n\t\t\t\t1: SEVERITY.MEDIUM,\n\t\t\t\t2: SEVERITY.MAJOR,\n\t\t\t},\n\t\t\tadjustCount: this.adjustExpectedGcdCount.bind(this),\n\t\t}))\n\n\t\tthis.addEvaluator(new ExpectedActionsEvaluator({\n\t\t\texpectedActions: [\n\t\t\t\t{\n\t\t\t\t\taction: this.data.actions.HYOSHO_RANRYU,\n\t\t\t\t\texpectedPerWindow: 1,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\taction: this.data.actions.RAITON,\n\t\t\t\t\texpectedPerWindow: 2,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\taction: this.data.actions.DREAM_WITHIN_A_DREAM,\n\t\t\t\t\texpectedPerWindow: 1,\n\t\t\t\t},\n\t\t\t],\n\t\t\tsuggestionIcon,\n\t\t\tsuggestionContent: <Trans id=\"nin.taWindow.suggestions.trackedactions.content\">\n\t\t\t\tEvery <ActionLink action=\"TRICK_ATTACK\"/> window should contain <ActionLink action=\"HYOSHO_RANRYU\"/>, 2 <ActionLink action=\"RAITON\"/> casts, and <ActionLink action=\"DREAM_WITHIN_A_DREAM\"/> in order to maximize damage.\n\t\t\t</Trans>,\n\t\t\tsuggestionWindowName,\n\t\t\tseverityTiers: {\n\t\t\t\t1: SEVERITY.MEDIUM,\n\t\t\t\t3: SEVERITY.MAJOR,\n\t\t\t},\n\t\t\tadjustCount: this.adjustExpectedRaitonCount.bind(this),\n\t\t}))\n\n\t\tthis.addEvaluator(new LimitedActionsEvaluator({\n\t\t\texpectedActions: [\n\t\t\t\t{\n\t\t\t\t\taction: this.data.actions.ARMOR_CRUSH,\n\t\t\t\t\texpectedPerWindow: 0,\n\t\t\t\t},\n\t\t\t],\n\t\t\tsuggestionIcon: this.data.actions.ARMOR_CRUSH.icon,\n\t\t\tsuggestionContent: <Trans id=\"nin.taWindow.suggestions.badtrackedactions.content\">\n\t\t\t\tAvoid using <ActionLink action=\"ARMOR_CRUSH\"/> under <ActionLink action=\"TRICK_ATTACK\"/> unless <ActionLink action=\"HUTON\"/> is about to fall off or you can only hit the flank positional, as <ActionLink action=\"AEOLIAN_EDGE\"/> is otherwise a higher potency finisher.\n\t\t\t</Trans>,\n\t\t\tsuggestionWindowName,\n\t\t\tseverityTiers: {\n\t\t\t\t1: SEVERITY.MINOR,\n\t\t\t},\n\t\t}))\n\n\t\tthis.addEvaluator(new TCJEvaluator(this.data.actions.TEN_CHI_JIN.id))\n\t}\n\n\tprivate adjustExpectedGcdCount(window: HistoryEntry<EvaluatedAction[]>) {\n\t\treturn window.data.find(cast => cast.action.id === this.data.actions.TEN_CHI_JIN.id) ? 1 : 0\n\t}\n\n\tprivate adjustExpectedRaitonCount(window: HistoryEntry<EvaluatedAction[]>, action: TrackedAction) {\n\t\tconst bufferedWindowStart = window.start - FIRST_TRICK_BUFFER\n\n\t\tif (action.action.id === this.data.actions.RAITON.id) {\n\t\t\t// We push one Raiton outside the Trick window in the opener to fit an extra Bhava\n\t\t\tif (bufferedWindowStart <= this.parser.pull.timestamp) {\n\t\t\t\treturn -1\n\t\t\t}\n\t\t}\n\n\t\treturn 0\n\t}\n}\n","import {Weaving as CoreWeaving, Weave} from 'parser/core/modules/Weaving'\n\nexport class Weaving extends CoreWeaving {\n\toverride getMaxWeaves(weave: Weave) {\n\t\tlet dreams = 0\n\n\t\tfor (let i = 0; i < weave.weaves.length; i++) {\n\t\t\tif (weave.weaves[i].action === this.data.actions.DREAM_WITHIN_A_DREAM.id) {\n\t\t\t\tdreams++\n\t\t\t}\n\t\t}\n\n\t\t// If duplicate DWaD events are seen, don't penalize the extra events as bad weaves - the data source generated duplicate events that we should ignore\n\t\treturn super.getMaxWeaves(weave) + Math.max(0, dreams - 1)\n\t}\n}\n","import {ActionTimeline} from './ActionTimeline'\nimport {Combos} from './Combos'\nimport {Defensives} from './Defensives'\nimport {Huton} from './Huton'\nimport {HutonCastTime} from './HutonCastTime'\nimport {Kassatsu} from './Kassatsu'\nimport {Ninjutsu} from './Ninjutsu'\nimport {Ninki} from './Ninki'\nimport {OGCDDowntime} from './OGCDDowntime'\nimport {Positionals} from './Positionals'\nimport {Raiju} from './Raiju'\nimport {TrickAttackUsage} from './TrickAttackUsage'\nimport {TrickAttackWindow} from './TrickAttackWindow'\nimport {Weaving} from './Weaving'\n\nexport default [\n\tActionTimeline,\n\tCombos,\n\tDefensives,\n\tHuton,\n\tHutonCastTime,\n\tKassatsu,\n\tNinjutsu,\n\tNinki,\n\tPositionals,\n\tOGCDDowntime,\n\tRaiju,\n\tTrickAttackUsage,\n\tTrickAttackWindow,\n\tWeaving,\n]\n","require('../../modules/es.math.trunc');\nvar path = require('../../internals/path');\n\nmodule.exports = path.Math.trunc;\n","var $ = require('../internals/export');\n\nvar ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `Math.trunc` method\n// https://tc39.es/ecma262/#sec-math.trunc\n$({ target: 'Math', stat: true }, {\n  trunc: function trunc(it) {\n    return (it > 0 ? floor : ceil)(it);\n  }\n});\n","var parent = require('../../es/math/trunc');\n\nmodule.exports = parent;\n"],"names":["module","exports","ItemDepth","ActionTimeline","CastTime","Cooldowns","Data","Timeline","resolvedRows","groupRows","action","this","addRow","content","constructor","rows","config","resolvedConfig","resolveConfig","push","addEventHook","onComplete","maybeAction","fullAction","undefined","data","getAction","actions","uses","cooldowns","cooldownHistory","id","length","name","populatedGroups","row","lateResolveLabel","label","resolveRowLabel","populateRow","forEach","specifier","groups","group","add","allGroups","has","finalConfig","Array","isArray","ensureArray","existingRow","get","isDefined","firstContent","Trans","timeline","ContainerRow","order","collapse","set","addCooldownItems","addChargeItems","chargeHistory","history","entry","duration","getCooldownDuration","start","parser","pull","timestamp","end","addItem","SimpleItem","className","item","delta","ActionItem","depth","ACTION","ChargeGainItem","CHARGE_GAIN","endReason","CooldownEndReason","castTime","forAction","Math","max","Analyser","handle","debug","dependency","Content","styles","Icon","BaseItem","DEFENSIVE_ROLE_ACTIONS","Defensives","CooldownDowntime","trackedDefensives","headerContent","JOBS","actor","job","role","key","roleAction","defensive","getUses","totalAdditionalUses","acc","usage","getAdditionalUsageData","chargesBeforeNextUse","getUsageCount","Fragment","icon","exclusive","styled","fluid","panels","index","title","getMaxUses","compact","unstackable","celled","tryGetAdditionalUseRow","getUsageRow","formatEpochTimestamp","circular","size","onClick","show","availableTimestamp","currentCharges","charges","chargesAvailableEvent","current","cooldown","nextEntry","historyEntry","useByTimestamp","floor","displayOrder","DISPLAY_ORDER","cooldownDowntime","estimateHelp","__all","legacyFflogs","GlobalCooldown","Statistics","SpeedAdjustments","speedAdjustments","getAdjustedDuration","BASE_GCD","isAdjustmentEstimated","estimated","isEstimated","statistics","SimpleStatistic","ATTACK","value","formatDuration","getDuration","info","source","report","meta","Positionals","Checklist","positionalResults","positionals","filter","type","cause","matchCauseActionId","positional","onCast","event","positionalResult","getOrCreatePositionalResult","positionalHit","targets","bonusPercent","hits","misses","result","missed_positional_combo_bonus_percent","calculateBonusPercent","getBasePotency","getPotencyWithMods","BonusModifier","missedPositionalBonusPercents","base","bonus","relative_timestamp","relativeTimestamp","checklist","Rule","description","requirements","positionalRequirement","actual","expected","percent","min","Requirement","weight","overrideDisplay","toFixed","total","textAlign","numHits","numMisses","success","style","whiteSpace","showName","positive","negative","miss","createTimelineButton","CAST_TIME_MAX_WEAVES","WEAVING_SEVERITY","SEVERITY","Weaving","Invulnerability","Suggestions","suggestionIcon","moduleLink","cursor","scrollTo","message","suggestionContent","severity","weaves","ongoingCastEvent","leadingGcdEvent","trailingGcdEvent","badWeaves","playerFilter","onBeginCast","clearWeave","autoAttack","isOgcd","saveIfBad","suggestions","TieredSuggestion","why","tiers","leadingTimestamp","gcdTimeDiff","invulnerability","weave","isBadWeave","onGcd","weaveCount","isActive","types","recast","recastForEvent","getMaxWeaves","forEvent","matchClosestLower","events","CoreActionTimeline","Combos","ACTIONS","CoreCombos","SHADE_SHIFT","CoreDefensives","HUTON_MAX_DURATION_MILLIS","HUTON_EXTENSION_SHORT","HUTON_EXTENSION_MILLIS","BOSS_ADJUSTMENTS","Huton","Death","hutonExtensionMillis","pair","highEstimate","encounter","clipped","downtime","badAcs","lowEstimate","lastEventTime","pets","actors","owner","oneOf","HUTON","HURAIJIN","onHutonCast","onHutonCombo","PHANTOM_KAMAITACHI_BUNSHIN","onKamaitachi","onDeath","onRaise","estimate","elapsedTime","handleHutonRecast","actionId","amount","newDuration","ARMOR_CRUSH","extension","handleHutonExtension","round","getHutonAverages","currentDuration","death","deadTime","uptime","Message","warning","target","HutonCastTime","pomIndex","setPercentageAdjustment","Kassatsu","Actors","kassatsuSpent","kassatsuWastes","kassatsuUses","FUMA_SHURIKEN","GOKA_MEKKYAKU","RAITON","HYOSHO_RANRYU","DOTON","SUITON","RABBIT_MEDIUM","Number","onNinjutsuCast","status","statuses","KASSATSU","onRemoveKassatsu","abilityId","hasStatus","Suggestion","generalBads","Ninjutsu","hyotonCount","rabbitCount","HYOTON","HYOTON_TCJ","DOTON_TCJ","onDotonCast","matchCauseStatus","ticks","finishDotonWindow","tcj","TEN_CHI_JIN","prepull","badTcjs","badAoes","badStds","cast","every","tick","accum","appraiseDotonCasts","DOTON_TICK_TARGET","OVERCAP_SEVERITY","FROG_SEVERITY","Ninki","ninkiGauge","CounterGauge","graph","color","ninkiFilters","BHAVACAKRA","HELLFROG_MEDIUM","BUNSHIN","MEISUI","combo","SPINNING_EDGE","GUST_SLASH","AEOLIAN_EDGE","DEATH_BLOSSOM","HAKKE_MUJINSATSU","damage","FORKED_RAIJU","FLEETING_RAIJU","THROWING_DAGGER","MUG","ninkiModifiers","erroneousFrogs","onGaugeModifier","onDamage","onBunshinHit","onHellfrog","modify","isSuccessfulHit","modifier","overCap","CoreGauge","OGCDDowntime","trackedCds","firstUseOffset","TRICK_ATTACK","DREAM_WITHIN_A_DREAM","dreamTimestamps","CorePositionals","Raiju","currentStacks","droppedStacks","breakingGcds","RAIJU_READY","onRaijuReady","onBreakingGcd","MUDRAS","TrickAttackUsage","Downtime","mudraActions","taCasts","lostTime","gcdCount","castHook","k","onTrickAttack","removeEventHook","taAvailable","getDowntime","lastCast","lostCasts","currentEpochTimestamp","patch","before","distanceFromOptimal","abs","matcher","matchClosestHigher","TCJEvaluator","tcjId","header","accessor","window","NotesEvaluator","TrickAttackWindow","buffStatus","TRICK_ATTACK_VULNERABILITY_UP","ignoreActions","suggestionWindowName","showIcon","addEvaluator","ExpectedGcdCountEvaluator","expectedGcds","globalCooldown","hasStacks","BASE_GCDS_PER_WINDOW","severityTiers","adjustCount","adjustExpectedGcdCount","bind","ExpectedActionsEvaluator","expectedActions","expectedPerWindow","adjustExpectedRaitonCount","LimitedActionsEvaluator","bufferedWindowStart","BuffWindow","dreams","i","CoreWeaving","path","trunc","$","ceil","stat","it","parent"],"sourceRoot":""}